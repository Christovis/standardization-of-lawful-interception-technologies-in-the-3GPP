 
ETSI TS 102 232-5 V3.6.1 (2016-08) Lawful Interception (
LI); Handover Interface and 
Service-Specific Details (SSD) for IP delivery; 
Part 5: Service-specific details for IP Multimedia Services 
  
 TECHNICAL SPECIFICATION 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)2 

RTS/LI-00135-5 

IMS, IP, lawful interception, security 
ETSI 
650 Route des Lucioles 
F-06921 Sophia Antipolis Cedex - FRANCE
 Tel.: +33 4 92 94 42 00   Fax: +33 4 93 65 47 16 
 Siret N° 348 623 562 00017 - NAF 742 C 
Association à but non lucratif enregistrée à la 
Sous-Préfecture de Grasse (06) N° 7803/88 
 Important notice 
The present document can be downloaded from: 
http://www.etsi.org/standards-search
 The present document may be made available in electronic versions and/or in print. The content of any 
electronic and/or 
print versions of the present document shall not be modified 
without the prior written authorization of ETSI. In case of any
 existing or perceived difference in contents between such versions and/or in print, the only prevailing document is the 
print of the Portable Document Format (PDF) version kept on a specific network drive within ETSI Secretariat. 
Users of the present document should be aware that the document may be subject to revision or change of status. 
Information on the current status of this and other ETSI documents is available at 
https://portal.etsi.org/TB/ETSIDeliverableStatus.aspx
 If you find errors in the present document, please send your comment to one of the following services: 
https://portal.etsi.org/People/CommiteeSupportStaff.aspx
 Copyright Notification 
No part may be reproduced or utilized in any form or by any
 means, electronic or mechanical, including photocopying 
and microfilm except as authorized by written permission of ETSI. 
The content of the PDF version shall not be modified without the written authorization of ETSI. 
The copyright and the foregoing restriction extend to reproduction in all media. 
 © European Telecommunications Standards Institute 2016. 
All rights reserved. 
 DECTTM, PLUGTESTSTM, UMTS
TM and the ETSI logo are Trade Marks of ETSI registered for the benefit of its Members.
 3GPP
TM 
and LTEŽ are Trade Marks of ETSI registered for the benefit of its Members and 
of the 3GPP Organizational Partners. 
GSM® and the GSM logo are Trade Marks registered and owned by the GSM Association. 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)3 Contents 























































































Annex A (informative): Interception using H.248 ...............................................................................
 20


















Annex B (normative): Minimum set of func
tional attributes to be provided ................................. 23
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)4 















Annex C (informative): Change request history .................................................................................
. 26

  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)5 Intellectual Property Rights 


ETSI members and non-members


"Intellectual Property Rights (IPRs); Essential, or potentially Essential, IPRs notified to ETSI in 
respect of ETSI standards"






Foreword 





Modal verbs terminology 

shall

shall not

should

should not

may

need not
will

will not

can
cannot




must

must not

NOT

Introduction 



  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)6 1 Scope 







2 References 
2.1 Normative references 














































  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)7 




















2.2 Informative references 















3 Definitions and abbreviations 
3.1 Definitions 

context:

IP MultiMedia service: 

MultiMedia (MM): 


 MultiMedia service:

termination:



  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)8 TSAP identifier:








3.2 Abbreviations 












































































  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)9 




4 General 
4.1 Reference Model for Lawful Interception 







 Figure 1: Reference Model for Lawful Interception 

• 
• 
• 
• 
• 
• 
• 
HI1 
HI2 
HI3 
INI2 
INI3 
HI 
INI1a 
CCCI 
LEA DOMAIN
 NWO/AP/SP DO
MAIN
 CCTI 
CC Internal Intercept 
Function 
(CC IIF) 
LEA 
Administration 
Function 
  Law 
Enforcement 
Monitoring 
Facility 
(LEMF) 
INI1b 
INI1c 
Administration Function (AF) 
CC Trigger 
Function 
(CCTF) 
IRI Internal Intercept 
Function  
(IRI IIF) 
 
 
 Mediation  
Function 
(MF) 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)10 • 
• 
• 

• 

• 


4.2 Reference system model 







  Figure 2: Reference System Model  







Communication 
services 
SvP IP Core network 
Access 
network 
Access 
network 
Access 
network 
GWGWGWSignalling server
 IP MM SvP 
IAP / NWO 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)11 4.2.1 Network layer Interception 


 Figure 3: Network layer Interception Model 




4.2.2 Service layer Interception 



 Figure 4: Service layer Interception Model 








Communication 
services 
SvP IP Core network 
Access 
network 
Access 
network 
Access 
network 
GWGWGWSignalling server
 IP MM SvP 
IAP / NWO 
IRI  IIF 
CC  IIF 
  MF Communication 
services 
SvP IP Core network 
Access 
network 
Access 
network 
Access 
network 
Signalling  
server 
IP MM SvP 
IAP / NWO 
IRI  IIF   MF 
GW  
CC 
 IIF GW  
CC  IIF GW  
CC  IIF   ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)12 4.3 General Requirements 

 

 

 
 
 
 
 
 
 
 


 


 


 


5 Interception of IP Multimedia services 
5.1 Identification of target of interception 
5.1.1 SIP Target Identification 



• 
• 
• 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)13 5.1.2 H.323 Target Identification 



• 
• 
• 
5.2 Interception of signalling 
5.2.1 Provisioning of the SIP IRI IIF 









5.2.2 Provisioning of
 the H.323 IRI IIF 



















5.2.3 Location information 







5.2.4 Supplementary Services 













  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)14 5.3 Assigning a value to the Communication Identity Number 




5.3.1 Assigning a CIN value to SIP related IRI 








5.3.2 Assigning a CIN value to H.323 related IRI 





5.4 Events and IRI record types 

• 




• 



• 



















Table 1: Mapping between IP MM Events and HI2 Records Type 
Event
 IRI Record Type
 At assignment of a new CIN value 
BEGIN/REPORT 
All intermediate signalling, other than the last event CONTINUE/REPORT 
The last event related to a communication session END/REPORT 
Delayed IRI events related to an already ended session REPORT 
Events that are not mapped 
REPORT 
NOTE: Not mapped events could for example be encapsulated SIP messages. 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)15 5.5 Interception of Content of Communication 




• 
• 

• 






























5.6 Direction for IMS IRI for Signalling Messages 




• 
• 
• 


  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)16 5.7 Direction for IMS sessions 
5.7.1 Direction for SIP sessions 




• 


• 


• 

• 

5.7.2 Direction for H.323 sessions 

6 Handover Interface 
6.1 Intercepted Related Information 






6.2 Correlation of IRI and CC 



• 
• 






7 ASN.1 specification for IRI and CC 







  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)17 

-- ==================================== -- Description of the IP Multimedia PDU -- ====================================  IPMultimediaPDU  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) li-ps(5) iPMultimedia(5) version8(8)}  DEFINITIONS IMPLICIT TAGS ::= BEGIN  IMPORTS  -- from TS 101 671 [1] 
 IPAddress   FROM HI2Operations  
  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) 
version18(18)}  -- from TS 102 232-1 [2]  Location   FROM LI-PS-PDU   {itu-u(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) li-ps(5) 
genHeader(1) version24(24)};   -- ============================ -- Object Identifier Definition -- ============================  iPMMIRIObjId RELATIVE-OID   ::= {li-ps(5) iPMultimedia(5) version8(8) iRI(1)} 
iPMMCCObjId RELATIVE-OID   ::= {li-ps(5) iPMultimedia(5) version8(8) cC(2)} 
 -- both definitions relative to:  
 -- {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)} 
 -- ===================================== -- IP Multimedia Communications Contents -- =====================================  IPMMCC ::= SEQUENCE {  iPMMCCObjId     [0] RELATIVE-OID, 
 mMCCContents    [1] OCTET STRING, 
  -- Copy of the multimediastream, i.e. all related RTP/RTCP, UDPTL or MSRP packets 
  -- Each IPMMCC shall contain one intercepted packet 
  -- Protocol of the multimedia packets is indicated by means of mMCCprotocol parameter 
  -- mMCCContents was called rTPCCContents in earlier versions until v2.3.2. 
 ...,  frameType     [2] FrameType OPTIONAL, 
  -- The availability of header information shall be signalled with the frameType parameter 
  -- The module is defined as OPTIONAL because of backwards compatibility reasons 
  -- For new implementations the module is MANDATORY to be used as defined in clause 5.5 
 streamIdentifier   [3] OCTET STRING OPTIONAL, 
  -- Used to identify the media stream within the current CIN, typically in case of  
  -- multiple media streams communications 
  -- May be used to correlate each media stream with the relevant SDP media description of IRI 
  -- May contain c= and m= lines extracts for instance 
 mMCCprotocol    [4] MMCCprotocol OPTIONAL 
  -- Used to identify the protocol of packets sent in MMCCContent (RTP, UDPTL, MSRP, etc.) 
  -- Absence means mMCCContents contains RTP/RTCP packets 
}    ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)18 FrameType ::= ENUMERATED {  ipFrame(0),   -- All headers are present 
 udpFrame(1),   -- IP header is missing 
 rtpFrame(2),   -- UDP and IP headers are missing 
 audioFrame(3),   -- All headers are missing 
 ...,  tcpFrame(4),   -- IP header is missing 
 artificialRtpFrame(5),   -- UDP and IP headers are missing; artificial RTP frame has been added 
 udptlFrame(6)   -- UDP and IP headers are missing 
}  MMCCprotocol ::= ENUMERATED {  rTP(0),   -- mMCCContents parameter contains RTP/RTCP packets 
 mSRP(1),   -- mMCCContents parameter contains MSRP packets 
 ...,  uDPTL(2)   -- mMCCContents parameter contains UDPTL packets 
}  -- ======================================================== -- Intercept-related information for IP Multimedia sessions -- ========================================================  IPMMIRI ::= SEQUENCE {  iPMMIRIObjId    [0] RELATIVE-OID, 
 iPMMIRIContents    [1] IPIRIContents, 
 ...,  targetLocation    
[2] Location OPTIONAL   -- This common parameter is defined in TS 102 232-1 [2], the use of this parameter is 
described in clause 5.2.3  }  
IPIRIContents ::= CHOICE {  originalIPMMMessage  [0] OCTET STRING, 
  -- Copy of the IP MM signalling packet including the original IP and UDP/TCP headers 
 sIPMessage     [1] SIPMessage, 
  -- Copy of the SIP content and the source and destination IP address 
 h323Message     [2] H323Message, 
  -- Copy of the H.323 content and the source and destination IP address 
 ...,  nationalIPMMIRIParameters [3] NationalIPMMIRIParameters,
   -- This parameter is used according to national regulations 
  -- This parameter shall be delivered as an IRI-Report-record 
 xCAPMessage     
[4] OCTET STRING   -- Copy of the XCAP message including all HTTP headers and contents
  }  
SIPMessage ::= SEQUENCE {  iPSourceAddress    [0] IPAddress, 
 iPDestinationAddress  [1] IPAddress, 
 sIPContent     [2] OCTET STRING, 
 ... }  
H323Message ::= SEQUENCE {  iPSourceAddress    [0] IPAddress, 
 iPDestinationAddress  [1] IPAddress, 
 h323Content     [2] H323MessageContent, 
 ... }   ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)19  H323MessageContent ::= CHOICE {  h225CSMessageContent  [0] OCTET STRING, 
 h225RASMessageContent  [1] OCTET STRING, 
 h245MessageContent   [2] OCTET STRING, 
 genericMessageContent  [3] OCTET STRING, 
 ... }  
NationalIPMMIRIParameters ::= SEQUENCE {  countryCode     
[1] PrintableString (SIZE (2)),   -- Country Code according to ISO 3166-1 [16], 
  -- the country to which the parameters inserted after the extension marker apply. 
 ...  -- In case a given country wants to use additional national parameters according to its law, 
 -- these national parameters should be defined using the ASN.1 syntax and added after the 
 -- extension marker (...). 
 -- It is recommended that "version parameter" and "vendor identification parameter" are 
 -- included in the national parameters definition. Vendor identifications can be 
 -- retrieved from the IANA web site (see Annex E Bibliography). Besides, it is recommended  
 -- to avoid using tags from 240 to 255 in a formal type definition. 
}  END -- end of IP Multimedia PDU    ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)20 Annex A (informative): 
Interception using H.248 
A.1 Purpose of this annex 













A.2 Notes on interception using H.248 
A.2.1 Target identificati
on (see also clause 5.1) 













 Figure A.1: Mapping of Authoritative Identifi
ers to Termination and Context Identifiers 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)21 










• 

• 

• 

• 




A.2.2 Provisioning of the H.248 
IRI IIF (see also clause 5.2) 








A.3 Problems in H.248 interception 
A.3.1 Missing information in H.248 signalling 



• 




• 

• 



• 
• 










  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)22 A.3.2 Missing call content 





  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)23 Annex B (normative): 
Minimum set of functional attributes to be provided 









B.1 General requirements 






























 



  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)24 B.2 Result of interception 






























B.3 Location information 




B.4 Time constraints 











  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)25 

B.5 Technical handover interfaces and format 
requirements 







  ETSI ETSI TS 102 232
-5 V3.6.1 
(2016
-08)26 Annex C (informative): 
Change request history 
Status of present document: 
ETSI TS 102 232
-5 Handover Interface and Service-Specific Details (SSD) for IP delivery;  
Part 5: Service-specific details for IP Multimedia Service; Handover specification for IP delivery 
TC LI approval 
Date 
Version Remarks
 January 2007 2.1.1 First publication of the TS afte
r approval by ETSI/TC LI#14 (30 January - 1 February 
2007, Puerto de la Cruz) 
 Version 2.1.1 prepared by Johan Bakker (KPN) (rapporteur V2.1.1) 
October 2007 2.2.1 
Included Change Requests: 
TS102232-05CR001 (cat D) IRI Record type 
TS102232-05CR002r2 (cat B) Clarification of use of RTP/UDP/IP headers 
These CRs were approved TC LI#16 (2-4 October 2007; Berlin) 

 
Version 2.2.1 prepared by Peter van der Arend (KPN) (chairman TC LI) 
Rapporteur of this specification is Mark Lastdrager (Pine Digital Security) 
December 2007 2.2.2 Figure 5 was updated. 
January 2008 2.3.1 
Included Change Request: 
TS102232-05CR003r1 (cat B) on Media stream identification for correlation in case of 

multiple media streams communications 

This CR was approved TC LI#17 (22-24 January 2008, Como) 

 Version 2.3.1 prepared by Peter van der Arend (KPN) (chairman TC LI) 
Rapporteur of this specification is Mark Lastdrager (Pine Digital Security) 
July 2009 2.3.2  
Included Change Request: 
TS102232-05CR004r2 (cat D) Clarification about CIN assignment 
This CR was approved by TC LI#21 (29 June - 1 July 2009, Sophia Antipolis) 

 
The ASN.1 definitions are contained in an .asn file (ETSI TS 102 232-5, 
IPMultimediaPDU, ver3.asn) which accompanies the present document 
 
Version 2.3.2 prepared by Peter van der Arend (Vodafone) (chairman TC LI) 

Rapporteur of this specification is Mark Lastdrager (Pine Digital Security) 
February 2010 2.4.1 
Included Change Request: 

TS102232-05CR005r1 (cat B) update to handle non-RTP bearers (MSRP) for new IMS 

services 
This CR was approved by TC LI#23 (9-11 February 2010, Rome) 
 
The ASN.1 definitions are contained in a .txt file (ETSI TS 102 232-5, IPMultimediaPDU, 

ver4.txt) which accompanies the present document 
 Version 2.4.1 prepared by Peter van der Arend (Vodafone) (chairman TC LI) 
September 2010 2.5.1 
Included Change Request: 
TS102232-05CR006 (cat F) Clarification of delivery of intercepted IPMM packets 
This CR was approved by TC LI#25 (21-23 September 2010, St. Petersburg) 

 
The ASN.1 definition is contained in a .txt file (IPMultimediaPDU,ver4.txt) which 
accompanies the present document 
 
Version 2.5.1 prepared by Peter van der Arend (Vodafone) (chairman TC LI) 

Rapporteur of this specification is Mark Lastdrager (Pine Digital Security) 
January 2012 3.1.1 
Included Change Request: 

TS102232-05CR007r1 (cat F) Additional parameter "sciInformation" for the reporting of 

Subscriber Controlled Input of the target 

This CR was approved by TC LI#29 (24-26 January 2012, Dun Laoghaire) 
 The ASN.1 definition is contained in a .txt file (IPMultimediaPDU,ver5.txt) which 

accompanies the present document 

 Version 3.1.1 prepared by Peter van der Arend (Vodafone) (chairman TC LI) 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)27 Status of present document: 
ETSI TS 102 232
-5 Handover Interface and Service-Specific Details (SSD) for IP delivery;  
Part 5: Service-specific details for IP Multimedia Service; Handover specification for IP delivery 
TC LI approval 
Date 
Version Remarks
 May 2012 3.2.1 
Included Change Requests: 
TS102232-05CR008r1 (cat B) Addition of rtpframe parameter 
TS102232-05CR009r1 (cat B) Interception of Facsimile over IP IMS communications 

These CRs were approved by TC LI#30 (14-16 May 2012, Amsterdam) 

 The ASN.1 definition is contained in a .txt file (IPMultimediaPDU,ver6.txt) which 
accompanies the present document 

 
Version 3.2.1 prepared by Peter van der Arend (Vodafone) (chairman TC LI) 
Rapporteur of this specification is Mark Lastdrager (Pine Lawful Interception) 
July 2014 3.3.1 
Included Change Requests: 
TS102232-05CR10 (cat B) Addition of location support to IPMMIRI 
TS102232-05CR11 (cat F) Correction of tables 
 
The ASN.1 definition is contained in a .txt file (IPMultimediaPDU,ver7.txt) which 

accompanies the present document 
 Version 3.3.1 prepared by Mark Lastdrager (Pine Lawful Interception) (Rapporteur) 
September 2014 3.4.1 
Included Change Request: 

TS102232-05CR12 (cat F) Correction of CIN correlation 
 The ASN.1 definition is contained in a .txt file (IPMultimediaPDU,ver7.txt) which 

accompanies the present document 

 Version 3.4.1 prepared by Mark Lastdrager (Pine Lawful Interception) (Rapporteur) 
September 2015 3.5.1 
Included Change Request: 
TS10232-05CR13 (cat B) Specifying session direction for IMS sessions 
 The ASN.1 definition is contained in a .txt file (IPMultimediaPDU,ver7.txt) which 

accompanies the present document 

 Version 3.5.1 prepared by Mark Lastdrager (Pine Lawful Interception) (Rapporteur) 
July 2016 3.6.1 
Included Change Request: 
TS 102-05CR014 (cat B) Adding supplementary services to ETSI TS 102 232-5 
This CR was approved by TC LI#42. 
 
The ASN.1 definition is contained in a .txt file (IPMultimediaPDU,ver8.txt) which 

accompanies the present document 
 Version 3.6.1 prepared by Mark Lastdrager (Pine Lawful Interception) (Rapporteur) 
  ETSI ETSI TS 102 232
-5 V3.6.1 (2016
-08)28 History 
Document history 













