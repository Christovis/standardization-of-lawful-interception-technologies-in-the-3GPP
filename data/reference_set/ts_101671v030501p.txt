   
  ETSI TS 101 671 V3.5.1 (2009-11
)Technical Specification
 Lawful Interception (LI);
Handover interface for the lawful interception of
telecommunications traffic  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)2   
 Reference 
RTS/LI-00064 
Keywords 
data, handover, interface, Lawful Interception, 
security, speech 
ETSI 
650 Route des Lucioles 
F-06921 Sophia Antipolis Cedex - FRANCE
  Tel.: +33 4 92 94 42 00   Fax: +33 4 93 65 47 16 
 Siret N° 348 623 562 00017 - NAF 742 C 
Association à but non lucratif enregistrée à la 
Sous-Préfecture de Grasse (06) N° 7803/88 
 Important notice 
Individual copies of the present document can be downloaded from: 
http://www.etsi.org
 The present document may be made available in more than one electronic version or in print. In any case of existing or 
perceived difference in contents between such versions, the reference version is the Portable Document Format (PDF). 
In case of dispute, the reference shall be the printing on ETSI printers of the PDF version 
kept on a specific network drive 
within ETSI Secretariat. 
Users of the present document should be aware that the 
document may be subject to revision or change of status. 
Information on the current status of this and other ETSI documents is available at 
http://portal.etsi.org/tb/status/status.asp
 If you find errors in the present document, please send your comment to one of the following services: 
http://portal.etsi.org/chaircor/ETSI_support.asp
 Copyright Notification 
No part may be reproduced except as authorized by written permission. 
The copyright and the foregoing restriction extend to reproduction in all media. 
 © European Telecommunications Standards Institute 2009. 
All rights reserved. 
 DECTTM, PLUGTESTSTM, UMTS
TM, TIPHON
TM, the TIPHON logo and the ETSI logo are Trade Marks of ETSI registered 
for the benefit of its Members. 
3GPP
TM 
is a Trade Mark of ETSI registered for the benefit of its Members and of the 3GPP Organizational Partners. 
LTEŽ is a Trade Mark of ETSI currently being registered 
for the benefit of its Members and of the 3GPP Organizational Partners. 
GSM® and the GSM logo are Trade Marks register
ed and owned by the GSM Association. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)3 Contents 
Intellectual Prop
erty Rights ..................................................................................................
.............................. 9Foreword ......................................................................................................................
....................................... 9Introducti
on ..................................................................................................................
...................................... 91 Scope .......................................................................................................................
............................... 102 References ..................................................................................................................
............................ 102.1 Normative references ......................................................................................................
................................. 112.2 Informative references ....................................................................................................
.................................. 143 Definitions and abbreviations ...............................................................................................
.................. 153.1 Definitions ...............................................................................................................
......................................... 153.2 Abbreviations .............................................................................................................
...................................... 184 General requ
iremen
ts ........................................................................................................
..................... 204.1 Basic principles for the Handover Interface ...............................................................................
...................... 204.2 Legal requirements ........................................................................................................
................................... 204.3 Functional requirements ...................................................................................................
................................ 205 Overview of Handover Interface ..............................................................................................
.............. 215.1 Handover Interface port 1 (HI1) ...........................................................................................
............................ 225.1.1 Manual 
interface ........................................................................................................
................................. 225.1.2 Electronic interface ....................................................................................................
................................. 225.2 Handover Interface port 2 (HI2) ...........................................................................................
............................ 225.3 Handover Interface port 3 (HI3) ...........................................................................................
............................ 236 Specific identi
fiers for LI .................................................................................................
...................... 236.1 Lawful Interception IDentifier (LIID) .....................................................................................
......................... 236.2 Communication IDentifier (CID) ............................................................................................
......................... 236.2.1 Network IDentifier (NID) ................................................................................................
........................... 246.2.2 Communication Identity Number (CIN) - optional ..........................................................................
.......... 247 HI1: Interface port for ad
ministrative in
forma
tion ..........................................................................
....... 247.1 Information for the activation of lawful interception .....................................................................
.................. 247.2 LI notifications
 towards the LEMF .........................................................................................
......................... 258 HI2: Interface port for Inte
rcept Related 
Informa
tion .......................................................................
..... 258.1 Data transmission protocols ...............................................................................................
.............................. 258.1.1 Application for IRI (HI2 information) ...................................................................................
..................... 268.2 Types of 
IRI records ......................................................................................................
................................... 269 HI3: Interface port for Co
ntent of Communication ............................................................................
.... 2610 Performance a
nd quality ....................................................................................................
..................... 2710.1 Timing ...................................................................................................................
........................................... 2710.2 Quality ..................................................................................................................
............................................ 2711 Security 
aspects ...........................................................................................................
........................... 2711.1 Security properties ......................................................................................................
...................................... 2711.2 Security mechanisms ......................................................................................................
.................................. 2812 Quantitativ
e aspects .......................................................................................................
......................... 28Annex A (normative): Circuit switched network handover ............................................................. 29
A.1 Specific identi
fiers for LI ...............................................................................................
........................ 29A.1.1 CC Link IDentifier (CCLID) ..............................................................................................
.............................. 29A.1.2 Circuit switched LI correlation between CC and IRI ......................................................................
................. 29A.1.3 Usage of identifiers ....................................................................................................
...................................... 29A.2 HI1: interface port fo
r administra
tive state ..............................................................................
.............. 30  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)4 A.3 HI2: interface port for IRI ...............................................................................................
....................... 30A.3.1 Definition of Intercept Related Information (IRI) .......................................................................
..................... 30A.3.2 Structure of IRI records ................................................................................................
.................................... 31A.3.2.1 Control information for HI2............................................................................................
............................ 31A.3.2.2 Basic call information ................................................................................................
................................. 31A.3.2.3 Information on Supplementary Services, related to a call in progress ..................................................
...... 32A.3.2.4 Information on non-call related Supplementary Services ................................................................
........... 32A.3.3 Selection of parameters for IRI records .................................................................................
........................... 33A.3.4 Coding of parameters in IRI records .....................................................................................
........................... 36A.3.5 Information content of the IRI record types .............................................................................
........................ 36A.4 HI3: interface port for 
Content of Communication ..........................................................................
...... 36A.4.1 Delivery of Content of Communication (CC) ...............................................................................
................... 36A.4.1.1 Delivery of TETRA CC over circuit switched handover networks ..........................................................
.. 37A.4.2 Delivery of packetized Content of Communication (CC) (general) ..........................................................
....... 37A.4.2.1 Delivery of TETRA CC over packet switched handover networks ...........................................................
. 38A.4.3 Control information for circuit switched Content of Communication (CC) ..................................................
... 38A.4.4 Exception handling ......................................................................................................
..................................... 39A.4.4.1 Failure of CC links ...................................................................................................
................................... 39A.4.4.2 Fault reporting .......................................................................................................
..................................... 39A.4.5 Security requirements at the interface port HI3 .........................................................................
....................... 39A.4.5.1 LI access verification ................................................................................................
.................................. 40A.4.5.2 Access protection .....................................................................................................
................................... 40A.4.5.3 Authentication ........................................................................................................
..................................... 40A.5 LI procedures for circuit sw
itched supplementa
ry serv
ices .................................................................
.. 40A.5.1 General .................................................................................................................
............................................ 40A.5.2 CC link Impact ..........................................................................................................
....................................... 43A.5.3 IRI impact, general principle for sending IRI records ...................................................................
................... 43A.5.4 Multi party calls - general principles, options A, B ....................................................................
...................... 43A.5.4.1 CC links for active and non-active calls (option A) ...................................................................
................. 44A.5.4.2 Reuse of CC links for active calls (option B) .........................................................................
.................... 44A.5.5 Subscriber Controlled Input (SCI): Acti
vation/Deactivation/Interrogation of services ................................... 
45A.6 Detailed procedures for circuit 
switched suppleme
ntary serv
ices .......................................................... 
45A.6.1 Advice of Charge services (AOC) .........................................................................................
........................... 45A.6.2 Call Waiting (CW) .......................................................................................................
.................................... 45A.6.2.1 Call Waiting (CW) at target: CC links .................................................................................
....................... 45A.6.2.2 Call Waiting: IRI records .............................................................................................
............................... 45A.6.2.2.1 Target is served user................................................................................................
.............................. 45A.6.2.2.2 Other party is served user ..........................................................................................
............................ 45A.6.3 Call Hold
/Retrieve ......................................................................................................
...................................... 46A.6.3.1 CC links for active and non-active calls (option A) ...................................................................
................. 46A.6.3.2 Reuse of CC links for active calls (option B) .........................................................................
.................... 46A.6.3.3 IRI 
records ...........................................................................................................
....................................... 46A.6.3.3.1 Invocation of Call Hold or Retrieve by target .......................................................................
................ 46A.6.3.3.2 Invocation of Hold or Retrieve by other parties .....................................................................
............... 46A.6.4 Explicit Call Transfer (ECT) ............................................................................................
................................ 46A.6.4.1 Explicit Call Transfer (ECT), CC link .................................................................................
....................... 46A.6.4.2 Explicit Call Transfer (ECT), IRI records .............................................................................
..................... 46A.6.5 Calling Line Identification Presentation (CLIP) (IRI Records) ...........................................................
............. 47A.6.5.1 Call originated by target (other party is served user) ................................................................
.................. 47A.6.5.2 Call terminated at target (target is served user) .....................................................................
..................... 47A.6.6 Calling Line Identification Restriction (CLIR) ..........................................................................
...................... 47A.6.7 COnnected Line identification Presentation (COLP) .......................................................................
................ 47A.6.7.1 Call terminated at target (other party is served user) ................................................................
.................. 47A.6.7.2 Call originated by target (target is served user) .....................................................................
..................... 47A.6.8 COnnected Line identification Restriction (COLR) ........................................................................
................. 47A.6.9 Closed User Group (CUG) .................................................................................................
.............................. 47A.6.10 Completion of Call to Busy Subscriber (CCBS) ...........................................................................
................... 47A.6.11 CONFerence call, add-on (CONF) .........................................................................................
.......................... 48A.6.11.1 CONFerence calls, add on: CC links ...................................................................................
....................... 48A.6.11.2 Conference calls: IRI records.........................................................................................
............................. 48  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)5 A.6.12 Three party service (3PTY) (conference) ................................................................................
......................... 48A.6.12.1 CC links .............................................................................................................
......................................... 48A.6.12.2 Three party service, IRI records .....................................................................................
............................. 48A.6.13 Meet-Me Conference (MMC) ...............................................................................................
........................... 48A.6.14 Direct Dialling In (DDI) ...............................................................................................
.................................... 48A.6.15 Multiple Subscriber Number (MSN) .......................................................................................
......................... 48A.6.16 DIVersion services (DIV) ...............................................................................................
................................. 49A.6.16.1 Call Diversion by target .............................................................................................
................................. 49A.6.16.1.1 Call Diversion by target, CC links .................................................................................
....................... 49A.6.16.1.2 Call Diversion by target, IRI records ..............................................................................
...................... 49A.6.16.2 Forwarded call terminated at target ..................................................................................
.......................... 49A.6.16.3 Call from target forwarded ...........................................................................................
.............................. 50A.6.17 Variants of call diversion services ....................................................................................
................................ 50A.6.18 Void ...................................................................................................................
............................................... 50A.6.19 Malicious Call IDentification (MCID) ...................................................................................
.......................... 50A.6.20 SUBaddressing (SUB) ....................................................................................................
.................................. 50A.6.21 Terminal Portability (TP) ..............................................................................................
................................... 50A.6.21.1 CC links .............................................................................................................
......................................... 50A.6.21.2 IRI 
records ..........................................................................................................
........................................ 50A.6.21.2.1 Invocation of Terminal Portability by target .......................................................................
.................. 50A.6.21.2.2 Invocation of Terminal Portability by other parties ................................................................
.............. 50A.6.22 User-to-User Signalling (UUS) ..........................................................................................
.............................. 50A.6.23 Abbreviated Address (AA) ...............................................................................................
................................ 50A.6.24 Fixed Destination Call (FDC) ...........................................................................................
............................... 51A.6.25 Alarm Call (AC)/Wake-Up Service (WUS) ..................................................................................
................... 51A.6.26 Incoming Call Barring (ICB).............................................................................................
............................... 51A.6.27 Outgoing Call Barring (OCB) ............................................................................................
.............................. 51A.6.28 Completion of Calls on No Reply (CCNR) .................................................................................
..................... 51A.6.29 Revers
e charging .......................................................................................................
....................................... 51A.6.30 Line hunting ...........................................................................................................
.......................................... 51A.6.31 Message Wait Indication (MWI) ..........................................................................................
............................ 51A.6.32 Name display ...........................................................................................................
......................................... 51A.6.33 Tones, announcements ...................................................................................................
.................................. 52A.7 Void ......................................................................................................................
.................................. 52A.8 GSM circuit switch
ed technology annex .....................................................................................
........... 52A.8.1 Functional architecture .................................................................................................
.................................... 52A.8.2 Correlation of CC and IRI (see clause 6) ................................................................................
......................... 53A.8.3 HI3 (delivery of CC) ....................................................................................................
.................................... 53A.8.4 HI2 (delivery of IRI) ...................................................................................................
..................................... 53A.9 TETRA technology annex ....................................................................................................
.................. 55A.9.1 According EN 301 040 ....................................................................................................
................................. 55A.9.2 based on EN 301 040 adapted 
to common handover interface ................................................................
......... 55A.9.2.1 HI 2 event definitions ................................................................................................
................................. 55A.9.2.1 IRI event definitions .................................................................................................
.................................. 55A.9.2.1.1 BEGIN event information .............................................................................................
........................ 56A.9.2.1.1.1 Call Setup Mobile Originating .....................................................................................
................... 56A.9.2.1.1.2 Call Setup Mobile Terminating .....................................................................................
.................. 56A.9.2.1.2 CONTINUE event information ..........................................................................................
................... 57A.9.2.1.2.1 
Ringing ...........................................................................................................
................................. 57A.9.2.1.2.2 Queueing ..........................................................................................................
............................... 57A.9.2.1.2.3 Connected .........................................................................................................
............................... 58A.9.2.1.2.4 Handover ..........................................................................................................
............................... 58A.9.2.1.2.5 Call Forwarding ...................................................................................................
............................ 58A.9.2.1.2.6 Call Hold .........................................................................................................
................................ 59A.9.2.1.2.7 TxGranted .........................................................................................................
............................... 59A.9.2.1.3 END event information ...............................................................................................
.......................... 59A.9.2.1.3.1 Call Release ......................................................................................................
............................... 60A.9.2.1.4 REPORT event information ............................................................................................
...................... 60A.9.2.1.4.1 Location Update ...................................................................................................
........................... 60A.9.2.1.4.2 SDS Mobile Originating ............................................................................................
...................... 61  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)6 A.9.2.1.4.3 SDS Mobile Terminating.............................................................................................
.................... 61A.9.2.1.4.4 Group Indication ..................................................................................................
............................ 61A.9.2.1.4.5 Mobile On .........................................................................................................
............................... 62A.9.2.1.4.6 Mobile Off ........................................................................................................
............................... 62A.9.2.1.4.7 DMO ...............................................................................................................
................................. 62A.10 NGN PSTN/ISDN emulation and simula
tion services technology annex ............................................. 63
A.10.1 Functional architecture ................................................................................................
..................................... 63A.10.2 Correlation ............................................................................................................
............................................ 63A.10.3 HI2.....................................................................................................................
............................................... 63A.10.4 HI3.....................................................................................................................
............................................... 63Annex B (normative): Packet switched network handover .............................................................. 64
B.1 Specific identi
fiers for LI ...............................................................................................
........................ 64B.2 HI1: interface port fo
r administra
tive state ..............................................................................
.............. 64B.3 HI2: interface port for IRI ...............................................................................................
....................... 64B.3.1 Definition of Interception Relate
d Information for packet switched ......................................................
.......... 64B.3.2 Exception handling ......................................................................................................
..................................... 64B.3.3 Security aspects ........................................................................................................
........................................ 64B.4 HI3: interface port for Co
ntent of Communication (CC) .....................................................................
.. 65B.5 GPRS technology annex .....................................................................................................
.................... 65B.5.1 Functional architecture .................................................................................................
.................................... 65B.5.2 Correlation .............................................................................................................
........................................... 66B.5.2.1 Correlation of the present document IDs to GSM IDs ....................................................................
............ 66B.5.2.2 GPRS LI correlation between CC and IRI ................................................................................
.................. 66B.5.3 HI2 (delivery of IRI) ...................................................................................................
..................................... 66B.5.4 HI3 (Delivery of CC) ....................................................................................................
................................... 67Annex C (normative): HI2 Delivery mechanisms and procedures .................................................. 68
C.1 ROSE ......................................................................................................................
................................ 68C.1.1 Architecture ............................................................................................................
.......................................... 68C.1.2 ASE_HI procedures .......................................................................................................
................................... 68C.1.2.1 Sending part ..........................................................................................................
...................................... 68C.1.2.2 Receiving part ........................................................................................................
..................................... 70C.1.2.3 Data link management ..................................................................................................
.............................. 70C.1.2.3.1 Data link establishment .............................................................................................
............................ 70C.1.2.3.2 Data link release ...................................................................................................
................................. 71C.1.2.4 Handling of unrecognized fields and parameters ........................................................................
................ 71C.1.3 Void ....................................................................................................................
.............................................. 71C.2 FTP .......................................................................................................................
.................................. 71C.2.1 Introduction ............................................................................................................
.......................................... 71C.2.2 Usage of
 the 
FTP ........................................................................................................
...................................... 72C.2.3 Profiles ................................................................................................................
............................................. 74C.2.4 File content ............................................................................................................
........................................... 75C.2.5 Exceptional procedures ..................................................................................................
.................................. 75C.2.6 Other considerations ....................................................................................................
..................................... 76Annex D (normative): Structure of data at the Handover Interface ............................................... 77
D.1 Syntax definitions ........................................................................................................
........................... 77D.2 Object tree ...............................................................................................................
............................... 78D.3 HI management operation ...................................................................................................
................... 79D.4 LI management notification ................................................................................................
................... 80D.5 Intercept related inform
ation (HI2 PS and CS) .............................................................................
......... 82D.6 User data packet 
transfer (HI3 CS) ........................................................................................
................ 97  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)7 D.7 TETRA data transfer (HI3 interface) .......................................................................................
.............. 98D.8 Definition of the UUS1 content associated to the CC link ..................................................................
... 98D.9 Content of Communication (HI3 GPRS) .......................................................................................
........ 99D.10 TETRA ASN.1 details ......................................................................................................
.................... 100D.10.1 HI management operation ................................................................................................
.............................. 100D.10.2 LI management notification .............................................................................................
.............................. 102D.10.3 HI2 definitions ........................................................................................................
........................................ 104Annex E (informative): Use of subaddress and calling party number to carry correlation 
information ................................................................................................... 120
E.1 Introduction ..............................................................................................................
............................ 120E.2 Subaddress options ........................................................................................................
....................... 120E.3 Subaddress coding .........................................................................................................
....................... 120E.3.1 BCD values ..............................................................................................................
...................................... 120E.3.2 Field order and layout ..................................................................................................
................................... 121E.4 Field coding ..............................................................................................................
............................ 126E.4.1 Direction ...............................................................................................................
.......................................... 127E.4.2 Coding of the Calling Party Number ......................................................................................
........................ 127E.5 Length of fields ..........................................................................................................
.......................... 127Annex F
 (informative): GPRS 
HI3 interface ..................................................................................... 128
F.1 Functional architecture ...................................................................................................
...................... 128F.2 Correlatio
n ...............................................................................................................
............................. 128F.3 HI3 Delivery Content 
of Communication (CC) ................................................................................
... 128F.3.1 GPRS LI correlation header ..............................................................................................
............................. 129F.3.1.1 Introduction...........................................................................................................
.................................... 129F.3.1.2 Definition of GLIC header .............................................................................................
........................... 129F.3.1.3 Exceptional procedure .................................................................................................
............................. 130F.3.1.4 Other considerations ..................................................................................................
............................... 131F.3.2 
FTP 
................................................................................................................................................................. 131F.3.2.1 Introduction...........................................................................................................
.................................... 131F.3.2.2 Usage 
of the 
FTP ......................................................................................................
................................ 131F.3.2.3 Profiles ..............................................................................................................
........................................ 133F.3.2.4 Exceptional procedures ................................................................................................
............................. 135F.3.2.5 CC contents for FTP ...................................................................................................
.............................. 135F.3.2.5.1 Fields ..............................................................................................................
..................................... 135F.3.2.5.2 Information Element syntax ..........................................................................................
...................... 137F.3.2.6 Other considerations ..................................................................................................
............................... 139Annex G (informative): LEMF requirements - handling of unrecognized fields and 
parameters .................................................................................................... 140
Annex H (informative): IP Multimed
ia Subsystem (IMS) handover ............................................... 141
H.1 Specific identi
fiers for LI ...............................................................................................
...................... 141H.1.1 Lawful inter
ception identifier ..........................................................................................
............................... 142H.1.2 Network identifier ......................................................................................................
.................................... 142H.1.3 Correlation number.......................................................................................................
.................................. 142H.1.4 IRI for IMS .............................................................................................................
........................................ 143H.1.4.1 Events and information ................................................................................................
............................. 144H.1.5 Correlation indications of IMS 
IRI with GSN CC at the LEMF ..............................................................
...... 145Annex I (informative): Latest ASN.1 module versions .................................................................... 147
Annex J (informative): Bibliography ...........................................................................................
...... 148  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)8 Annex K (informative): Change Request history ............................................................................... 1
49History .......................................................................................................................
..................................... 154   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)9 Intellectual Property Rights 
IPRs essential or potentially essential to the present document may have been declared to ETSI. The information 
pertaining to these essential IPRs, if any, is publicly available for 
ETSI members and non-members
, and can be found 
in ETSI SR 000 314: 
"Intellectual Property Rights (IPRs); Essential, or potentially Essential, IPRs notified to ETSI in 
respect of ETSI standards"
, which is available from the ETSI Secretariat. Latest updates are available on the ETSI Web 
server (
http://webapp.etsi.org/IPR/home.asp
). 
Pursuant to the ETSI IPR Policy, no investigation, including IPR searches, has been carried out by ETSI. No guarantee 
can be given as to the existence of other IPRs not referenced in ETSI SR 000 314 (or the updates on the ETSI Web 
server) which are, or may be, or may become, essential to the present document. 
Foreword 
This Technical Specification (TS) has been produced 
by ETSI Technical Committee Lawful Interception (LI). 
The ASN.1 module is also available as an electronic attach
ment to the original document from the ETSI site (see for 
more details clause D.2). 
Introduction 
References within the main body of the present document are made if applicable to the 3GPP specification number with 

in square brackets the reference number as listed in clause 2. In clause 2 "References" the corresponding ETSI 

specification number is indicated with a reference to the 3GPP specification number. 3GPP specifications are available 

faster than the equivalent ETSI specifications. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)10 1 Scope 
The present document is step 3 of a three-step approach to
 describe a generic Handover Interface (HI) for the provision 
of lawful interception from a Network Operator, an Acces
s Provider or a Service Provider (NWO/AP/SvP) to the 
Law Enforcement Agencies (LEAs). The provision of lawful interception is a requirement of national law, which is 

usually mandatory for the operation of any telecommunication service. 
Step 1 contains the requirements for lawful interception from a users (LEAs) point of view and is published in 
TS 101 331 [1]. 
Step 2 describes the derived network functions and the general architecture (or functional model) and is published in 
ES 201 158 [2]. 
The present document specifies: 
• the
 generic flow of information
 as well as the procedures and inform
ation elements, which are applicable to 
any future telecommunication network or service; 
• the network/service specific protocols relating to the prov
ision of lawful interception at the Handover Interface 
(HI), for the following networks/services: 
- switched circuit; and 
- packet data. 
The technologies covered in the present document are: GSM, TETRA, GPRS, ISDN, PSTN, fixed NGN (including 
PSTN/ISDN emulation) and fixed IMS PSTN simulation. 
NOTE: As new networks and/or services are developed, the present document will be expanded as the relevant 
standards become available. 
2 References 
References are either specific (identified by date of publication and/or edition number or version number) or 

non-specific. 
• For a specific reference, subsequent revisions do not apply. 
• Non-specific reference
 may be made only to a complete document or a part thereof and only in the following 
cases:  
- if it is accepted that it will be possible to use all future changes of the referenced document for the 
purposes of the referring document;  
- for informative references. 
Referenced documents which are not found to be publicly available in the expected location might be found at 
http://docbox.etsi.org/Reference
. NOTE 1: While any hyperlinks included in this clause were valid at the time of publication ETSI cannot guarantee 
their long term validity. 
NOTE 2: The numbering of the references is kept in line with the numbering as used in version 1.1.1, version 2.1.1 
and version 3.1.1 of ES 201 671, and used in previous versions of the present document. 
NOTE 3: Periodically TS 101 671 is published as ES 201 671. A reference made in other ETSI deliverables to the 
latest version of the TS version reflects the latest stable content from ETSI/TC LI. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)11 2.1 Normative references 
The following referenced documents are indispensable for the application of the present document. For dated 
references, only the edition cited applies. For non-specific references, the latest edition of the referenced document 
(including any amendments) applies. 
[1] ETSI TS 101 331: "Lawful Interception (LI); Requirements of Law Enforcement Agencies". 

[2] ETSI ES 201 158: "Telecommunications security; Lawful Interception (LI); Requirements for 
network functions". 
[3] ETSI ETR 330: "Security Techniques Advisory Group (STAG); A guide to legislative and 
regulatory environment". 
[4] Void. 
[5] ETSI EN 300 356 (all parts): "Integrated Services Digital Network (ISDN); Signalling System 
No.7 (SS7); ISDN User Part (ISUP) ve
rsion 4 for the international interface". 
[6] ETSI EN 300 403-1 (V1.3.2): "Integrated Services Digital Network (ISDN); Digital Subscriber 
Signalling System No. one (DSS1) protocol; Signalling network layer for circuit-mode basic call 
control; Part 1: Protocol specification [ITU-T Recommendation Q.931 (1993), modified]". 
NOTE: Reference [6] is specific, because the format of the sub parameters  
"dSS1-Format, DSS1-parameters-codeset-0", "DSS1-SS-parameters-codeset-0" and "UUS1-Content" are 

defined by V1.3.2. 
[7] Void. 

[8] Void. 
[9] Void. 
[10] ETSI EN 300 061-1: "Integrated Services Digital Network (ISDN); Subaddressing (SUB) 
supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; 

Part 1: Protocol specification". 
[11] Void. 

[12] Void. 
[13] Void. 
[14] ETSI EN 300 097-1 (V1.2.4): "Integrated Services Digital Network (ISDN); Connected Line 
Identification Presentation (COLP) supplementary service; Digital Subscriber Signalling System 

No. one (DSS1) protocol; Part 1: Protocol specification". 
NOTE: Reference [14] is specific, because severa
l parameter format definitions point to V1.2.4. 
[15] Void. 
[16] ETSI EN 300 130-1: "Integrated Services Digital Network (ISDN); Malicious Call Identification 
(MCID) supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; 

Part 1: Protocol specification". 
[17] Void. 

[18] Void. 
[19] ETSI EN 300 185-1: "Integrated Services Digital Network (ISDN); Conference call, add-on 
(CONF) supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; 

Part 1: Protocol specification". 
[20] ETSI EN 300 188-1: "Integrated Services Digital Network (ISDN); Three-Party (3PTY) 
supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; 

Part 1: Protocol specification". 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)12 [21] ETSI EN 300 207-1 (V1.2.5): "Integrated Services Digital Network (ISDN); Diversion 
supplementary services; Digital Subscriber Signalling System No. one (DSS1) protocol; 

Part 1: Protocol specification". 
NOTE: Reference [21] is specific, because the format of the sub parameters for "DSS1-SS-Invoke-Components" 
is defined by V1.2.5. In addition several parameter format definitions point to V1.2.5. 
[22] Void. 
[23] ETSI EN 300 286-1: "Integrated Services Digital Network (ISDN); User-to-User Signalling 
(UUS) supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; 

Part 1: Protocol specification". 
[24] Void. 

[25] ETSI EN 300 369-1 (V1.2.4): "Integrated Services Digital Network (ISDN); Explicit Call Transfer 
(ECT) supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; 
Part 1: Protocol specification". 
NOTE: Reference [25] is specific, because the format of the sub parameters for "DSS1-SS-Invoke-Components" 
is defined by V1.2.4. 
[26] Void. 

[27] Void. 
[28] Void. 
[29] ETSI EN 300 196-1 (V1.3.2): "Integrated Services Digital Network (ISDN); Generic functional 
protocol for the support of supplementary services; Digital Subscriber Signalling System No. one 

(DSS1) protocol; Part 1: Protocol specification". 
NOTE: Reference [29] is specific, because severa
l parameter format definitions point to V1.3.2. 
[30] Void. 
[31] ITU-T Recommendation Q.850 (1998): "Usage of cause and location in the Digital Subscriber 
Signalling System No. 1 and the Signalling System No. 7 ISDN User Part". 
NOTE: Reference [31] is specific, because several parameter format definitions point to version 1988. 

[32] ETSI TS 100 974: "Digital cellular telecommunications system (Phase 2+) (GSM); Mobile 
Application Part (MAP) specification (GSM 09.02)". 
[33] ITU-T Recommendation X.680: "Information technology - Abstract Syntax Notation One 
(ASN.1): Specification of basic notation". 
[34] ITU-T Recommendation X.690: "Information technology - ASN.1 encoding rules: Specification of 
Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding 

Rules (DER)". 
[35] ITU-T Recommendation X.880: "Information technology - Remote Operations: Concepts, model 
and notation". 
[36] Void. 

[37] ITU-T Recommendation X.882: "Information technology - Remote Operations: OSI realizations - 
Remote Operations Service Elemen
t (ROSE) protocol specification". 
[38] Void. 

[39] ETSI EN 300 122-1: "Integrated Services Digital Network (ISDN); Generic keypad protocol for 
the support of supplementary services; Digital Subscriber Signalling System No. one (DSS1) 
protocol; Part 1: Protocol specification". 
[40] ETSI EN 300 392-1: "Terrestrial Tr
unked Radio (TETRA); Voice plus Data (V+D); 
Part 1: General network design". 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)13 [41] ETSI TS 124 008: "Digital cellular telecommunications system (Phase 2+); Universal Mobile 
Telecommunications System (UMTS); Mobile radi
o interface Layer 3 specification; Core network 
protocols; Stage 3 (3GPP TS 24.008). 
[42] ETSI TS 101 509: "Digital cellular telecommunications system (Phase 2+) (GSM); Lawful 
Interception; Stage 2 (3GPP TS 03.33)". 
[43] ETSI TS 100 927: "Digital cellular telecommunications system (Phase 2+); Numbering, 
addressing and identification (3GPP TS 03.03)". 
[44] Void. 

[45] ETSI TS 101 347: "Digital cellular telecommunications system (Phase 2+); General Packet Radio 
Service (GPRS); GPRS Tunnelling Protocol (GTP) across the Gn and Gp Interface 

(3GPP TS 09.60)". 
[46] IETF RFC 959: "File Transfer Protocol". 
[47] Void. 

[48] ITU-T Recommendation Q.763: "Signalling System No.7 - ISDN User Part formats and codes". 

[49] ETSI TS 101 393: "Digital cellular telecommunications system (Phase 2+); General Packet Radio 
Service (GPRS); GPRS Charging (3GPP TS 12.15)". 
[50] Void. 
[51] IETF RFC 791: "Internet Protocol". 
[52] IETF RFC 793: "Transmission Control Protocol". 

[53] Void. 

[54] ETSI EN 300 089: "Integrated Services Digital Network (ISDN); Calling Line Identification 
Presentation (CLIP) supplementary service; Service description". 
[55] ETSI TS 100 940: "Digital cellular telecommunica
tions system (Phase 2+); Mobile radio interface 
layer 3 specification (3GPP TS 04.08)". 
[56] ITU-T Recommendation Q.931: "ISDN user-network interface layer 3 specification for basic call 
control". 
[57] ETSI TS 101 109: "Digital cellular telecommunications system (Phase 2+); Universal 
Geographical Area Description (GAD) (3GPP TS 03.32)". 
[58] ITU-T Recommendation E.164: "The international public telecommunication numbering plan". 
[59] IETF RFC 3261: "SIP: Session Initiation Protocol". 
[60] ETSI TS 129 060: "Digital cellular telecommunications system (Phase 2+); Universal Mobile 
Telecommunications System (UMTS); General Packet Radio Service (GPRS); GPRS Tunnelling 

Protocol (GTP) across the Gn and Gp interface (3GPP TS 29.060)". 
[61] ETSI TS 133 108: "Universal Mobile Telecommunications System (UMTS); 3G security; 
Handover interface for Lawful Interception (LI) (3GPP TS 33.108)". 
[62] ETSI TS 125 431: "Universal Mobile Telecommunications System (UMTS); UTRAN Iub 
interface layer 1 (3GPP TS 25.431)". 
[63] ITU-T Recommendation Q.731.3: "Stage 3 description for number identification supplementary 
services using Signalling System No. 7: Calling line identification presentation (CLIP)". 
[64] ITU-T Recommendation Q.951.1: "Stage 3 description for number identification supplementary 
services using DSS 1: Direct-dialling-in (DDI)". 
[65] ITU-T Recommendation Q.951.3: "Stage 3 description for number identification supplementary 
services using DSS 1: Calling line identification presentation". 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)14 [66] ETSI EN 300 092 (all parts): "Integrated Services Digital Network (ISDN); Calling Line 
Identification Presentation (CLIP) supplementary service; Digital Subscriber Signalling System 

No. one (DSS1) protocol". 
[67] ISO 3166-1: "Codes for the representation of names of countries and their subdivisions - 
Part 1: Country codes". 
[68] IETF RFC 3966: "The tel URI for Telephone Numbers". 
[69] ETSI TS 101 909-20-1: "Digital Broadband Cable Access to the Public Telecommunications 
Network; IP Multimedia Time Critical Services; Part 20: Lawful Interception; Sub-part 1: CMS 

based Voice Telephony Services". 
[70] ETSI TS 123 228: "Digital cellular telecommunications system (Phase 2+); Universal Mobile 
Telecommunications System (UMTS); IP Multimedia Subsystem (IMS); Stage 2 
(3GPP TS 23.228)". 
[71] ETSI TS 133 107: "Universal Mobile Telecommunications System (UMTS); LTE; 3G security; 
Lawful interception architecture and functions (3GPP TS 33.107)". 
[72] ETSI EN 301 040: "Terrestrial Tr
unked Radio (TETRA); Security; Lawful Interception (LI) 
interface". 
[73] ETSI TS 100 392-3-6: "Terrestrial Tr
unked Radio (TETRA); Voice plus Data (V+D); 
Part 3: Interworking at the Inter-System Interf
ace (ISI); Sub-part 6: Speech format implementation 
for circuit mode transmission". 
[74] ETSI TS 100 392-3-7: "Terrestrial Tr
unked Radio (TETRA); Voice plus Data (V+D); 
Part 3: Interworking at the Inter-System
 Interface (ISI); Sub-part 7: Speech Format 
Implementation for Packet Mode Transmission". 
[75] Void. 
[76] ETSI TS 123 003: "Digital cellular telecommunications system (Phase 2+); Universal Mobile 
Telecommunications System (UMTS); Numbering, addressing and identification 

(3GPP TS 23.003)". 
[77] ETSI TS 123 060: "Digital cellular telecommunications system (Phase 2+); Universal Mobile 
Telecommunications System (UMTS); General Packet Radio Service (GPRS); Service 

description; Stage 2 (3GPP TS 23.060)". 
2.2 Informative references 
The following referenced documents are not essential to the use of the present document but they assist the user with 
regard to a particular subject area.
 For non-specific references, the latest version of the referenced document (including 
any amendments) applies. 
[i.1] ISO 9798 (all parts): "Information technology - Security techniques - Entity authentication". 

[i.2] Void. 

[i.3] ETSI TS 187 005: "Telecommunications and Internet converged Services and Protocols for 
Advanced Networking (TISPAN); NGN Lawful In
terception; Stage 1 and Stage 2 definition". 
[i.4] ETSI TR 102 503: "Lawful Interception (LI); ASN.1 Object Identifiers in Lawful Interception 
Specifications". 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)15 [i.5] ETSI ES 201 671: "Lawful Interception (LI); 
Handover interface for the lawful interception of 
telecommunications traffic". 
NOTE: Periodically TS 101 671 is published as ES 201 671. A reference to the latest version of the TS reflects 
the latest stable content from ETSI/TC LI. 
3 Definitions and abbreviations 
3.1 Definitions For the purposes of the present document, the following terms and definitions apply: 
Access Provider (AP):
 provides a user of some network with access from the user's terminal to that network 
NOTE: This definition applies specifically for the present 
document. In a particular case, the access provider and 
network operator may be a common commercial entity. 
activation/deactivation of supplementary services:
 procedures for activation, which is the operation of bringing the 
service into the "ready for invocation" state, an
d deactivation, which is the complementary action 
(to) buffer:
 temporary storing of information in case the necessary telecommunication connection to transport 
information to the LEMF is temporarily unavailable 
call:
 any temporary switched connection capable of transferring information between two or more users of a 
telecommunications system 
NOTE: In this context a user may be a person or a machine. 
CC link:
 communication channel for HI3 information between a mediation function and a LEMF 
NOTE: It is used for transmission of the Content of Communication (CC). This term refers to circuit switched 
only. 
CC Link IDentifier (CCLID): 
See definition in clause A.1. 
communication: 
information transfer accordi
ng to agreed conventions 
Communication IDentifier (CID): 
See definition in clause 6. 
Communication Identity Number (CIN):
 See definition in clause 6. 
communications session: 
session that consists of either a single self-conta
ined transaction or a series of protocol data 
units that together form a single self-contained communication 
Content of Communication (CC):
 information exchanged between two or more users of a telecommunication service, 
excluding Intercept Related Information 
NOTE: This includes information which may, as part of 
some telecommunication service, be stored by one user 
for subsequent retrieval by another. 
Handover Interface (HI): 
physical and logical interface across which th
e interception measures are requested from 
network operator/access provider/service provider, and the 
results of interception are delivered from a network 
operator/access provider/service provider to a law enforcement monitoring facility 
identity:
 technical label which may represent the origin or destination of any telecommunications traffic, as a rule 
clearly identified by a physical telecommunication identity 
number (such as a telephone number) or the logical or 
virtual telecommunication identity number (such as a personal number) which the subscriber can assign to a physical 

access on a case-by-case basis 
information: 
intelligence or knowledge capable of being represen
ted in forms suitable for communication, storage or 
processing 
NOTE: Information may be represented for example by signs, symbols, pictures or sounds. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)16 interception: action (based on the law), performed by a networ
k operator/access provider/service provider, of making 
available certain information and providing that information to a law enforcement monitoring facility 
NOTE: In the present document the term interception is not used to describe the action of observing 
communications by a law enforcement agency. 
interception configuration information:
 information related to the configuration of interception 
interception interface: physical and logical locations within the networ
k operator's/access provider's/service provider's 
telecommunication facilities where access to the Content of
 Communication and Intercept Related Information is 
provided 
NOTE: The interception interface is not necessarily a single, fixed point. 
interception measure:
 technical measure which facilitates the interception of telecommunications traffic pursuant to 
the relevant national laws and regulations 
interception subject:
 person or persons, specified in a lawful authorization, whose telecommunications are to be 
intercepted 
Intercept Related Information (IRI):
 collection of information or data associated with telecommunication services 
involving the target identity, specifically communication a
ssociated information or data (including unsuccessful 
communication attempts), service associated information or 
data (e.g. service profile management by subscriber) and 
location information 
Internal Interception
 Function (IIF):
 point within a network or network element at which the Content of 
Communication and the Intercept Related Information are made available 
Internal Network Interface (INI):
 network's internal interface between the Internal Interception Function and a 
mediation function 
invocation and operation:
 describes the action and conditions under which the service is brought into operation 
NOTE 1: In the case of a lawful interception this may only be on a particular communication. It should be noted 
that when lawful interception is activated, invocation is applicable on all communications (invocation 
takes place either subsequent to or simultaneously 
with activation). Operatio
n is the procedure which 
occurs once a service has been invoked. 
NOTE 2: The definition is based on ITU-T Recommendation X.882 [37], but has been adapted for the special 
application of lawful interception, instead of supplementary services.
 Law Enforcement Agency (LEA):
 organization authorized by a lawful authorization based on a national law to 
request interception measures and to receive th
e results of telecommunications interceptions 
Law Enforcement Monitoring Facility (LEMF):
 designated as the transmission destination for the results of 
interception relating to a particular interception subject 
lawful authorization:
 permission granted to a LEA under certain conditions to intercept specified telecommunications 
and requiring co-operation from a networ
k operator/access provider/service provider 
NOTE: Typically this refers to a warrant or order issued by a lawfully authorized body. 
Lawful Interception (LI):
 See interception. 
Lawful Interception
 IDentifier (LIID):
 See definition in clause 6. 
location information: 
information relating to the geographic, physical or logical location of an identity relating to an 
interception subject 
Mediation Function (MF):
 mechanism which passes information between a network operator, an access provider or 
service provider and a Handover Interface, and information between the Internal Network Interface and the Handover 
Interface
 network element:
 component of the network structure, such as a local exchange, higher order switch or service control 
processor 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)17 Network Element IDentifier (NEID): 
See definition in clause 6. 
Network IDentifier (NID): 
See definition in clause 6. 
NetWork Operator (NWO):
 operator of a public telecommunications infrastructure which permits the conveyance of 
signals between defined network termination points by wire, by microwave, by optical means or by other 

electromagnetic means 
PSTN/ISDN Emulation Service:
 mimics a PSTN/ISDN network from the point of view of legacy terminals (or 
interfaces) by an IP network, through a gateway 
NOTE: All PSTN/ISDN services remain available and identi
cal (i.e. with the same ergonomics); such that end 
users are unaware that they are not connected to a TDM-based PSTN/ISDN. 
PSTN/ISDN Simulation Service:
 defines the provision of PSTN/ISDN-like services to advanced terminals (IP-phones) 
or IP-interfaces 
NOTE: There is no strict requirement to make all PSTN/ 
ISDN services available or identical, although end users 
expect to have access to the most popular ones, possibly with different ergonomics. 
Quality of Service (QoS):
 quality specification of a telecommunications channel, system, virtual channel, 
computer-telecommunications session, etc. 
NOTE: Quality of service may be measured, for example, in terms of signal-to-noise ratio, bit error rate, message 
throughput rate or call blocking probability. 
reliability:
 probability that a system or service will perform in a satisfactory manner for a given period of time when 
used under specific operating conditions 
result of interception: 
information relating to a target service, including the Content of Communication and 
Intercept Related Information, which is passed by a network 
operator, an access provider or a service provider to a law 
enforcement agency 
NOTE: Intercept related information is provided
 whether or not call activity is taking place.
 service information:
 information used by the telecommunications infrastructure in the establishment and operation of a 
network related service or services 
NOTE: The information may be established by a network operator, an access provider, a service provider or a 
network user.
 Service Provider (SvP): natural or legal person providing one or more public telecommunications services whose 
provision consists wholly or partly in the transmission and routing of signals on a telecommunications network 
NOTE: A service provider needs not necessarily run his own network. 
sequence number: 
number that counts individual intercepted protocol data units within a communications session 
Short Message Service (SMS):
 service that gives the ability to send character messages to phones 
NOTE: SMS messages can be MO (Mobile Originated) or MT (Mobile Terminated). 
target identity: technical identity (e.g. the interception's subject di
rectory number), which uniquely identifies a target 
of interception 
NOTE: One target may have one or several target identities. 
target service:
 telecommunications service associated with an inte
rception subject and usually specified in a lawful 
authorization for interception 
NOTE: There may be more than one target servi
ce associated with a single interception subject. 
telecommunications:
 any transfer of signs, signals, writing images, sounds, data or intelligence of any nature 
transmitted in whole or in part by a wire, radio, electromagnetic, photoelectronic or photo-optical system 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)18 3.2 Abbreviations For the purposes of the present document, the following abbreviations apply: 
3PTY Three-ParTY service 
AA Abbreviated Address 
AC Alarm Call 

ADMF ADMinistration Function 

AOC Advice Of Charge service 

AP Access Provider 

ASE Application Service Element 
ASN.1 Abstract Syntax Notation One 
BA DSS1 Basic Access 

BC Bearer Capability 

BER Basic Encoding Rules 

BS Basic Service 
CC Content of Communication 
CCBS Completion of Calls to Busy Subscriber 

CCLID CC Link IDentifier 

CCNR Completion of Calls on No Reply 

CD Call Deflection 

CdP Called Party 
CF Call Forwarding 
CFB Call Forwarding on Busy 

CFNR Call Forwarding on No Reply 

CFU Call Forwarding Unconditional 

CGI Cell Global Id 

CgP Calling Party 
CID Communication IDentifier 
CIN Communication Identity Number 

CLI Calling Line Identity (Calling Party Number) 

CLIP Calling Line Identification Presentation 

CLIR Calling Line Identification Restriction 
COL COnnected Line identity (Connected Number) 
COLP COnnected Line identification Presentation 

COLR COnnected Line identification Restriction 

CONF CONFerence call, add-on 

CSCF Call Session Control Function 

CUG Closed User Group 
CW Call Waiting 
DDI Direct Dialling In 

DF Delivery Function 

DIV call DIVersion services 

DN Directory Number 

DNS Domain Name Service 
DSS1 Digital Subscriber Signalling system No.1 
ECT Explicit Call Transfer 

FB FallBack procedure 

FDC Fixed Destination Call 

FPH Free PHone 

FTP File Transfer Protocol 
GCID GPRS Charging ID (GGSN address) 
GGSN Gateway GPRS Support Node 

GLIC GPRS LI Correlation 

GPRS General Packet Radio Service 

GSM Global System for Mobile communications 
GSN GPRS Support Node (SGSN or GGSN) 
GTP GPRS Tunnelling Protocol 

HI Handover Interface 

HI1 Handover Interface port 1 (for administrative information) 

HI2 Handover Interface port 2 (for Intercept Related Information) 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)19 HI3 Handover Interface port 3 (for Content of Communication) 
HLC High Layer Compatibility 

HOLD call HOLD service 

IA5 International Alphabet No. 5 

ICB Incoming Call Barring 

ICID IMS Charging ID 
IE Information Element 
IIF Internal Interception Function 

IMEI International Mobile station Equipment Identity 

IMS IP Multimedia Subsystem 

IMSI International Mobile Subscriber Identity 
IN Intelligent Network 
INI Internal Network Interface 

IP Internet Protocol 

IP-CAN IP-Connectivity Access Network 

IRI Intercept Related Information 

ISDN Integrated Services Digital Network 
ISUP ISDN User Part 
LAC Location Area Code 

LEA Law Enforcement Agency 

LEMF Law Enforcement Monitoring Facility 

LI Lawful Interception 

LIID Lawful Interception IDentifier 
LLC Lower Layer Compatibility 
MAP Mobile Application Part 

MCID Malicious Call IDentification 

MF Mediation Function 

MMC Meet-Me Conference 

MO Mobile Originated 
MS Mobile Station 
MSISDN Mobile Subscriber ISDN Number 

MSN Multiple Subscriber Number 

MT Mobile Terminated 

MWI Message Wait Indication 
NDUB Network Determined User Busy 
NEID Network Element IDentifier 

NID Network IDentifier 

NWO NetWork Operator 

OCB Outgoing Call Barring 

OID Object IDentifiers 
PDP Packet Data Protocol 
PLMN Public Land Mobile Network 

PR Partial Rerouting 

PSTN Public Switched Telephone Network 

QoS Quality of Service 

RAI Routeing Area Identifier 
ROSE Remote Operation Service Element 
Rx Receive direction 
SAC System Area Code 
SCF Service Control Function 

SCI Subscriber Controlled Input 

SDP Session Description Protocol 

SGSN Serving GPRS Support Node 

SIP Session Initiation Protocol 
SMS Short Message Service 
SS No.7 common channel Signalling System ITU (T) No. 7 

SS Supplementary Service 

SSF Service Switching Function 

SUB SUBaddressing (supplementary service) 
SvP Service Provider 
TCP Transmission Control Protocol 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)20 TEI Terminal Equipment Identity 
TETRA TErrestrial Trunked RAdio 

TMR Transmission Medium Requirement 

TP Terminal Portability 

T-PDU Tunnelled PDU 
Tx Transmit direction 
UDUB User Determined User Busy 
UMTS Universal Mobile Telecommunication System 
URI Uniform Resource Identifier 
URL Universal Resource Locator 

UTM Universal Transverse Mercator 

UUS User-to-User Signalling 

WGS World Geodetic System 

WUS Wake-Up Service 
xGSN SGSN or GGSN 
4 General requirements 
The present document focuses on the Handover Interface related 
to the provision of information related to LI between a 
network operator, access provider and/or service provider and a Law Enforcement Agency (LEA). 
4.1 Basic principles for the Handover Interface 
The network requirements mentioned in the present document are derived, in part, from the requirements defined in 

ES 201 158 [2]. 
Lawful interception requires functions to be provided in some, or all of, the switching or routing nodes of a 
telecommunications network. 
The specification of the Handover Interface is subdivided into
 three ports each optimized to the different purposes and 
types of information being exchanged. 
The interface is extensible. 
4.2 Legal requirements 
It shall be possible to select elements from th
e Handover Interface specification to conform with: 
• national requirements; 
• national law; 
• any law applicable to a specific LEA. 
As a consequence, the present document shall define, in
 addition to mandatory requirements, which are always 
applicable, supplementary options, in 
order to take into account the various influences listed above. See also 
TS 101 331 [1] and ETR 330 [3]. 
4.3 Functional requirements 
A lawful authorization shall describe the kind of information (Intercept Related Information (IRI) or both IRI and 

Content of Communication (CC)) that is required by this LEA, the interception subject, the start and stop time of LI, 

and the addresses of the LEAs for CC and/or IRI and further information. 
A single interception subject may be the subject to intercep
tion by different LEAs. It shall be possible strictly to 
separate these interception measures. 
If two targets are communicating with each other, each target is dealt with separately. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)21 5 Overview of Handover Interface 
The generic Handover Interface adopts a three-port structure such that administrative information (HI1), Intercept 
Related Information (HI2) and the Content of Communication (HI3) are logically separated. 
Figure 1 shows a block diagram with the relevant entities for Lawful Interception (LI). 

The outer circle represents the NWO/AP/SvP's domain with respect to lawful interception. It contains the network 
internal functions, the Internal Network Interface (INI), th
e administration function and the mediation functions for IRI 
and CC. The inner circle contains the internal functions of the network (e.g. switching, routing, and handling of the 
communication process). Within the network internal function the results of interception (IRI, CC) are generated in the 
IIF. 
The Internal Interception Functions (IIF) provide the Content of Communication (CC) and the Intercept Related 
Information (IRI), respectively, at the Internal Network Interface INI. For both kinds of information, mediation 

functions may be used, which provide the final representation of the standardized Handover Interfaces at the 
NWO/AP/SvP's domain boundary. 
Within the NWO/AP/SvP's administration centre, the LI relate
d tasks, as received via interface HI1, are translated into 
man machine commands for the NWO/AP/SvP's equipment. 
Depending on the type of network, there might be a need to standardize also some or all of the Internal Network 
Interfaces (INI). Such standards are not in the scope of the present document. 
 NOTE 1: Figure 1 shows only a reference configuration, with a logical representation of the entities involved in 
lawful interception and does not mandate separate physical entities. 
NOTE 2: The mediation functions may be transparent. 

 Figure 1: Functional block diagram showing Handover Interface HI 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)22 5.1 Handover Interface port 1 (HI1) 
The Handover Interface port 1 shall transport various kinds of administrative information from/to the LEA and the 
organization at the NWO/AP/SvP, which is responsible for 
LI matters. This interface may be manual or electronic. 
The HI1 interface may be crossing borders between countries. This possibility is subject to corresponding international 
laws or agreements. 
A complete separation is required between the administrative 
part (HI1) and the technical part (INI) of the interface.  
No direct access to the switching function shall be given to
 the LEMF. Activation, deactivation or modification of an 
interception in the switching function shall only be possible by the NWO/AP/SvP. 
As an option, in direction to the LEA, some HI1 related information (e.g. fault reporting) may be delivered directly 
using the HI2 mechanism. As an additional option, in direction to the LEA, some HI1 related information may be 
delivered directly, for example, as part
 of a lawful authorization procedure. 
Further description of HI1 is given in clause 7. 
5.1.1 Manual interface 
If the HI1 is designed as a manual interface, it will normal
ly consist of paper documents. The request for lawful 
interception may be sent via letter or via fax to the administration centre of the NWO/AP/SvP. The personnel of the 

administration centre will take the request and activate it in the network element (activation of interception). After the 
interception specified in the lawful author
ization is activated, the LEA will be inform
ed, see clause 7. From this point in 
time on, the LEA shall be prepared to receive Inter
cept Related Information (IRI) via HI2 and Content of 
Communication (CC) via HI3. 
5.1.2 Electronic interface 
An alternative solution may be the electronic transmission of the request for lawful interception. 
The information content shall be such that the authorized personnel of the NWO/AP/SvP is able to map it to the 
information which is required to activate the interception with a minimum of manual translation. This principle reduces 

the probability of errors. 
5.2 Handover Interface port 2 (HI2) 
The Handover Interface port 2 shall transport the IRI from the NWO/AP/SvP's IIF to the LEMF. 
The delivery shall be performed via data communication methods which are suitable for the network infrastructure and 
for the kind and volume of data to be transmitted. 
The delivery can in principle be made via different types of lower communication layers, which should be standard or 
widely used data communication protocols. 
The individual IRI parameters shall be coded using ASN.1 and the Basic Encoding Rules (BER). The format of the 
parameter's information content shall be based on existing telecommunication standards, where possible. 
The individual IRI parameters have to be se
nt to the LEMF at least once (if available). 
The IRI records are transmitted individually, or as an option, IRI records can be aggregated for delivery to the same 
LEA (i.e. in a single delivery interaction). As there are time 
constraints associated with the delivery of IRI, the use of 
this optional feature is subject to national or regional requirements. As a general principle, IRI records shall be sent 

immediately and shall not be held in the MF/DF in order to use the IRI record aggregation option. 
The IRI records shall contain information available from normal network or service operating procedures. In addition 
the IRI records shall include information for identification and 
control purposes as specifically required by the HI2 port. 
The IIF is not required to make any attempt to request explicitly extra information which has not already been supplied 
by a signalling system. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)23 5.3 Handover Interface port 3 (HI3) 
The appropriate form of HI3 depends upon the technology being intercepted, see clause 9. 
6 Specific identifiers for LI 
Specific identifiers are necessary
 to identify a target for interception uniquely and to correlate between the data, which 
is conveyed over the different Handover Interfaces (H
I1, HI2 and HI3). The identifiers, which apply to all 
communication technologies, are defined in the clauses below. Additional technology specific identifiers are defined in 

related annexes. 
6.1 Lawful Interception IDentifier (LIID) 
For each target identity related to an 
interception measure, the au
thorized NWO/AP/SvP operator shall assign a special 
Lawful Interception IDentifier (LIID), which has been agreed between the LEA and the NWO/AP/SvP. It is used within 

parameters of all HI interface ports. 
Using an indirect identification, pointing to a target identity makes it easier to keep the knowledge about a specific 
interception target limited within the authorized NWO/AP/SvP operators and the handling agents at the LEA. 
The Lawful Interception IDentifier LIID is a component of the 
CC delivery procedure and of the IRI records. It shall be 
used within any information exchanged at the Handover 
Interfaces HI2 and HI3 for identification and correlation 
purposes. 
The LIID format shall consist of alphanumeric characters (o
r digit string for subaddress option, see annex E). It might 
for example, among other information, contain a lawful aut
horization reference number, and the date, when the lawful 
authorization was issued. 
The authorized NWO/AP/SvP shall either enter a unique LIID 
for each target identity of the interception subject or as a 
national option a single LIID for multiple target identities all pertaining to the same interception subject. 
EXAMPLE: The interception subject has an ISDN access with three MSNs. The NWO/AP/SvP enters for each 
MSN an own LIID, or optionally enters one LIID for all three MSNs. 
If more than one LEA intercepts the same target identity, 
there shall be unique LIIDs assigned, relating to each LEA. 
6.2 Communication IDentifier (CID) 
NOTE 1: Was called "Call Identifier" in V1.1.1 of ES 201 671 [i.5]. It is renamed because of new technologies. 
For each activity relating to a target identity a CID is genera
ted by the relevant network element. The CID consists of 
the following two identifiers: 
• Network IDentifier (NID). 
• Communication Identity Number (CIN) - optional. 
NOTE 2: For all non CC related records like SMS, SCI, etc. no correlation to a CC could be made. 
The CID distinguishes between the different activities of the target identity. It is also used for correlation between IRI 
records and CC connections. It is used
 at the interface ports HI2 and HI3. 
The Communication IDentifier is specified in the clauses below. For ASN.1 coding details, see annex D. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)24 6.2.1 Network IDentifier (NID) 
The Network IDentifier (NID) is a mandatory parameter; it should be internationally unique. It consists of one or both 
of the following two identifiers: 
1) NWO/AP/SvP- identifier (mandatory):  
Unique identification of network operato
r, access provider or service provider. 
2) Network Element IDentifier (NEID) (optional):  
The purpose of the network element identifier is to uniquely identify the relevant network element carrying out 

the LI operations, such as LI activation, IRI record sending, etc. 
 A network element identifier may be: 
- an E.164 international node number in the case of circuit switched networks, such as ISDN, PSTN, 
GSM; 
- an X.25 address; 

- an IP address. 
6.2.2 Communication Identity Number (CIN) - optional 
NOTE 1: Was called "Call Identity Number" in V1.1.1 of
 ES 201 671 [i.5]. It is renamed because of new 
technologies. 
This parameter is mandatory for IRI in case of reporting events for connection-oriented types of communication 
(e.g. circuit switched calls). 
The Communication Identity Number (CIN) identifies uniquely an intercepted communication session within the 
relevant network element. All the results of interception within a single communications session must have the same 

CIN. If a single interception subject has two or more communications sessions through the same operator, and through 
the same network element then the CIN for each session shall be different. 
NOTE 2: If two or more target identities, related either to a unique interception subject or to different interception 
subjects, are involved in the same communication the same CIN value may be assigned by the relevant 

network element to the communication sessions of the different target identities. 
7 HI1: Interface port for administrative information 
The interface HI1 is typically bi-directional. It is used 
to hand over the requests for lawful interception to the 
NWO/AP/SvP, such as orders for activation, deactivation and modification, and the corresponding notifications, and 
send other information to the LEA. 
There shall be no direct control over the NWO/AP/SvP's equipment by the LEA/LEMF. 
7.1 Information for the activation of lawful interception 
The HI1 interface may be realized as manual 
or electronic processing, see clause 5.1. 
If the LEA requests lawful interception, the NWO/AP/SvP needs a minimum set of information to activate lawful 
interception in the network. 
The LEA shall provide the following information, for activation of LI: 
1) Identification of the interception subject: target identity. 
2) The agreed Lawful Interception IDentifier (LIID). 
3) Start and end (or duration) of the interception. 

4) Further specification of type of interception, i.e. kind of information to be provided (IRI or both IRI and CC). 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)25 5) HI2 destination address of the LEMF, to which the IRI-Records shall be sent (if applicable). 
6) HI3 destination address of the LEMF, to which the Content of Communication (CC) shall be sent 
(if applicable). 
7) Other network dependent parameters (e.g. location information, delivery mechanisms used for HI2 and HI3). 

8) A reference for authorization of the interception. 

9) Technical contact for issues relating to set-up and execution of the interception (e.g. solution of problems with 
communication links to the LEMF). 
10) Other information as required. 
7.2 LI notifications towards the LEMF 
LI management notifications to the LEMF shall be sent in the following cases: 
1) After the activation of lawful interception. 

2) After the deactivation of lawful interception. 

3) After modification of an active lawful interception. 

4) In case of certain exceptional situations. 
For the definition of the information content of these LI management notifications, see clause D.4. 
8 HI2: Interface port for In
tercept Related Information The HI2 interface port shall be used to transport all Intercep
t Related Information (IRI), i.e. the information or data 
associated with the communication services of the target identity apparent to the network. It includes signalling 

information used to establish the telecommunication service and to control its progress, timestamps, and, if available, 

further information such as supplementary service information or location information. Only information which is part 

of standard network signalling procedures shall be used within communication related IRI, see also clause 5.2; e.g. if 
information of the other party is not available, it need not be
 requested from the origin, by extra procedures, especially 
when such procedures are not provided by the used network protocols. 
Sending of the Intercept Related Information (IRI) to the LEMF shall in general take place as soon as possible, after the 
relevant information is available. 
In exceptional cases (e.g. data link failure), the Intercept Related Information (IRI) may be buffered for later 
transmission for a specified period of time. 
Within this clause only definitions are made which apply in general for all network technologies. Additional technology 
specific HI2 definitions are specified in related annexe
s (e.g. for circuit switched communication technologies, 
see clause A.3). 
8.1 Data transmission protocols 
The protocol used by the "LI application" for the encoding and the sending of data between the MF and the LEMF is 

based on already standardized data transmission protocols like ROSE or FTP, see annex C. 
The specified data communication methods provide a genera
l means of data communication between the LEA and the 
NWO/AP/SvP's mediation function. They are used for the delivery of: 
• HI1 type of information (notifications and alarms); 
• HI2 type of information (IRI records); 
• HI3 data type of information in certain circumstances (UUS, SMS, etc.). 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)26 The present document specifies the use of the two possible methods for delivery: ROSE or FTP on the application layer 
and the BER on the presentation layer. The lower layers for data communication may be chosen in agreement with the 

NWO/AP/SvP and the LEA. 
The delivery to the LEMF should use the Internet protocol stack.
 8.1.1 Application for IRI (HI2 information) 
As defined in clause 5.2, the Handover Interface port 2 shall transport the Intercept Related Information (IRI) from the 
NWO/AP/SvP's MF to the LEMF. 
The individual IRI parameters shall be coded using ASN.1 and the Basic Encoding Rules (BER). Where possible, the 
format of the information content shall be taken over from existing telecommunication standards, which are used for 
these parameters with the network already (e.g. the ISDN user part, DSS1, MAP and IP). Within the ASN.1 coding for 

IRI, such standard parameters are typically defined as octet strings. 
8.2 Types of IRI records 
Intercept related information shall be conveyed to the LEMF in messages, or IRI data records, respectively.  

Four types of IRI records are defined: 
1) IRI-BEGIN record at the first event of a communication attempt, opening the IRI transaction; 

2) IRI-END record at the end of a communication or 
communication attempt, closing the IRI transaction; 
3) IRI-CONTINUE record at any time during a communication or communication attempt within the IRI 
transaction; 
4) IRI-REPORT record used in general for non-communication related events. 
For information related to an existing communication case, the record types 1 to 3 shall be used. They form an IRI 
transaction for each communication case or communication atte
mpt, which corresponds directly to the communication 
phase (set-up, active or release). 
Record type 4 is used for non-communication related subscriber action, like Subscriber Controlled Input (SCI) for 
service activation. For simple cases, it can also be applicable for reporting unsuccessful communication attempts. 
The record type is an explicit part of the record. The 4 r
ecord types are defined independently of target communication 
events. The actual indication of one or several communication 
events, which caused the generation of an IRI record, is 
part of further parameters within the record's information co
ntent. Consequently, the record types of the IRI transactions 
are not related to specific messages of the signalling prot
ocols of a communication case, and are therefore independent 
of future enhancements of the intercepted services, of network specific features, etc. Any transport level information 
(i.e. higher-level services) on the ta
rget communication-state or other target communication related information is 
contained within the information content of the IRI records. 
9 HI3: Interface port for Content of Communication 
The port HI3 shall transport the Content of the Communication (CC) of the intercepted telecommunication service to 

the LEMF. The Content of Communication (CC) shall be presented as a transparent en-clair copy of the information 
flow during an established, frequently bi-directional, communication of the interception subject. When encryption is 
provided and managed by the network, it shall be a national option as to whether the network provides the CC to the 

LEA decrypted, or encrypted with keys and additional information to make decryption possible. Encryption not 

provided or managed by the network, e.g. user provided end-to-end encryption, cannot be removed by the network. 
As the appropriate form of HI3 depends upon the service being intercepted, HI3 is described in relevant annexes. 

The HI2 and HI3 are logically different interfaces, even thou
gh in some installations the HI2 and HI3 packet streams 
might also be delivered via a common transmission path from
 a MF to a LEMF. It is possible to correlate HI2 and HI3 
packet streams by having common (referencing) data fields embedded in the IRI and the CC packet streams. This may 

be possible, e.g. for packet switched, but not for analogue circuit switched networks. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)27 10 Performance and quality 
10.1 Timing 
As a general principle, within a telecommunication system, Intercept Related Information (IRI), if buffered, should be 
buffered for as short a time as possible. 
NOTE: If the transmission of Intercept Related Information fails, it may be buffered or lost. 
10.2 Quality 
The Quality of Service (QoS) associated with the result of interception should be (at least) equal to the 
Quality of Service (QoS) of the original Content of Communication (CC). 
11 Security aspects 
This clause will give an informative overview of the secu
rity properties and mechanisms that can be used to meet 
possible security requirements for the transportation of Lawful Intercepted data. 
11.1 Security properties 
A secure communication channel has the following properties: 
- confidentiality; 

- integrity; 

- authentication; 
- availability. 
Confidentiality
 means that it is impossible to interpret the data by eavesdropping on the communication link. 
Integrity
 means that any alteration or mutilation of the transported data is immediately detected. 
Authentication
 means that the communicating parties have verified and confirmed each others' identities. 
Availability
 means that the communicating parties have made agreements about up- and downtimes of the systems. In 
case of irregularities, alarm messages should be sent through another communication channel. Because of the nature of 
the transported data, confidentiality can be an issue. Lawful Intercepted data can also be confidential or secret by law 
and appropriate measures need to be taken to prevent eavesdropping by unauthorized third parties. 
Integrity can be an issue when Lawful Intercepted data is used as evidence in a criminal investigation. It must be 
provable that the data is unaltered and an exact
 representation of the intercepted communication. 
In the process of Lawful Interception (LI) it is very important
 to know that the LEMF is receiving the data from a real 
MF and the MF needs to be sure that it is sending its data to a real LEMF. If this verification of identity does not take 
place, Lawful Intercepted data might end up in the wrong place 
or the LEMF is processing data that is originating from 
an unauthorized source. 
The process of Lawful Interception (LI) takes place during well-defined periods of time. In case of any irregularities, 
appropriate actions need to be taken. Irregularities can be a sign of a breach of security, loss of data or detection of 

interception. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)28 11.2 Security mechanisms 
This clause will give an overview of possible mechanisms
 to achieve the properties as described above. Technical 
details are to be decided during the process of implementation. 
Confidentiality can be achieved by using encryption. A common technique is to use a symmetric encryption algorithm. 
A symmetric algorithm is an algorithm where both commu
nicating parties use the same key for encryption and 
decryption. This key must be exchanged in a secure way. 
Integrity can be achieved using hashing algorithms. These algorithms generate a unique fingerprint of the transported 
data. When the transported data is altered, the fingerprint does not match anymore and appropriate actions can be 

undertaken (like retransmission of data). 
Authentication can be achieved using cryptographic techniqu
es. A common technique is to use asymmetric encryption. 
In this technique, both parties have two keys: A public key and a private key. Data encrypted with one key can only be 

deciphered with the other. If party X encrypts something using the public key of party Y then party Y is the only one 

able to decrypt this data using his private key. If party X encrypts something using his private key then this data can 

only be deciphered using his public key. By combining these properties, both parties can make sure that they are 
communicating with the right party. 
12 Quantitative aspects 
See ES 201 158 [2]. The number of targets based on a percentage of subscribers should be provided at a national level 
together with an indication 
as to the expected usage. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)29 Annex A (normative): 
Circuit switched network handover 
This annex is applicable to 64 kbit/s based circuit switched networks. 
A.1 Specific identifiers for LI 
In this clause, additional identifiers, which are needed in circuit switched networks are described here. See clause 6. 
A communication is a call in a circuit switched network. 
A.1.1 CC Link IDentifier (CCLID) 
This identifier is only used at the interface ports HI
2 and HI3 in case of the reuse of CC links (option B, 
see clause A.5.4.2). 
For each CC link, which is set up by the mediation function towards the LEMF, a CC Link IDentifier (CCLID) is 
transmitted in the HI2 records and HI3 set-up message in addition to CIN and NID. For the correct correlation of 

multiparty calls this identity number indicates in the IRI reco
rds of each multiparty call, which CC link is used for the 
transmission of the CC. 
The CCLID may use the same format as the CIN; in this case, it need not be transmitted explicitly during set up of the 
CC links, as part of HI3. The CIN may also implicitly represent the CCLID. 
A.1.2 Circuit switched LI correlation between CC and IRI 
To assure correlation between the independently transmitted Content of Communication (CC) and Intercept Related 

Information (IRI) of an intercepted call the following parameters are used: 
• Lawful Interception IDentifier (LIID), see clause 6.1; 
• Communication IDentifier (CID), see clause 6.2; 
• CC Link IDentifier (CCLID), see clause A.1.1. 
These parameters are transferred from the MF to the LEMF in: 
• HI2, see clause A.3.2.1; 
• HI3, see clause A.4.2. 
A.1.3 Usage of identifiers 
The identifiers are exchanged between the mediation function and the LEMF via the interfaces HI1, HI2 and HI3. There 
exist several interface options for the exchange of information. Tables A.1.1 and A.1.2 define the usage of numbers and 

identifiers depending on these options. 
NOTE: X in tables A.1.1 and A.1.2: Identifier used within parameters of the interface. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)30 Table A.1.1: Usage of identifiers, IRI and CC transmitted; options A, B (see clause A.5.4) 
Identifier IRI and CC transmitted (option A)
 IRI and CC transmitted (option B)
  HI1 HI2 HI3 HI1 HI2 HI3 LIID X X X X X X 
NID  X X  X X 
CIN  X X  X X (see note 1) 
CCLID     X X (see note 2) 
NOTE 1: The CIN of the first call for which this CC link has been set-up. 
NOTE 2: The CCLID may be omitted, see clause A.1.1. 
 Table A.1.2: Usage of identifiers, only IRI transmitted 
Identifier Only IRI transmitted
  HI1 HI2 LIID X X NID  X 
CIN  X 
CCLID    A.2 HI1: interface port 
for administrative state 
There are no additions beyond clause 7. 
A.3 HI2: interface port for IRI 
A.3.1 Definition of Intercept Related Information (IRI) 
Intercept Related Information (IRI) will in principle be available in the following phases of a call (successful or not): 
1) At call initiation when the target identity becomes active, at which time call destination information may or 
may not be available (set up phase of a call, target may 
be the originating or terminating party, or be involved 
indirectly by a supplementary service). 
2) At the end of a call, when the target identity becomes inactive (release phase of call). 

3) At certain times between the above phases, when relevant information becomes available (active phase of 
call). 
In addition, information on non-call related actions of a target constitutes IRI and is sent via HI2, e.g. information on 
Subscriber Controlled Input (SCI). 
The Intercept Related Information (IRI) may be subdivided into the following categories: 
1) Control information for HI2 (e.g. correlation information). 

2) Basic call information, for standard calls between two parties. 

3) Information related to supplementary services, which have been invoked during a call. 
4) Information on non-call related target actions. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)31 A.3.2 Structure of IRI records 
Each IRI-record contains several parameters. In the clauses below, the usage of these parameters is explained in more 
detail. 
Mandatory parameters are indicated as HI2 control informat
ion. Optional parameters are provided depending on the 
availability at the MF. For the internal structure of the IRI records, the ASN.1 description, with the application of the 

Basic Encoding Rules (BER) is used. This ASN.1 specification is enclosed in annex D. 
A.3.2.1 Control information for HI2 
The main purpose of this information is the unique identification of records related to a target identity, including their 

unique mapping to the links carrying the Content of Communication (CC). In general, parameters of this category are 

mandatory, i.e. they have to be provided in any record. 
The following items are identified (in brackets: ASN.1 name and reference to the ASN.1 definition or clause D.5): 
1) Record type (
IRIContent
, see clause D.5) 
IRI-BEGIN, IRI-CONTINUE, IRI-END, IRI-REPORT-record types. 
2) Version indication (
iRIversion
, see clause D.5) 
Identification of the particular vers
ion of the HI2 interface specification. 
3) Communication IDentifier (
CommunicationIdentifier,
 see clauses 6.2 and D.5). 
4) Lawful Interception IDentifier (
LawfulInterceptionIdentifier,
 see clauses 6.1 and D.5). 
5) Date and time (
TimeStamp
, see clause D.5) 
Date and time of record trigger condition.  

The parameter shall have the capability to indicate whether the time information is given as Local time without 

time zone, or as UTC. Normally, the NWO/AP/SvP shall define these options. 
6) CC Link IDentifier (
CC-Link-Identifier
, see clause A.1.2 for definition and clause D.5 for ASN.1 definition). 
Table A.3.1 summarizes the items of HI2 control information. It is mandatory information, except the CID - it may be 
omitted for non-call related IRI records - and the CCLID. Their format and coding definition is LI specific, i.e. not 

based on other signalling standards. 
Table A.3.1: Parameters for LI control info
rmation in IRI records (HI2 interface port) 
IRI parameters: LI
 control information
 IRI parameter name
 ASN.1 name (used in annex
 D) Type of record IRIContent 
Version indication iRIversion 
Lawful Interception IDentifier (LIID) LawfulInterceptionIdentifier 
Communication IDentifier (CID): 
 - Communication Identity Number (CIN); 

 - Network IDentifier (NID). 
CommunicationIdentifier 
Date and time TimeStamp 
CC Link IDentifier (CCLID)  
(only used in case of option B) 
CC-Link-Identifier  
 A.3.2.2 Basic call information 
This clause defines parameters within IRI records for basic calls, i.e. calls, for which during their progress no 
supplementary services have been invoked. In general, the parameters are related to either the originating or terminating 
party of a call; consequently, ASN.1 containers are defined fo
r the originating/terminating types of parties, which allow 
including the relevant, party-related information. The structure of these containers and the representation of individual 

items are defined in clause D.5. 
NOTE: A third type of party information is defined for the forwarded-to-party (see clause A.3.2.3 on calls with 
supplementary services being invoked). 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)32 The items below are to be included, when they become available for the first time during a call in progress. If the same 
item appears identically several times during a call, it needs only to be transmitted once, e.g. in an IRI-BEGIN record. 

The ASN.1 name of the respective parameters, as defined in clause D.5, is indicated in brackets: 
1) Direction of call (
intercepted-Call-Direct
) Indication, whether the target identity is originating or terminating Party. 
2) Address of originating and terminating parties (
CallingPartyNumber 
or CalledPartyNumber
) If e.g. in case of call originated by the target at
 transmission of the IRI-BEGIN record only a partial 
terminating address is available, it shall be transmitted,
 the complete address shall follow, when available. 
3) Basic Service, LLC (
Services-Information
)  Parameters as received from signalling protocol (e.g. BC, HLC, TMR, LLC). 
4) Cause (
ISUP-parameters
 or DSS1-parameters-codeset-0
) Reason for release of intercepted call. Cause value as r
eceived from signalling protocol. It is transmitted with 
the ASN.1 container of the party, which initiated the release; in case of a network-initiated release, it may be 

either one. 
5) Additional network parameters 
E.g. location information (
Location
). 
Parameters defined within tables A.3.2 and A.3.3 shall be used for existing services, in the given ETSI format. National 
extensions may be possible using the ASN.1 parameter 
National-Parameters
. A.3.2.3 Information on Supplementary Se
rvices, related to a call in progress 
The general principle is to transmit service related information within IRI records, when the corresponding 
event/information, which needs to be conveyed to the LEMF, 
is received from the signalling protocol. Where possible, 
the coding of the related information shall use the same formats as defined by standard signalling protocols. 
The selection, which types of events or information elements are relevant for transmission to the LEAs is conforming to 
the requirements defined in TS 101 331 [1] and ES 201 158 [2]. 
A dedicated ASN.1 parameter is defined for supplementary services related to forwarding or re-routing calls 
(forwarded-to-Party
 information), due to the major relevance of these kinds of services with respect to LI. For the 
various cases of forwarded calls, the information related to forwarding is included in the 

originatingParty
/terminatingParty
/forwarded-to-Party
 information: 
1) If a call to the target has been previously forwarded, available parameters relating to the redirecting party(ies) 
are encapsulated within the 
originatingPartyInformation
 parameter. 
2) If the call is forwarded at the target's access (conditional or unconditional forwarding towards the forwarded-
to-party), the parameters which are related to the redirecting party (target) are encapsulated within the 
terminatingPartyInformation
 parameter. 
3) All parameters related to the forwarded-to-party or be
yond the forwarded-to-party are encapsulated within the 
forwarded-to-Party
 ASN.1 coded parameter. In addition, this parameter includes the 
supplementary-Services-
Information
, containing the forwarded-to address, and the re
direction information parameter, with the reason 
of the call forwarding, the number of redirection, etc.). 
For the detailed specification of supplementary services related procedures see clause A.5. 

Parameters defined within tables A.3.2 and A.3.3 shall be used for existing services, in the given ETSI format. National 
extensions may be possible using the ASN.1 parameter National-Parameters. 
A.3.2.4 Information on non-call 
related Supplementary Services 
The general principle is to transmit non-call related serv
ice information as received from the signalling protocol. 
A typical user action to be reported is Subscriber Controlled Input (SCI). 

For the detailed specification of the related procedures see clause A.5. 
  ETSI ETSI TS 101 671 V3.5.1
 (2009
-11)33 A.3.3 Selection of parameters for IRI records 
Relevant information on a call is taken from the call handling process, using wherever possible the coding 
specifications of the standardized ISDN protocols, or other standard network protocols. The protocol-defined 
information content is copied 
transparently into the information elements of
 the IRI records. This principle enables to 
reuse of internationally agreed standardization results; it allows reuse of existing functions within the NWO/AP/SvP 

equipment and in the
 terminal area (LEMF). 
Consequently, the present document needs for a large number of IRI-relevant items only to refer to other, existing 
standards, instead of including separate definitions in its scope. By this principle, also consistency issues and 

dependencies on the ongoing enhancements of the various protocols are minimized. 
The relevant parameters are listed in tables A.3.2 and A.3.3. 
For other signalling systems, which are not included in table A.3.2, the parameters shall be interpreted on a functional 
level, for defining their applicability in an IRI record; e.g. in case of a local call between analogue users, the 
called 
party number
 may only exist in an internal format of the switching system. Within the IRI records, such parameters 
shall also use the standardized coding. Existing interworking specifications, like EN 300 097-1 [14] shall be used for 
the conversion to the standard format. If the signalling system provides less information than defined by the standards in 
table A.3.2, spare or default values may be used instead. 
This method avoids the need to analyse for all situations, es
pecially in the area of supplementary services, each detail of 
the service procedures, with specification of which parameter sh
all be sent in which state or situation. Instead, only a 
reference to the applicable standards is made. As soon as a parameter defined in one of the parameter tables appears 

within the target call protocol, it shall be transmitted within an IRI record. 
In addition to parameters taken from the call handling process, further, lawful interception specific parameters are 
needed, like the control information for LI. 
Three types of origins for the specification of HI2 parameters in IRI records can be differentiated: 
1) Parameters for LI control information; they are sp
ecific for the LI HI2 interface, and are specified in the 
present document (see table A.3.1). 
2) Parameters used to convey information to the LEMF, which is retrieved from the target's call or service 
signalling protocol information (see table A.3.2). Within the IRI a standardized protocol coding is used. 
The relevant protocol specifications are the ISDN user part, as a generic protocol, used by several types of 
networks, and dedicated network protocols, e.g. DSS1 or GSM standards. For a common implementation in 

different countries and to guarantee the possibility of an interception measure across borders only parameters 

defined in ETSI standards shall be used. 
3) Parameters used to convey information from events relating to the target call, but with no equivalent 
parameters being available in protocol standards. Such
 parameters shall be specified in the present document 
(see table A.3.3). 
The LI control information is a mandatory part of each 
IRI record (exception: CID), 
the information defined in 
table A.3.3 is included in IRI records, if
 the according parameter or event is detect
ed during processing a call or a target 
identity related action. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)34 Table A.3.2: List of parameters from standard protocols, which may be contained in IRI records 
IRI parameters: target call information, based on standard pro
tocols
 IRI parameter name  
Name of ASN.1 parameter
 (of annex D) 
Related 
standard 
Reference 
Three party conference invoke/result 
components (see note 2) 
PartyInformation 
supplementary-Services-Information 
DSS1 EN 300 188-1 [20] 
Add on conference invoke/result 
components (see note 2) 
PartyInformation 
supplementary-Services-Information 
DSS1 EN 300 185-1 [19] 
Bearer capability 
PartyInformation 
services-Information 
DSS1 EN 300 403-1 [6] 
Call diversion information 
PartyInformation 
supplementary-Services-Information 
ISUP/DSS1 EN 300 356 [5], 
EN 300 207-1 [21] 
Call transfer number 
PartyInformation 
supplementary-Services-Information 
ISUP EN 300 356 [5] 
Called party number 
PartyInformation 
CalledPartyNumber 
ISUP/DSS1/MAP
 EN 300 356 [5], 
EN 300 403-1 [6], 

TS GSM 09.02 [32] 
Called Party Subaddress 
PartyInformation 
supplementary-Services-Information 
DSS1 EN 300 061-1 [10] 
Calling party number 
PartyInformation 
CallingPartyNumber 
ISUP/DSS1 EN 300 356 [5], 
EN 300 403-1 [6] 
Calling Party Subaddress 
PartyInformation 
supplementary-Services-Information 
DSS1 EN 300 061-1 [10] 
Cause indicator 
Release-Reason-Of-Intercepted-Call 
CallContentLinkCharacteristics 
ISUP/DSS1 EN 300 356 [5], 
EN 300 403-1 [6] 
Cell id Location MAP/ISUP 
TS GSM 09.02 [32], 
EN 300 356 [5] 
Closed User Group interlock code 
PartyInformation 
supplementary-Services-Information 
ISUP  
Connected number 
PartyInformation 
supplementary-Services-Information 
ISUP/DSS1 EN 300 356 [5], 
EN 300 097-1 [14] 
Connected subaddress 
PartyInformation 
supplementary-Services-Information 
DSS1 EN 300 097-1 [14] 
Explicit Call Transfer  
invoke/result components (see note 2)
 PartyInformation 

supplementary-Services-Information 
DSS1 EN 300 369-1 [25] 
Facility (see note 3) 
PartyInformation 
supplementary-Services-Information 
DSS1 EN 300 196-1 [29] 
Generic notification indicator 
PartyInformation 
supplementary-Services-Information 
ISUP EN 300 356 [5] 
Generic number 
PartyInformation 
supplementary-Services-Information 
ISUP EN 300 356 [5] 
High layer compatibility 
PartyInformation 
services-Information 
DSS1 EN 300 403-1 [6] 
IMEI 
PartyInformation 
imei 
MAP TS GSM 09.02 [32] 
IMSI 
PartyInformation 
imsi 
MAP TS GSM 09.02 [32] 
Keypad facility 
PartyInformation 
supplementary-Services-Information 
DSS1 EN 300 196-1 [29] 
Location number Location ISUP/MAP 
EN 300 356 [5], 
TS GSM 09.02 [32] 
Low layer compatibility 
PartyInformation 
services-Information 
DSS1 EN 300 403-1 [6] 
MCID response indicator 
PartyInformation 
services-Information 
ISUP EN 300 356 [5] 
MSISDN PartyIdentity/msISDN MAP TS GSM 09.02 [32] 
Original called number 
PartyInformation 
supplementary-Services-Information 
ISUP EN 300 356 [5] 
Redirecting number 
PartyInformation 
supplementary-Services-Information 
ISUP/DSS1 EN 300 356 [5], 
EN 300 207-1 [21] 
Redirection information 
PartyInformation 
supplementary-Services-Information 
ISUP EN 300 356 [5] 
Redirection number 
PartyInformation 
supplementary-Services-Information 
ISUP/DSS1 EN 300 356 [5], 
EN 300 207-1 [21] 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)35 IRI parameters: target call information, based on standard pro
tocols
 IRI parameter name  
Name of ASN.1 parameter
 (of annex D) 
Related 
standard 
Reference 
Subaddress transfer 
PartyInformation 
supplementary-Services-Information 
DSS1 EN 300 369-1 [25] 
Transmission Medium Requirement 
(TMR) 
PartyInformation 
services-Information 
ISUP EN 300 356 [5] 
NOTE 1: Column "Related standard" indicates the ETSI standard, which specifies the format and coding of the 
parameter. 
NOTE 2: Refers to several ASN.1 encoded elements, which are in the DSS1 protocol embedded in a facility 
information element. 
NOTE 3: The facility IE is only included, if it contains one 
or more of the parameters, which are parts of this table. 
 Table A.3.3: List of LI specific parameters, which may be contained in IRI 
IRI parameters: target call information, LI specific definition
 IRI parameter name
 ASN.1 name (used in annex
 D) Direction of call intercepted-Call-Direct 
Call event, e.g.: 
- answer indication 
- call waiting indication 

- hold indication 

- retrieve indication 
- suspend indication 
- resume indication 
simpleIndication 
Ringing duration ringingDuration 
Conversation duration conversationDuration 
CC link information callContentLinkInformation 
Subscriber controlled input data dSS1
-parameters-codese
t-0, or sciData 
NOTE: Format and coding details (see annex D). 
 The general principle is that, if parameters included in table 
A.3.2 are available, they shall be included in an IRI record, 
and be sent to the LEMF. Parameters of table A.3.3, which are not part of standard protocols, shall be included, when 

the according event or parameter, which needs 
to be reported to the LEMF, is detected. 
Parameters of table A.3.1 are present in all IRI records,
 except the Communication Identifier: it may be missing in 
IRI-REPORT records; if no target call is related to it. 
The list can be adapted to the requirements and feature specifications of an NWO/AP/SvP, and the laws and regulations 
of a country. That is, tables A.3.2 and A.3.3 may be extended nationally, or by a NWO/AP/SvP. Further in the present 

document, such extensions are referred to as national extensions or national parameters. 
The IIF for IRI parameter generation may be seen as a kind of screening function, which watches the signalling 
information flow related to a target, and copies those information elements, which match with an element type in the 
screening lists, defined by tables A.3.2 and A.3.3. 
The NWO/AP/SvP is not required to filter information out of the IRI. 

An instance of the IIF for IRI generation needs in general not to store the information it has sent, or other information 
on a call, for the purpose to be aware of the status or context of a call. Each IRI parameter is independent from previous 

or future parameters. Exceptions from this general principle can exist, e.g. in order to avoid multiple transmission of the 
same information. In such a case identical parameters do no
t have to be repeated in succeeding records, unless their 
content or value has changed. 
As it is indicated in table A.3.2, for a given logical parameter different format types may be used, depending on the type 
of network, and the call configuration. If a parameter is sp
ecified in the ISDN user part, 
and also identically in other 
standards, only the ISDN user part is referenced. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)36 A.3.4 Coding of parameters in IRI records 
The parameters shall be included in the IRI records in a 
structured way. The structure is defined using ASN.1, the 
individual parameters are in terms of the ASN.1 notation octet strings, which are taken over from the applicable 
standards. The ASN.1 detailed coding specification is described in annex D. 
In case of the delivery of the IRI records to a LEA, when network specific extensions are used, the network specific 
parameters are transmitted as defined by the sending network. 
A.3.5 Information content of the IRI record types 
In principle, no restriction is made on which parameters shall or may be present in which IRI record type, except for the 

mandatory parameters, which are needed in
 all records. However, the logical information flow of calls implies that 
certain parameters will normally not appear in specific record
s; e.g. a called party number parameter is not included in 
an IRI-END record, because it has already been transmitted earlier. 
A.4 HI3: interface port fo
r Content of Communication 
The port HI3 shall transport the Content of the Communication (CC) of the intercepted telecommunication service to 
the LEMF. The Content of Communication (CC) shall be presented as a transparent en-clair copy of the information 

flow during an established, frequently bi-directional, communication of the interception subject. When encryption is 

provided and managed by the network, it shall be a national option as to whether the network provides the CC to the 

LEA decrypted, or encrypted with keys and additional information to make decryption possible. Encryption not 

provided or managed by the network, e.g. user provided end-to-end encryption, cannot be removed by the network. 
It may contain voice or data. A target call has two directions 
of transmission associated with it, to the target, and from 
the target. Two communication channels to the LEMF are n
eeded for transmission of the Content of Communication 
(stereo transmission). 
The network does not record or store the Content of Communication (CC). 
A.4.1 Delivery of Content of Communication (CC) 
The transmission media used to support the HI3 port shall be standard ISDN calls, based on 64 kbit/s circuit switched 
bearer connections. The CC links are set up on demand 
to the LEMF. The LEMF constitutes an ISDN DSS1 user 
function, with an ISDN DSS1 basic or primary rate access. It 
may be locally connected to the target switching node, or 
it may be located somewhere in the target network or in another network, with or without a transit network in between. 
For network signalling, the standard ISDN user part shall be used. No modifications of the existing ISDN protocols 
shall be required. Any information needed for LI, like to 
enable correlation with the IR
I records of a call, can be 
inserted in the existing messages and parameters, without the need to extend the ETSI standard protocols for the LI 

application. 
For each LI activation, a fixed LEMF address is assigned; this
 address is, within the present document, not used for any 
identification purposes. Identification and 
correlation of the CC links is performed by separate, LI specific information, 
see clauses 6 and A.1. 
The functions defined in the ISDN user part standard, Versio
n 1 (ETSI ISUP V1) are required as a minimum within the 
target network and, if applicable, the destination and transit networks, especially for the support of: 
• Correlation of HI3 information to the other HI port's information, using the supplementary service 
User-to-User Signalling 1 implicit (UUS1). 
• Access verification of the delivery call (see clause A.4.5). 
The bearer capability used for the CC links is 64 kbit/s unrestricted digital information; this type guarantees that the 
information is passed transparently to the LEMF. No specific HLC parameter value is required. 
The CC communication channel is a one-way connection, from the NWO/AP/SvP's IIF to the LEMF, the opposite 
direction is not switched through in the switching node of the target. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)37 The scenario for delivery of the Content of Communication (CC) is as follows: 
1) At call attempt initiation, for one 64 kbit/s bi-directional target call, two ISDN delivery calls are established 
from the MF to the LEMF. One call offers the Content of Communication (CC) towards the target identity 
(CC R
x call/channel), the other call offers the Content of Communication (CC) from the target identity (CC T
x call/channel). See figure A.4.1. 
2) During the establishment of each of these cal
ls, appropriate checks are made (see clause A.4.5). 
3) The MF passes during call set up, within the signalling protocol elements of the CC link the LIID and the CID 
to the LEMF. The LEMF uses this information to identi
fy the target identity and to correlate between the IRI 
and CC (see clause A.4.2). 
4) At the end of a call attempt, each delivery call associated with that call attempt shall be released by the MF. 
Target
TLEMF
other party
PIIFMFTxbearer channel,
 signalling channel
Rxbearer channel,
signalling channel
 Figure A.4.1: Content of Communication transmission from MF to LEMF 
A.4.1.1 Delivery of TETRA CC over 
circuit switched handover networks 
The mechanisms described above apply with the additional constraint that TETRA encoded speech shall be further 
encoded in accordance with the mechanisms defined in TS 100 392-3-6 [73] to fit to a standard 64 kbit/s bearer. 
NOTE: TETRA Switching and Management Infrastructures will in most cases carry TETRA encoded speech to 
allow for transcoder free operation (tandem-free opera
tion) and where transcoding is not provided the 
referenced specification describes a means to transport the TETRA encoded speech over 64 kbit/s TDM 

bearers. 
A.4.2 Delivery of packetized C
ontent of Communication (CC) 
(general) The operation for transmission of UUS and SMS may use the same mechanisms as used for HI2, or a dedicated link 
may be used. The ROSE operations for the transmission of the Content of Communication (HI3 data interface) shall 

follow the same rules as the one defined for the HI2 interface in clause 8.1. 
A differentiation is made between: 
1) bearer related or bearer unrel
ated end user information; and 
2) packet data services. 
NOTE: Exceptionally, for the GSM SMS service, this information may be passed via HI2. HI2 may be used 
optionally to pass the UUS information to the LEMF. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)38 The physical or logical links supporting the Handover Interf
ace traffic should be dimensioned to handle the bandwidth 
of the expected CC. 
A.4.2.1 Delivery of TETRA CC over packet switched handover networks 
The mechanisms described above apply with the additional constraint that TETRA encoded speech shall be encoded in 

accordance with the mechanisms defined in TS 100 392-3-7 [74].  
A.4.3 Control information for circuit switched Content of 
Communication (CC) The delivery calls shall use unmodified standard ISDN protocols (DSS1, ISDN user part). Table A.4.1 summarizes 
specific settings of parameters for the CC links. The User-to-User service 1 parameter is used during call set up (within 
the ISUP Initial Address Message (EN 300 356 [5]) or DSS1 Set Up Message (EN 300 403-1 [6]), respectively) to 

transmit LI-specific control information. This information is
 carried transparently and de
livered to the specific LEMF 
remote user. 
To identify the delivered information, including correlating the delivery calls with the IRI records, parameters 1 to 3 
and 5 shall be included in the call set up. Parameters 6 to 9 specify settings of further relevant information. Other 
parameters of the ISDN protocols shall correspond to normal basic calls. 
Table A.4.1: Definition of HI3 specific signalling information; UUS1 coding details (see clause D.8) 
No. Used information element of 
CC link signalling protocol 
Information 
Purpose 
1 CLI-Parameter with attribute 
"network provided" 
See clause A.4.5 LEMF can check identity of origin of call 
2 UUS1-parameter 
Lawful Interception IDentifier (LIID); 
see clause 6 
Identifier, identifying target identity 
3 UUS1-parameter 
Communication IDentifier (CID), 
see clause 6 
Identifier, identifying specific call of target 
identity 
4 UUS1-parameter 
CC Link IDentifier (CCLID), if 
required; see clause A.1 
Identifier, used for correlation CC link-IRI 
records 
5 UUS1-parameter 
Direction indication 
(communication from/towards 
target/combined (mono)) 
Signal from (T
x)/towards (R
x) target identity or combined 
6 UUS1-parameter Bearer capa
bility of target call 
Indication to the LEMF of the basic 
service in use by the target 
7 Closed User Group interlock 
code 
Closed User Group interlock code  
Supplementary Service CUG Security 
measure at set up of the CC link 
8 Basic Service (BS) 
Basic Service (BS) of CC link:  
64 kbit/s unrestricted 
Guarantee transparent transmission of 
CC copy from MF to LEMF 
9 ISDN user part forward call 
indicators parameter 
ISDN user part preference  
indicator: "ISDN user part required 
all the way" 
Guarantee transparent  
transmission of UUS1 and other 
supplementary services information 
10 
ISDN user part optional forward 
call indicators parameter 
Connected line identity request 
parameter: requested 
Sending of the connected number by the 
destination network 
 Parameters 2, 3 and 4 are also present in the IRI records, fo
r correlation with the CC links. Parameter 5 indicates in case 
of separate transmission of each communication direction, which part is carried by a CC link. Parameter 6, the basic 
service of the target call, can be used by the LEMF for processing of the CC signal, e.g. to apply compression methods 

for speech signals, in order to save storage space. Parameter 7 contains the CUG of the LEA. It is optionally used at set 

up the CC link to the LEA. Parameter 8, the basic service of the CC link, is set to "64 kbit/s unrestricted": All 
information of the R
x, Tx channels can be transmitted fully transparently to the LEA. The setting of the ISDN user part 
indicator guarantees, that the services supporting the LI CC link delivery are available for the complete CC link 
connection. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)39 The MF uses en-bloc dialling, i.e. there exists on
ly one message in forward direction to the LEA. 
NOTE: The LEMF should at reception of the set up me
ssage not use the alerting state, it should connect 
immediately, to minimize time delay until switching 
through the CC links. Not all networks will support 
such a transition. Exceptionally, it may be necessary to send an alerting message before the connected 

message. 
The maximum length of the user information parameter can be more than the minimum length of 35 octets (national 
option, see EN 300 356 [5]), i.e. the network transmitting the CC links shall support the standard maximum size of 
131 octets for the UUS1 parameter. 
The User-to-User service 1 parameter cannot be discarded by the ETSI ISUP procedures: the only reason, which would 
allow the ISUP procedures to discard it would be, if the maximum length of the message carrying UUS1 would be 

exceeded. With the specified amount of services
 used for the CC links, this cannot happen. 
The signalling messages of the two CC channels (stereo mode) carry the same parameter values, except for the direction 
indication. 
See clause D.8 for the ASN.1 definition of the UUS1 LI specific content of the UUS1 parameter. 
A.4.4 Exception handling 
A.4.4.1 Failure of CC links 
If a CC link cannot be set up, a certain number of repeat attempts during a certain period of time shall be made. 
NOTE: Typical values are three tries during 10 s. 
In case of a delay or total failure to transmit the Content of Communication, the target call is handled fully independent 
of the CC link, the CC information gets lost. 
A.4.4.2 Fault reporting 
For several events the target switching function sends messages to the NWO/AP/SvP administration centre. Some 

example events are given in table A.4.2. 
Alternatively, all or some of these events may be transmitted directly to the LEMF. In this case, they are part of the LI 
management notification type of information. 
Delivery to the NWO/AP/SvP administration centre is not part of the HI. 
Table A.4.2: Typical events causing messages 
Event type
 Event causing message with LI alarm information
 CC link failure No answer from LEA 
 LEA is busy 
 CC link failed due to a COLP error 
 CC link failed due to a CUG error 
 CC link set up failure within the network 
 CC link failed due to a lack of system resources 
 General CC link set up failure 
 A.4.5 Security requirements at the interface port HI3 
The process of access verification and additional (optional) authentication between the MF and the LEMF shall not 
delay the set up of the CC. 
For the protection and access verification of the Content of Communication (CC) delivery call the ISDN supplementary 
services CLIP, COLP and CUG shall be used when available in the network involved. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)40 Generally any authentication shall be processed before the set-up of the CC links between the MF and the LEMF is 
completed. If this is technically not feasible the authentication may be processed after completion of the CC connection 

in parallel to the existing connection. 
A.4.5.1 LI access verification 
The supplementary service CLIP shall be used to check for the correct origin of the delivery call. 
NOTE: When using CLIP, the supplementary service CLIR is not applicable. 
The supplementary service COLP shall be used to ensure th
at only the intended terminal on the LEA's side accepts 
incoming calls from the Handover Interface (HI). 
To ensure access verification the following two checks shall be performed: 
• check of Calling Line Identification Presentation (CLIP) at the LEMF; and 
• check of COnnected Line identification Presentation (COL
P) at the Handover Interface (HI) (due to the fact 
that the connected number will not always be transported by the networks involved, there shall be the 

possibility for deactivating the COLP check for a given interception measure. In addition, the COLP check 
shall accept two different numbers as correct numbers, i.e.
 the user provided number and the network provided 
number. Usually, the user provided number contains a DDI extension). 
A.4.5.2 Access protection 
In order to prevent faulty connections to the LEA, the CC links may be set up as CUG calls. 
In this case, the following settings of the CUG parameters should be used: 
• Incoming access: not allowed. 
• Outgoing access: not allowed. 
• Incoming calls barred within a CUG: no. 
• Outgoing calls barred within a CUG: yes. 
A.4.5.3 Authentication 
In addition to the minimum access verification mechanisms described above, optional authentication mechanisms 
according to the standard series ISO 9798 
[i.1]: "Information technol
ogy - Entity authentication" parts 1 to 5 may be 
used. 
These mechanisms shall only be used in addition to the access verification and protection mechanisms. 
A.5 LI procedures for circuit switched supplementary 
services 
A.5.1 General 
In general, LI shall be possible for all connections and activities in which the target is involved. The target shall not be 
able to distinguish alterations in the offered service. It shall also not be possible to prevent interception by invoking 

supplementary services. Consequently, from a supplementary services viewpoint, the status of interactions with LI is 

"no impact", i.e. the behaviour of supplementary services shall not be influenced by interception. 
Depending on the type of supplementary service, additional CC links to the LEA may be required, in addition to already 
existing CC links. 
Within the IRI records, the transmission of additional, supplementary service specific data may be required. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)41 Supplementary services, which have an impact on LI, with 
respect to CC links or IRI record content, are shown in 
table A.5.1. The table is based on ISDN services (DSS1 protocol specifications), it considers the services which have 

been standardized at the time of finalizing the present doc
ument. Future services should be treated following the same 
principles. 
NOTE 1: Co-ordination of handling of new services should be performed via ETSI/TC LI. If required, additions 
will be included in a subsequent version of the present document. 
Services defined for other signalling protocols, which can be related to the services in the table shall be treated in the 
same manner (see also below). Other protocols are e.g.: 
• Analogue user signalling; in general, no ETSI standards are available for supplementary services. 
• Mobile user protocols of the GSM, defined within the MAP (GSM TS 09.02 [32]). 
The question of Lawful Interception (LI) with Intelligent Networks is not covered in the present document (see note 2). 
NOTE 2: The general principle is, that LI takes place on th
e basis of a technical identity, i.e. a directory number. 
Only numbers which are known to the NWO/AP/SvP, and for which LI has been activated in the standard 

way, can be intercepted. No standardized functions
 are available yet which would enable an SCF to 
request from the SSF the invocation of LI for a call. 
Additional CC links are only required, if the target is the served user. IRI Records may also carry data from other 
parties being served users. 
Clause A.6 specifies details for relevant services: 
• The procedures for CC links, depending on the call scenario of the target. 
• Related to the IRI records, the point in time of sending and supplementary service specific information. 
• Additional remarks for services with "no impact" on LI. 
The specifications for supplementary services interactions are 
kept as far as possible independent of the details of the 
used signalling protocols; service related events are therefore described in more general terms, rather than using 
protocol dependent messages or parameters. 
Interactions with services of the same family, like call diversion services, are commonly specified, if the individual 
services behaviour is identical, with respect to LI. 
With respect to the IRI records, clause A.6 specifies typical cases; the general rules for data which shall be included in 
IRI records are defined in clause 8, specifically in clauses A.3.3 and A.5.3. 
Services, which are not part of table A.5.1, do not require the generation of LI information: no CC links are generated or 
modified, and no specific information on the service is present in the IRI records. That is, these services have 

"no impact" on LI; no special functions for LI are required
. However, within the IIF, functions may be required to 
realize the principle, that the service behaviour shall not be influenced by LI. 
"No impact" is not automatically applicable for new services. 
Each new service has to be checked for its impact on LI. 
Additionally, also services using other than the DSS1 protocols, which cannot be related to one of the DSS1 based 
services, may have impact on LI. 
The present document does not intend to give a complete description of all possible cases and access types of 
interactions with supplementary services. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)42 Table A.5.1: Supplementary Services with impact on LI CC links or IRI records content;  
see also clause A.6 
Supplementary 
Service 
Abbr. 
CC links: additional calls, impact  
IRI items related to service  
Call Waiting CW CC links for active or all calls (option A/B) 
Target: call waiting indication, calling party 
address 

other party: generic notification indicator 
call HOLD HOLD CC links for active or all calls (option A/B) 
Target: call hold indication 
other party: generic notification indicator 
call RETRIEVE RETRIEVE
 CC links for active or all calls (option A/B) 
Target: call retrieve indication 
other party: generic notification indicator 
Explicit Call 
Transfer 
ECT Before transfer: see HOLD 
After transfer: LI may or may not be stopped
 Target: components of Facility IE 

other party: generic notification indicator 
Terminal 

Portability 
TP No impact on CC links 
Target: call suspend/resume indications 
other party: generic notification indicator 
SUBaddressing SUB No impact on CC links 
Subaddress IE, as available  
(calling, called, etc.) 
Calling Line 
Identification 
Presentation 
CLIP No impact on CC links 
CLI parameter: part of originating-Party 
information 
Calling Line 

Identification 

Restriction 
CLIR No impact on CC links Restriction indicator is part of CLI parameter 
COnnected Line 
identification 

Presentation 
COLP No impact on CC links 
COL parameter: part of terminating-Party 
information 
COnnected Line 

identification 

Restriction 
COLR No impact on CC links Restriction indicator is part of COL parameter
 Closed User 
Group 
CUG No impact on CC links CUG interlock code 
add on 
CONFerence 
CONF Tx: signal from target; R
x call sum signal 
CC links depending on option A/B 
Target: components of Facility IE 
other party: generic notification indicator 
Three PartY 
conference 
3PTY Initially: held and active calls see HOLD 
Conf.: see CONF 
Target: components of Facility IE 
other party: generic notification indicator 
Call Forwarding 

Unconditional;  
(see note) 
CFU One CC link for each call, which is 
forwarded by the target 
Forwarding by other parties:  

no impact 
Target: see clause A.3.2.3, point 2, 3; if 
redirecting no. = target DN: not included 
Other party (call to target is a forwarded call):
 See clause A.3.2.3, point 1  
Other party (call from target gets forwarded):
 See clause A.3.2.3, point 3 
Call Forwarding 

No Reply;  

(see note) 
CFNR 1) basic call with standards CC links, 
 released after time-out (incl. CC links) 

2) forwarding: same as CFU 
1) basic call, released after time-out, 
 standard IRI 

2) forwarding: same parameters as for CFU 
Call Forwarding 

Busy; (see note) 
CFB Network determined user busy: see CFU 
User determined user busy: see CFNR 
Network determined user busy: see CFU 
user determined user busy: see CFNR 
Call Deflection CD See CFNR See CFNR 
Partial Rerouting
 PR See CFNR See CFNR 
Malicious Call 

IDentification 
MCID No impact on CC links MCID response indicator sent at invocation 
User-to-User  
Signalling 1, 2, 3
 UUS No impact on CC links 
User-to-user information, more data IE 
(part of HI2 information, see clause D.5,  

part of HI3 information, see clause D.6) 
FallBack 

procedure (not a 

Supplementary 

Service) 
FB No impact on CC links Target or other party: new basic service IE 
NOTE: Other variants of Call Forwarding (CF), like forwarding to fixed numbers, to information services, etc. are 
assumed to be covered by the listed services. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)43 A.5.2 CC link Impact 
The column "CC links: additional calls, impact" (see table A.5.1) defines, whether: 
• for the related service CC links shall be set up, in addition to the CC links for a basic call; 
• already existing calls are impacted, for exam
ple by disconnecting their information flow. 
The CC link impact relates always to actions of a target bei
ng the served user. Services invoked by other parties have no 
CC link impact. 
A.5.3 IRI impact, general princi
ple for sending IRI records 
The column "IRI items related to service" (see table A.5.1) specifies, which parameters may be transmitted to the LEA 
within the IRI records. For several services, it is differentiate
d, whether the target or the other party is the served user. 
The table specifies, which parameters are applicable in princi
ple. That is, these parameters are normally sent to the 
LEA, immediately when they are available from the protocol procedures of the service. In many cases, additional 
IRI-CONTINUE records, compared to a basic call, will be generated. However, not each service related signalling 
event needs to be sent immediately within an individual r
ecord. Exceptions may exist, wher
e several events are included 
in one record, even if this would result in some delay of reporting an event (this may be implementation dependent). 

Each record shall contain all information, which is required by the LEA to enable the interpretation of an action. 
EXAMPLE: The indication of call forwarding by the target shall include the forwarded-to number and the 
indication of the type of forwarding within the same record. 
The complete set of parameters, which are applicable for IRI,
 is specified in clause A.3.3 (see tables A.3.2 and A.3.3). 
If during procedures involving supplementary services protocol parameters, which are listed in tables A.3.2 and A.3.3 
become available, they shall be included
 in IRI Records. This rule is directly applicable for parameters received via 
ISUP and DSS1 signalling protocols. Regarding all other protocols, e.g. of analogue users, the mapping to the ISDN 

protocols, as defined in clause A.3.3 is assumed, before discriminating, which (mapped) parameters are copied to the 

IRI records. 
IRI data are not stored by the IIF or MF for the purpose of
 keeping information on call context or call configuration, 
including complex multiparty calls. The LEMF (electronically) or the LEA's agent (manually) shall always be able, to 

find out the relevant history on the call configuration, to the extent, which is given by the available signalling protocol 

based information, within the telecommunication network. 
Service invocations, which result in invoke and return result components (as defined in table A.3.2) need only be 
reported in case of successful invocations. One IRI record, containing the invoke component, possibly including 
additional parameters from the return result component, is sufficient. Instead of the DSS1 functional protocol 

components, for specific networks other ETSI-standardized components may be used, e.g. of the MAP 

(GSM TS 09.02 [32]). 
With respect to the inclusion of LI specific parameters, see also the parameter specifications and example scenarios in 
clause E.3 for more details. 
Details of e.g. the definition of the used record type, their content, the exact points in time of sending, etc. follow from 
the according service specifications; in some cases, they
 are specified explicitly in clauses A.6 and E.3. 
A.5.4 Multi party calls - general principles, options A, B 
Each network must adopt option A or B according to local circumstances. 
With respect to IRI, each call or call leg owns a separate IRI transaction sequence, independent of whether it is actually 
active or not. 
With respect to the CC links, two options (A, B) exist, which depend on laws and regulations, see below. Active call or 
call leg means in this context, that the target is actually in communication with the other party of that call or call leg; 

this definition differs from the definition in EN 300 403-1 [6]. 
  ETSI ETSI TS 101 671 V3.5
.1 (2009
-11)44 A.5.4.1 CC links for active and non-active calls (option A) 
For each call, active or not, separate CC lin
ks shall be provided. This guarantees, that: 
• changes in the call configuration of the target are reflected immediately, with no delay, at the LEMF; 
• the signal from held parties can still be intercepted. 
It is a network option, whether the communication direction of
 a non-active call, which still carries a signal from the 
other party, is switched through to the LEMF, or switched off. 
Target
Tother parties
P1  on hold

P2  on hold
P3  active
IIFLEMF
MFon hold
 Figure A.5.1: CC link option A (example for call hold supplementary service) 
A.5.4.2 Reuse of CC links for active calls (option B) 
CC links are only used for calls active in their communication phase. Changes in the call configuration may not be 
reflected at the LEMF immediately, because switching in the 
IIF/MF is required, and the signal from the held party is 
not available. 
Each time, another target call leg uses an existing CC link, an IRI-CONTINUE record with the correct CID and CCLID 
shall be sent. 
NOTE: Even when option B is used, more than one CC link may be required simultaneously. 
Target
Tother parties
P1  on hold
P2  on hold
P3  active
IIF
LEMF
MFon hold
 Figure A.5.2: CC link option B (example 
for call hold supplementary service) 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)45 A.5.5 Subscriber Controlled Input (SCI): 
Activation/Deactivation/Interrogation of services 
For user procedures for control of Suppl
ementary Services (Activation/Deactivation/Interrogation), a special IRI record 
type (IRI-REPORT record) is defined to transmit the required information. 
If the DSS1 Functional Protocol (EN 300 196-1 [29]) is used by the target, the functional information elements, usually 
ASN.1 encoded, are copied to the IRI-REPORT record as recei
ved by the target exchange. In case of analogue targets 
or use of the ISDN keypad protocol (EN 300 122-1 [39]) (digits or IA5-characters), other appropriate parameters 
identifying the services are used. They may consist of the string sent by the user, or system-specific parameters, which 

identify the service sufficiently. 
The IRI-REPORT record shall contain an indicator, whether th
e request of the target has been processed successfully or 
not. 
At the exchange, where the subscriber data of a target 
shall be modified via a remote control procedure, an 
IRI-REPORT record shall be generated as if
 the control procedure had taken place locally. 
A.6 Detailed procedures for circuit switched 
supplementary services 
A.6.1 Advice of Charge services (AOC) 
No impact. 
Advice of Charge information is not included in IRI records. 
A.6.2 Call Waiting (CW) 
A.6.2.1 Call Waiting (CW) at target: CC links 
In case of option A "CC links for all calls", a CC link is set up for the waiting call, using the standard procedures for 
terminating calls. In case of option B "CC links for active calls", no CC link is set up for the waiting call, it is treated 

like a held call. 
With respect to CC links, the same configurations as for Call Hold apply. 
Procedure, when the target accepts the waiting call: see retrieve of a held call (see clause A.6.3). 
A.6.2.2 Call Waiting: IRI records 
A.6.2.2.1 Target is served user 
If Call Waiting is invoked at the target access by another (calling) party: the IRI-BEGIN record or a following 
IRI-CONTINUE record for the waiting call shall contain the LI specific parameter 
call waiting indication
. A.6.2.2.2 Other party is served user 
If Call Waiting is invoked at the other (called) party's access: if a 
CW notification
 is received by the target's switching 
node, it shall be included in an IRI-CONTINUE record; it may be a separate record, or the next record of the basic call 

sequence. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)46 A.6.3 Call Hold/Retrieve 
A.6.3.1 CC links for active and non-active calls (option A) 
If an active call is put on hold, its CC links shall stay intact; 
as an option, the signal from the held party is not switched 
through to the LEMF. 
If the target sets up a new call, while one call is on hold, this call is treated like a normal originating call, i.e. a new LI
 configuration (CC links, IRI records) is established. 
A.6.3.2 Reuse of CC links for active calls (option B) 
If an active call is put on hold, its CC links shall not immediately be disconnected; as an option, the signal from the held 
party is not switched through to the LEMF. 
If the target sets up a new call, or retrieves a previously held call, while one target call, which still owns CC links, is on 
hold, these CC links shall be used for the signals of the new active call. 
A.6.3.3 IRI records 
A.6.3.3.1 Invocation of Call Hold or Retrieve by target 
An IRI-CONTINUE record with the LI specific parameter hold indication or retrieve indication, respectively, shall be 

sent. 
A.6.3.3.2 Invocation of Hold or Retrieve by other parties 
An IRI-CONTINUE record with a call hold 
or retrieve notification shall be sent if it has been received by the signalling 
protocol entity of the target call. 
A.6.4 Explicit Call Transfer (ECT) 
A.6.4.1 Explicit Call Transfer (ECT), CC link 
During the preparation phase of a transfer, the 
procedures for Call Hold/R
etrieve are applicable. 
If the served (transferring) user is the target, its original call is released. This terminates also the CC link, and causes an
 IRI-END record to be sent. 
After transfer, two options exist: 
1) For the transferred call, CC links (and IRI records) shall be generated, in principle like for a forwarded call 
(similar to procedures in clause A.6.16.1, case b). 
2) The transferred call shall not be intercepted. 
A.6.4.2 Explicit Call Tr
ansfer (ECT), IRI records 
In addition to the basic or hold/retrieve/waiting call related records and parameters, during the reconfiguration of the 
call, ECT-specific information at the target's access is
 sent to the LEMF within IRI-CONTINUE records. 
When the target leaves the call after transfer, an IRI-END re
cord is sent, and the LI transaction is terminated. Options 
for the new call, after transfer: see clause A.6.4.1. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)47 A.6.5 Calling Line Identification Pres
entation (CLIP) (IRI Records) 
A.6.5.1 Call originated by target
 (other party is served user) 
The standard CLI parameter of an originating target is included as a supplementary service parameter in the IRI records. 
If for the access (BRI or PRI) of the target a special arra
ngement according to EN 300 089 [54] exists, whereby the user 
provides a user provided, not screened number, this number 
is included in the IRI-BEGIN record (originating-Party 
information), as a generic number parameter. The network provided default number of the access is, as without this 
arrangement, also included in the IRI record.  
A.6.5.2 Call terminated at target (target is served user) 
The CLI sent from the other party is included in the IRI-BEGIN record (
originating-Party
 information), irrespective of 
a restriction indication. An eventually received second numbe
r (case two number delivery option) is included in the IRI 
record as supplementary services information (Generic Number parameter). 
A.6.6 Calling Line Identification Restriction (CLIR) 
For use by LI, the restriction is ignored, but copied within the CLI parameter to the IRI record. 
A.6.7 COnnected Line identific
ation Presentation (COLP) 
A.6.7.1 Call terminated at target
 (other party is served user) 
A connected number parameter received from the target sh
all be included in an IRI record (terminating-Party 
information). In cases where a special arrangement applies, 
the user provided and the network provided default number 
of the access is included in the IRI record. 
A.6.7.2 Call originated by target (target is served user) 
If available, a connected number paramete
r as received from the other (terminating) party shall be included in an IRI 
record (terminating-Party information). Any additional number, e.g. a Generic Number, shall also be included in the IRI 

record. 
A.6.8 COnnected Line identific
ation Restriction (COLR) 
For use by LI, the restriction is ignored, but copied within the COL parameter to the IRI record. 
A.6.9 Closed User Group (CUG) 
In case of a CUG call, the Closed User Group interlock code shall be included in an IRI. 
A.6.10 Completion of Call to Busy Subscriber (CCBS) 
No impact. 
The first call, which meets a (terminating) busy subscriber, an
d is released subsequently, is treated like a standard busy 
call, with no CCBS related IRI information. 
The procedures for CCBS, until starting a new call attempt from
 the served user to the terminating user, including the 
CCBS recall, are not subject of LI. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)48 A.6.11 CONFerence call, add-on (CONF) 
A.6.11.1 CONFerence calls, add on: CC links 
The CC links carry the same bit stream as sent to/received from the target, that is, the R
x call contains the sum signal of 
the conference, and the T
x call contains the signal from the target. 
The general rules for multi party calls (see clause A.5.4) apply also for the various possible states during a conference 
(isolate, split, etc.). The call to the conference device as such is treated like a standard call. In case of a n-party 

conference, there exist n + 1 CC links in case of option "CC 
link for all calls", or just one CC link, in case of option 
"CC link for active calls". 
A.6.11.2 Conference calls: IRI records 
In addition to the basic or hold/retrieve/waiting call related records and parameters, during the set up and eventual 

reconfigurations of a conference, CONF-specific info
rmation is sent to the LEMF within IRI records. 
A.6.12 Three party service (3PTY) (conference) 
A.6.12.1 CC links 
a) Target is conference controller: 
The 3PTY conference originates from a configuration with two single calls (one active, one held). When 

joining the calls to a conference, the CC links, which have
 carried the signals of the active target call are used 
to transmit the conference signals; that is, the R
x call contains the sum signal of the conference, the T
x call contains the signal from the target. 
 The second CC link set, for the previously held call stays intact. If the conference is released, and the initial 
state (1 held, 1 active call) is re-established, the required CC links are still available. 
b) Target is passive party of conference: 
No impact on CC links. 
A.6.12.2 Three party service, IRI records 
For the events indicating the start and the end of the 3PTY conference, IRI records are generated. 
A.6.13 Meet-Me Conference (MMC) 
No impact; calls to a MMC are treated 
as standard calls; the MMC device is not required to be subject of LI. 
A.6.14 Direct Dialling In (DDI) 
LI may be applied to a PABX access DN or to a DDI exte
nsion number according to national laws and requirements. 
A.6.15 Multiple Subscriber Number (MSN) 
LI shall be activated individually per MSN. 
If LI has to be activated for a whole ISDN BA, activation commands shall be input by the LI administrator for each 
number; administrative procedure shall ensure, that all numbers are covered. If during a surveillance a MSN is added or 

removed, a LI administrative message shall be generated, see clause 7.2. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)49 A.6.16 DIVersion services (DIV) 
Calls to a target, with a called party number equal to the intercepted target DN(s), but forwarded, are intercepted, 
i.e. CC links are set up, and IRI records are sent to 
the LEA. This applies for all kinds of call forwarding. 
For calls forwarded by the other party (calling or called), the available diversion-related information is sent to the LEA. 
A.6.16.1 Call Diversion by target 
A.6.16.1.1 Call Diversion by target, CC links 
In order to handle call diversion services by applying, as far as possible, common procedures, the following two cases 
are differentiated: 
a) Call Forwarding Unconditional (CFU), Call Forwarding Busy (NDUB): 
In these cases, forwarding is determined, before seizing the target access. CC links are set up, immediately, for 

the forwarded call. 
 Other variants of Call Forwarding (CF) with immediate forwarding, i.e. without first seizing the target access, 
are handled in the same way (e.g. unconditional Selective Call Forwarding). 
b) Call Forwarding No Reply, Call Forwarding Busy (UDUB), Call Deflection, Partial Rerouting: 
Initially, the target call is set up, and the call is intercepted like a basic call. 
 When forwarding takes place (e.g. after expiry of the CFNR timer), the original call is released; this may cause 
also a release of the CC links. In such case two optional IRI record handling may apply: 
1) For the original call an IRI-END record is sent. Fo
r the forwarded call a new set up procedure, including 
new LI transaction may take place with new set of IR
I records (starting with IRI-BEGIN record sent to 
the LEA). 
2) For the forwarded call the IRI-CONTINUE record is generated and sent to a LEA, indicating the CFNR 
invocation. 
Other variants of Call Forwarding (CF) with forwarding after first seizing the target access, are handled in the same 
way. 
In case of multiple forwarding, one call may be intercepted several times, if several parties are targets. Considering the 
maximum number of diversions for one call of 5 (ITU recommended limit), one call can be intercepted 7 times, from 

the same or different LEAs. In principle, these procedures are independent of each other. 
A.6.16.1.2 Call Diversion by target, IRI records 
See clause A.3.2.3, case 2, related to the target's informati
on, and case 3, related to the forwarded-to-party information. 
As above for the CC links, the diversion types a) and b1, 2) are differentiated:  
• for case a) and b2) diversions, the IRI is part of one transaction, IRI-BEGIN, -CONTINUE, -END;  
• for case b1) diversions, a first transaction informs about the call section, until diversion is invoked 
(corresponding to a basic, prematurely released call), a 
second transaction informs about the call section, when 
diversion is invoked (corresponding to case a)). 
A.6.16.2 Forwarded call terminated at target 
The CC link is handled in the standard way. The IRI-BEGIN record contains the available call diversion information, 

see clause A.3.2.3, case 1. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)50 A.6.16.3 Call from target forwarded 
The CC link is handled in the standard way. The IRI-
BEGIN and possibly IRI-CONTINUE records contain the 
available call diversion related information, see clause A.3.2.3, case 3. 
A.6.17 Variants of call diversion services 
Variants of the above "standard" diversion services are 
treated in the same way as the corresponding "standard" 
diversion service. 
A.6.18 Void 
A.6.19 Malicious Call IDentification (MCID) 
CC links: no impact. 
IRI records: If a terminating target or other party invokes MCID, the MCID response indicator parameter shall be 
included in a dedicated or the next regular IRI record. 
A.6.20 SUBaddressing (SUB) 
The different types of subaddress information elements are part of the IRI records, in all basic and supplementary 

services cases, where they are present. 
A.6.21 Terminal Portability (TP) 
A.6.21.1 CC links 
No impact. 
A.6.21.2 IRI records 
A.6.21.2.1 Invocation of Terminal Portability by target 
Sending of the LI parameters suspend indication or resume indication in an IRI-CONTINUE record. 
A.6.21.2.2 Invocation of Terminal Portability by other parties 
Sending of the generic notification indicator, values user 
suspended or user resumed in an IRI-CONTINUE record. 
A.6.22 User-to-User Signalling (UUS) 
User-to-User parameters of services UUS1, UUS2 and UUS3 shall be reported as HI3, see clause A.4, or via HI2, 
see clause A.5. 
If User-User information is not delivered from a target to the other party (e.g. due to overload in the SS No.7 network), 
no notification is sent to the LEA. 
A.6.23 Abbreviated Address (AA) 
No impact. The service access code and abbreviated numb
er (user input) is not included in IRI records. 
  ETSI ETSI TS 101
 671 V3.5.1 (2009
-11)51 A.6.24 Fixed Destination Call (FDC) 
No impact. The service access code (if appli
cable) is not included in IRI records. 
A.6.25 Alarm Call (AC)/Wake-Up Service (WUS) 
No impact. A Wake-up call is intercepted in the standard way; the identity of the originating party may be missing. 
A.6.26 Incoming Call Barring (ICB) 
No impact. 
a) Case terminating call to a target with ICB active: 
In general, the barring condition of a target is detected before the target access is determined, consequently, an 
IRI-REPORT records is generated.  
If the access would be determined, a standard IRI-END record is generated, with the applicable cause value. 
b) Case target calls a party with ICB active: 
In general, an IRI-BEGIN record has been sent already, and CC links have been set up. Consequently, a 
standard IRI-END record is generated,
 with the applicable cause value. 
A.6.27 Outgoing Call Barring (OCB) 
No impact. 
For a barred call, a standard record may be generated; its ty
pe and content are depending on the point in the call, where 
the call was released due to OCB restrictions. 
A.6.28 Completion of Calls on No Reply (CCNR) 
No impact. See remarks to service CCBS. 
A.6.29 Reverse charging 
No impact. 
A.6.30 Line hunting 
All accesses of the group shall get the interception profile, independently of each other, if the whole group has to be 

intercepted (responsibility of the LI operator). 
A.6.31 Message Wait Indication (MWI) 
No impact. The information, that a message is waiting, is not sent to the LEA. 
A.6.32 Name display 
No impact. Name strings are not included in IRI records. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)52 A.6.33 Tones, announcements 
No impact. 
If the normal procedures, depending on the call state, re
sult in sending the tone or announcement signal on the R
x CC 
link channel, this shall be transmitted as CC. 
A.7 Void  A.8 GSM circuit switched technology annex 
A.8.1 Functional architecture 
The following picture contains the reference configuration for the lawful interception (see 3GPP TS 03.33 [42]). 
There is one ADMinistration Function (ADMF) in the network. Together with the delivery functions it is used to hide 
from the MSC/VLR and GMSC that there might be multiple activations by different Law Enforcement Agencies 

(LEAs) on the same target. 
LEA
MSC/
VLR
GMSC
ADMFCC MF
IRI MF
DF3
DF2
NWO/AP/SvP™s
administration
centre
X1 interface
X2 interface
X3 interface
HI1
HI2
HI3
IIF Figure A.8.1: Reference configuration for GSM circuit switched 
The reference configuration is only a logical representation of the entities involved in lawful interception and does not 
mandate separate physical entities. This allows for higher levels of integration. 
A call could be intercepted based on several identities (MSISDN, IMSI, IMEI) of the same target. 

Interception based on IMEI could lead to a delay in start of
 interception at the beginning 
of a call and interception of 
non-call related events is not possible. 
For the delivery of the CC and IRI the MSC/VLR or GMSC prov
ides correlation number and 
target identity to the DF2 
and DF3 which is used there in order to select the di
fferent LEAs where the product shall be delivered to. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)53 A.8.2 Correlation of CC and IRI (see clause 6) 
Correlation of the present document IDs to 3GPP TS 03.33 [43] IDs. 
The ID Lawful Interception Identifier (LIID) out of the present document is supported at the IIF (GSM) with warrant 
reference number. 
Parameters out of the present document, see clause 6.2: 
• Communication IDentifier (CID). 
For each call or other activity relating to 
a target identity a CID is generated by the relevant network element. The CID 
consists of the following two identifiers: 
- Network IDentifier (NID); 
- Communication Identity Number (CIN). 
Intercepting Node ID is used for the NID in the GSM system. 

The correlation number is used for the CIN.
 For the Communication IDentifier (CID) in the GSM system 
we use the combination of Interception Node ID and the 
correlation number. 
A.8.3 HI3 (delivery of CC) 
CC will be delivered as described in clause A.4. 
Exceptionally, SMS will be delivered via HI2. 
Correlation information in HI3 will be delivered as described in clause D.8 and as an option annex E. 
A.8.4 HI2 (delivery of IRI) 
The events defined in 3GPP TS 03.33 [42] are used to generate records for the delivery via HI2. 

There are eight different events type received at DF2 level. Acco
rding to each event, a record is
 sent to the LEMF if this 
is required. Table A.8.1 gives the mapping between event type 
received at DF2 level and record type sent to the LEMF. 
It is an implementation option if the redundant information will be sent for each further event. 
Table A.8.1: Structure of the records for GSM (CS) 
Event
 IRI record type
 Call establishment BEGIN 
Answer CONTINUE 
Supplementary service CONTINUE 
Handover CONTINUE 
Release END 
Location update REPORT 
Subscriber controlled input REPORT 
SMS REPORT 
 A set of information is used to generate the records. The records used transmit the information from mediation function 
to LEMF. This set of information can be extended in MSC/VL
R or GMSC or DF2/MF, if this is necessary in a specific 
country. Table A.8.2 gives the mapping between information 
received per event and information sent in records. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)54 IRI-related information, such as receiving MSISDN, which is
 included as header information in the SMS message body 
that is sent to the SMS service centre, is to be included in IRI records. 
NOTE: In some jurisdictions an authorization for interception of IRI only means that SMS message body is not 
included in what the LEA is allowed to receive. In such cases it is essential that the relevant party 

information is included in IRI record
s, even if such information for technical reasons is included in what 
the intercepting network element sees as "contents". 
Table A.8.2: Description of parameters 
Parameter Definition ASN.1 parameter
 observed MSISDN 
Target Identifier with the MSISDN of the target 
subscriber (monitored subscriber) 
PartyInformation/msISDN 
observed IMSI 
Target Identifier with the IMSI of the target 
subscriber (monitored subscriber) 
PartyInformation/imsi 
observed IMEI 
Target Identifier with the IMEI of the target 
subscriber (monitored subscriber), it must be 
checked for each call over the radio interface 
PartyInformation/imei 
event type 
Description which type of event is delivered: 
Establishment, Answer, Supplementary service, 

Handover, Release, SMS, Location update, 
Subscriber controlled input 
There is no one-to-one mapping for this 
information. Parameters presence on HI2 

indicates the event type (e.g. sMS or sciData 
parameter presence) 
event date 
Date of the event generation in the MSC/VLR or 
GMSC 
TimeStamp 
event time 
Time of the event generation in the MSC/VLR 
or GMSC 
dialled number 
Dialled number before digit modification, 
IN-modification, etc. 
PartyInformation (= originating)/DSS1-
parameters/calledpartynumber 
connected number Number of the answering party PartyInformation/supplementary-Services-Info 
other party address 
Directory number of the other party for 
originating calls 
Calling party for terminating calls 
PartyInformation  
(= terminating)/calledpartynumber 
PartyInformation/callingpartynumber 
call direction 
Information if the monitored subscriber is calling 
or called e.g. MOC/MTC or 
originating/terminating in or/out 
intercepted-Call-Direct 
CID Unique number for each call sent to the DF, to 
help the LEA, to have a correlation between 
each call and the IRI (combination of 

Interception Node ID and the correlation 

number) 
communicationIdentifier 
lawful interception 
identifier 
Unique number for each surveillance lawful 
authorization 
LawfulInterceptionIdentifier 
cell id 
Cell number of the target; for the location 
information 
locationOfTheTarget 
location area code 
Location-area-code of the target defines the 
Location Area in a PLMN 
basic service Information about Tele service or bearer service
 PartyInformation/DSS1-parameters-codeset-0 
supplementary 

service 
Supplementary services used by the target 
e.g. CF, CW, ECT 
PartyInformation/Supplementary-Services 
forwarded to number Forwarded to number at CF 
PartyInformation/calledPartyNumber 
(party-Qualifier indicating forwarded-to-party) 
call release reason Call release reason of the target call Release-Reason-Of-intercepted-Call 
SMS 
The SMS content with header which is sent with 
the SMS-service 
SMS 
SCI Non-call related Subscriber Controlled Input 
(SCI) which the MSC/VLR receives from the ME
 PartyInformation/sciData 
NOTE: LIID parameter must be present in each record sent to the LEMF. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)55 A.9 TETRA technology annex 
TETRA details are fixed via two options: 
• Clause A.9.1 according EN 301 040 [72]. 
• Clause A.9.2 based on EN 301 040 [72] adapted to common handover interface. 
A.9.1 According EN 301 040 
Clause A.4 applies to TETRA. 
TETRA intercepted data is defined in EN 301 040 [72] and in the ASN.1 module identified below: 
EN301040 {itu-t(0) identified-organization(4) etsi(0) en301040(1040) interceptVersion(0)}  A.9.2 based on EN 301 040 adapted to common handover 
interface A.9.2.1 HI 2 event definitions 
Based on the requirements of clause 8.2, "Types of IRI records", following events for TETRA exist. 
Table A.9.1: List of IRI records generated 
Event IRI record name
 IRI record type
 Start of call, A party is target 
CallSetupMobileOriginating 
BEGIN Start of call, B party is target 
CallSetupMobileTerminating 
BEGIN Call reaches other party 
Ringing 
CONTINUE 
Call waiting at other party 
Queueing 
CONTINUE 
Call established 
Connected 
CONTINUE 
Location change during call 
Handover 
CONTINUE 
Call is released 
CallRelease 
END TETRA switch change while not in call 
LocationUpdate 
REPORT 
Target sends SDS 
SDSMobileOriginating 
REPORT 
Target receives SDS 
SDSMobileTerminating 
REPORT 
Call forwarded to C party 
CallForward 
CONTINUE 
Call on hold 
CallHold 
CONTINUE 
Group indication action 
GroupIndication 
REPORT 
Group talker tx granted 
TxGranted 
CONTINUE 
Handset switched on 
MobileOn 
REPORT 
Handset switched off 
MobileOff 
REPORT 
Direct Mode Operation 
DMO 
REPORT 
 A.9.2.1 IRI event definitions 
This clause shows the detailed definitions of event / record and parameters provided with them.  
nature-Of-The-intercepted-call shall be tETRA-circuit-call.  Notes related to specific information fields will be given on their first appearance but continue to be valid for the value 
in all records. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)56 A.9.2.1.1 BEGIN event information 
The BEGIN record is used to convey the first event of TETRA interworking communication interception. 
The BEGIN record shall be triggered when: 
• Call Setup Mobile Originating 
 Start of call, A party is target.
 • Call Setup Mobile Terminating 
 Start of call, B party is target.
 A.9.2.1.1.1 Call Setup Mobile Originating  
Table A.9.2: Data fields for Ca
llSetupMobileOriginating record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Begin-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID (see note 1) 
communicationIdentifier M TETRA location (see note 2) 
locationOfTheTarget C HI3 Line ID (see note 3) 
tARGETCOMMSMONITORind: targetcommsid:CircuitIdType M Target ID 
tETRA-PartyInformation M Other Party ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call type 
callDirection M Transaction type 
callTransactionType M Service type 
basicService:teleServiceCode M Call State 
intercepted-Call-State M NOTE 1: This value is used to correlate all IRI belonging to one call. The value shall be the same for all records 
related to a call from BEGIN to END and shall be unique for a LIID over a longer period (at least several 

days). 
NOTE 2: Alternatively the TS 101 671 defined value 
tetraLocation can be used. 
NOTE 3: This value is used for correlation of IRI and CC. 
 A.9.2.1.1.2 Call Setup Mobile Terminating  
Table A.9.3: Data fields for CallSetupMobileTerminating record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Begin-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location 
locationOfTheTarget C HI3 Line ID 
tARGETCOMMSMONITORind: targetcommsid:CircuitIdType M Target ID 
tETRA-PartyInformation M Other Party ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call type 
callDirection M Transaction type 
callTransactionType M Service type 
basicService:teleServiceCode M Call State 
intercepted-Call-State  M    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)57 A.9.2.1.2 CONTINUE event information 
The CONTINUE record is used to convey the additional information's within an ongoing communication of TETRA 
interworking communication interception. 
The CONTINUE record shall be triggered when 
• Ringing 
 Call reaches other party. 
• Queueing 
 Call waiting at other party. 
• Connected 
 Call established. 
• Handover 
 Location change during call. 
• Call Forward 
 Call forwarded to C party. 
• Call Hold 
 Call on hold. 
• TxGranted 
 Group talker tx granted. 
A.9.2.1.2.1 Ringing  
Table A.9.4: Data fields for Ringing record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Continue-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Other Party ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call State 
intercepted-Call-State  M  A.9.2.1.2.2 Queueing 
Table A.9.5: Data fields for Queuing record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Continue-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Other Party ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call State 
intercepted-Call-State  M    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)58 A.9.2.1.2.3 Connected 
Table A.9.6: Data fields for Connected record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Continue-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Other Party ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call State 
intercepted-Call-State  M  A.9.2.1.2.4 Handover 
Table A.9.7: Data fields for Handover record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Continue-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location (new) 
locationOfTheTarget C HI3 Line ID 
tARGETCOMMSMONITORind: targetcommsid:CircuitIdType M Target ID 
tETRA-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M  A.9.2.1.2.5 Call Forwarding 
Table A.9.8: Data fields for CallForwardRecord 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Continue-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location 
locationOfTheTarget C HI3 Line ID 
tARGETCOMMSMONITORind: targetcommsid:CircuitIdType M Target ID 
tETRA-PartyInformation M Other Party ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call type 
callDirection M Transaction type 
callTransactionType M Service type 
basicService:teleServiceCode M Supplementary Service type 
(see note) 
supplementaryService M Forwarded-to ID 
forwardedToNumber M NOTE: Possible values: 
cfb, cw, etc. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)59 A.9.2.1.2.6 Call Hold 
Table A.9.9: Data fields for CallHold record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Continue-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Other Party ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call type 
callDirection M Transaction type 
callTransactionType M Service type 
basicService:teleServiceCode M Supplementary Service type 
supplementaryService M Status of the call (see note) 
callRetrieve M NOTE: FALSE when call is put on hold, TRUE when call is retrieved from hold 
 A.9.2.1.2.7 TxGranted 
This IRI record provides information about the talker status in groups. 
Table A.9.10: Data Fields for TxGranted record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Continue-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location 
TETRACGIType C Target ID 
tETRA-PartyInformation M Group ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call type 
callDirection M Transaction type 
callTransactionType M Service type 
basicService:teleServiceCode M Status (see note) 
txGrantedStatus M NOTE: 
FALSE TxCeased, 
TRUE TxGranted 
 A.9.2.1.3 END event information 
The END record is used to convey the additional information's within an ending communication of TETRA 
interworking communication interception. 
The END record shall be triggered when: 
• Call Release 
 Call is released. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)60 A.9.2.1.3.1 Call Release 
Table A.9.11: Data fields for CallRelease record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-End-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID (see note 1) 
communicationIdentifier M TETRA location 
locationOfTheTarget C HI3 Line ID (see note 2) 
tARGETCOMMSMONITORind: targetcommsid:CircuitIdType M Target ID 
tETRA-PartyInformation M Other Party ID 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call information 
nature-Of-The-intercepted-call M Call type  
callDirection M Transaction type 
callTransactionType M Service type 
basicService:teleServiceCode M Reason for release 
callReleaseReason M Call State 
intercepted-Call-State M NOTE 1: 
incoming / outgoing depending on call type. 
NOTE 2: 
moc / mtc depending on call type. 
 A.9.2.1.4 REPORT event information 
The REPORT record is used to convey the additional information's outside a communication of TETRA interworking 
communication interception. 
The REPORT record shall be triggered when: 
• LocationUpdate 
 TETRA switch change while not in call. 
• SDS Mobile Originating 
 Target sends SDS. 
• SDS Mobile Terminating 
 Target receives SDS. 
• Group Indication 
 Group indication action. 
• Mobile On 
 Handset switched on. 
• Mobile Off 
 Handset switched off. 
• DMO  Direct Mode Operation. 
A.9.2.1.4.1 Location Update 
Table A.9.12: Data fields for LocationUpdate record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Report-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M TETRA location (new) 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)61 A.9.2.1.4.2 SDS Mobile Originating 
Table A.9.13: Data fields for SDSMobileOriginating record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Report-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call type 
callDirection M Transaction type 
callTransactionType M Content of SDS 
forwardSM-Arg (see note) M NOTE: contains address of called ID (
sM-RP-DA), again address of originator (
sM-RP-OA) and 
SDS value (
signalInfo). 
 A.9.2.1.4.3 SDS Mobile Terminating 
Table A.9.14: Data fields for SDSMobileTerminating record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Report-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Call type 
callDirection M Transaction type 
callTransactionType M Content of SDS 
forwardSM-Arg (see note) M NOTE: contains again address of called ID (
sM-RP-DA), address of originator (
sM-RP-OA) and 
SDS value (
signalInfo). 
 A.9.2.1.4.4 Group Indication 
Information about the groups the observed subscriber has joined. One record will be sent for every such group. 
Table A.9.15: Data fields for GroupIndication record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Report-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M Call ID 
communicationIdentifier M TETRA location 
locationOfTheTarget C Target ID (see note 1) 
tETRA-PartyInformation M Other Party ID (see note 1) 
tETRA-Other-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M Group status (see note 2) 
groupStatus M NOTE 1: If observation of individual subscriber, Target ID is ITSI, Other Party ID is GTSI. 
 If group observation, Target ID is GTSI, Other Party ID is ITSI. 

NOTE 2: 
FALSE when leaving group, 
TRUE
 when joining group. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)62 A.9.2.1.4.5 Mobile On 
The observed subscriber's handset has been turned on. 
Table A.9.16: Data fields for MobileOn record 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Report-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M  A.9.2.1.4.6 Mobile Off 
The observed subscriber's handset has been turned off. 
Table A.9.17: Data fields for MobileOff record 
Information ASN.1 field used
 MOC
 IRI record type 
iRI-Report-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M  A.9.2.1.4.7 DMO 
The indication of Direct Mode Operations informs LEA that the observed party has entered into radio communications 
which cannot be observed by the TETRA switch. 
Table A.9.18: Data fields for Direct Mode Operations 
Information
 ASN.1 field used
 MOC
 IRI record type 
iRI-Report-record M IRI record name 
tETRA-LI-Event M LIID lawfulInterceptionIdentifier M TETRA location 
locationOfTheTarget C Target ID 
tETRA-PartyInformation M Event time 
timeStamp M Network Identification 
networkIdentifier M DirectModeOperations 
dMO-Indicator M    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)63 A.10 NGN PSTN/ISDN emulation and simulation services 
technology annex 
This clause applies for PSTN/ISDN emulation services and for PSTN/ISDN simulation services which interwork with 
the Circuit Switched telephony network. 
Target identity consists in the target's E.164 Directory Number, TEL_URL and/or SIP_URI. 
A.10.1 Functional architecture 
Figure A.10.1 contains a high level functional architecture. TS 187 005 [i.3] provides an example of a model for NGN 
PSTN/ISDN emulation and NGN PSTN/ISDN simulation services which could provide a suitable example of "source 
of emulated/simulated PSTN/ISDN". 
                                    Network 
Mediation 
Functionality (MF)
   Law Enforcement 
Monitoring 
Facility (LEMF)
  Handover 
interface
  Source of 
emulated or 
simulated 
PSTN/ISDN
   Figure A.10.1: High level functional architecture 
for PSTN/ISDN emulation and simulation services 
A.10.2 Correlation 
Clause A.1 applies. 
Correlation for IRI and CC delivery is the same as for PSTN/ISDN, meaning via LIID, CID and CCLID used in the 
same way. 
A.10.3 HI2 
IRIs are elaborated and delivered as described in clause A.3. 
A.10.4 HI3 
CC will be delivered as described in clause A.4. 
Correlation information in HI3 will be delivered as described in clause D.8 and as an option in annex E. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)64 Annex B (normative): 
Packet switched network handover 
B.1 Specific identifiers for LI 
Beyond clause 6, at present the Correlation Number as specifi
c LI identifier for packet switched networks is defined. 
The Correlation Number is unique per PDP context and is used for the following purposes: 
• correlate CC with IRI; 
• correlate different IRI records within one PDP context. 
As an example, in the GSM GPRS system, the Correlation Number may be the combination of GGSN address and 
charging ID.
 B.2 HI1: interface port 
for administrative state 
There are no additions beyond clause 7. 
B.3 HI2: interface port for IRI 
B.3.1 Definition of Interception Related Information for packet 
switched 
Intercept related information will in principle be available in the following phases of a data transmission: 
1) At connection attempt when the target identity becomes 
active, at which time packet transmission may or may 
not occur (set up of a data context, target 
may be the originating or terminating party). 
2) At the end of a connection, when the target identity becomes inactive (removal of a data context). 

3) At certain times when relevant information are available. 
In addition, information on non-transmission related actions of a target constitute IRI and is sent via HI2, 
e.g. information on Subscriber Controlled Input (SCI). 
The Intercept Related Information (IRI) may be subdivided into the following categories: 
4) Control information for HI2 (e.g. correlation information). 
5) Basic data context information, for standard data transmission between two parties. 
B.3.2 Exception handling 
Exception handling is a national matter. 
B.3.3 Security aspects 
For security aspects see clause 11. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)65 B.4 HI3: interface port fo
r Content of Communication 
(CC) 
Details on the HI3 interface port are described in clause 9.
 B.5 GPRS technology annex 
B.5.1 Functional architecture 
Figure B.5.1 contains the reference configuration for the lawful interception (see 3GPP TS 03.33 [42]). 
There is one ADMinistration Function (ADMF) in the network. Together with the delivery functions it is used to hide 
from the xGSN that there might be multiple activations by different Law Enforcement Agencies (LEAs) on the same 
target identity. 
LEASGSN
GGSN
ADMF
CC MF
IRI MF
DF3P
DF2P
NWO/AP/SvP™s
administration
centre
X1-1P

interface
X2P interface
X3P interface
HI1
HI2
HI3
IIF
X1-3P
interface
X1-2P
interface
 NOTE: GGSN interception is a national option. 
 Figure B.5.1: Reference configuration 
The reference configuration is only a logical representation of the entities involved in lawful interception and does not 
mandate separate physical entities. This allows for higher levels of integration. 
A communication could be intercepted based on several identities (MSISDN, IMSI, IMEI) of the same target. 
For the delivery of the CC and IRI the xGSN provides a correlation number and target identity to the DF2P and DF3P 
which is used there to select the different 
LEAs where the CC/IRI shall be delivered to. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)66 B.5.2 Correlation 
B.5.2.1 Correlation of the present document IDs to GSM IDs 
The ID Lawful Interception IDentifier (LIID) out of the present document is supported at the IIF (GSM) with warrant 
reference number. 
Parameters from the present document, see clause 6.2. 
• Communication IDentifier (CID). 
For each communication or other activity relating to a target identity a CID is generated by the relevant network 
element. The CID consists of the following two identifiers: 
- Network IDentifier (NID); 

- Communication Identity Number (CIN). 
NOTE: If interception has been activated for both parties of the packet data communication both CC and IRI will 
be delivered for each party as separate intercept activity. 
B.5.2.2 GPRS LI correlation between CC and IRI 
For the delivery of CC and IRI, the SGSN or GGSN provides correlation numbers and target identities to the HI2 and 

HI3. The correlation number is unique per PDP context and is 
used to correlate CC with IRI and the different IRIs of 
one PDP context. 
B.5.3 HI2 (delivery of IRI) 
The events defined in 3GPP TS 03.03 [42] are used to generate records for the delivery via HI2. 
There are nine different event types received at DF2 level. Acco
rding to each event, a record is
 sent to the LEMF if this 
is required. Table B.5.1 gives the mapping between event type 
received at DF2 level and record type sent to the LEMF. 
Table B.5.1: Mapping between GPRS Events and HI2 records type
 Event
 IRI record type
 GPRS attach REPORT 
GPRS detach REPORT 
PDP context activation (successful) BEGIN 
PDP context activation (unsuccessful) REPORT 
Start of intercept with PDP context active 
BEGIN or optionally  
CONTINUE 
PDP context modification CONTINUE 
PDP context deactivation END 
Cell and/or RA update REPORT  
SMS REPORT 
 For some packet oriented data services such as GPRS, 
the first event of a communication attempt shall be the PDP 
context activation or a similar event and an IRI-BEGIN reco
rd shall be issued. The end of the communication attempt 
shall be the PDP context deactivation or a similar event and 
an IRI-END record shall be issued. While a PDP context is 
active, IRI-CONTINUE records shall be used for CC relevant IRI data records, IRI-REPORT records otherwise. 
For some packet oriented data services such as GPRS, if
 LI is being activated during an already established PDP 
context or similar, an IRI-BEGIN record will mark the start of the interception. If LI is being deactivated during an 

established PDP context or similar, no IRI-END record will be transmitted. The end of interception can be 
communicated to the LEA by other means (HI1). 
A set of information is used to generate the records. The records used transmit the information from mediation function 
to LEMF. This set of information can be extended in xGSN or DF2P/MF, if this is necessary in a specific country. 

Table B.5.2 gives the mapping between information received per event and information sent in records. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)67 Table B.5.2: Mapping between events
 information and IRI information 
Parameter Description
 HI2 ASN.1 parameter
 observed MSISDN 
Target Identifier with the MSISDN of the target 
subscriber (monitored subscriber) 
PartyInformation/msISDN 
observed IMSI 
Target Identifier with the IMSI of the target subscriber 
(monitored subscriber) 
PartyInformation/imsi 
observed IMEI  
Target Identifier with the IMEI of the target subscriber 
(monitored subscriber) 
PartyInformation/imei 
observed PDP address PDP address used by the target 
PartyInformation/pDP-address-
allocated-to-the-target 
event type 
Description which type of event is delivered: PDP 
Context Activation, PDP Context Deactivation, GPRS 
Attach, etc. 
gPRSevent 
event date Date of the event generation in the xGSN 
TimeStamp 
event time Time of the event generation in the xGSN 
Access point name 
The access point name contains a logical name (see 
3GPP TS 23.060 [77]) 
PartyInformation/aPN 
PDP type 
This field describes the PDP type as defined in 
3GPP TS 09.60 [45], 3GPP TS 04.08 [55], 

TS GSM 09.02 [32] 
PartyInformation/pDP-type 
Correlation number 
Unique number for each PDP context delivered to the 
LEMF, to help the LEA, to have a correlation between 

each PDP Context and the IRI 
gPRSCorrelationNumber 
lawful interception identifier
 Unique number for each lawful authorization LawfulInterceptionIdentifier 
CGI (Cell Global ID) Cell number of the target; for the location information locationOfTheTarget/globalCellId 
routing area identifier 
Routing-area-identifier of the target defines the 
Routing Area in a GPRS-PLMN 
locationOfTheTarget/rAI 
SMS 
The SMS content with header which is sent with the 
SMS-service 
SMS 
failed context activation 
reason 
This field gives information about the reason(s) for 
failed context(s) activation of the target subscriber 
gPRSOperationErrorCode 
failed attach reason 
This field gives information about the reason(s) for 
failed attach attempts of the target subscriber 
gPRSOperationErrorCode 
NOTE: LIID parameter must be present in each record sent to the LEMF. 
 B.5.4 HI3 (Delivery of CC) 
For a GPRS HI3 interface port for Content of Communication (CC) see annex F. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)68 Annex C (normative): 
HI2 Delivery mechanisms and procedures 
There are two possible methods for delivery of IRI to the LEMF: 
a) ROSE (see clause C.1); 

b) FTP (see clause C.2). 
According to national requirements at least one of these methods shall be provided. 
C.1 ROSE C.1.1 Architecture 
LI_Application
ASE_HI :
Application Service Elementfor
the HandoverInterface
Session

Transport

Network

Data

Physical
 Figure C.1.1: Architecture 
The ASE_HI manages the data link, the coding/decoding of the ROSE operations and the sending/receiving of the 
ROSE operations. 
C.1.2 ASE_HI procedures 
C.1.2.1 Sending part 
To request the sending of data to a peer entity, the LI_Application provides the ASE_HI, the address of the peer entity, 

the nature of the data and the data. 
On receiving a request of the LI_Application: 
• If the data link toward the peer entity address is active, the ASE_HI, from the nature of the data provided, 
encapsulates this data in the relevant RO-Invoke operation. 
• If the data link toward the peer entity address is not active, the ASE_HI reports the data link unavailability to 
LI_Application. 
NOTE: Until the data link is established by the LI_Application according to clause C.1.2.3.1, the request of the 
LI_Application cannot be successfully processed by ASE_HI. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)69 Depending on the natures of the data provided by the LI_Application, the ASE_HI encapsulates this data within the 
relevant ROSE operation: 
• LI management notification: in this case the data prov
ided by the application are encoded within the class 2 
RO-Invoke operation "sending-of-HI1-Notification". The ASN.1 format is described in clauses D.2 and D.4 

(HI1 interface). 
• IRI: in this case the data provided by the application are encoded within the class 2 RO-Invoke operation 
"sending-of-IRI". The ASN.1 format is descri
bed in clauses D.2 and D.5 (HI2 interface). 
• SMS: in this case the data provided by the application are encoded within the class 2 RO-Invoke operation 
"sending-of-IRI". The ASN.1 format is descri
bed in clauses D.2 and D.5 (HI2 interface). 
• User packet data transfer (used for data which can be exchanged via ISUP/DSS1/MAP signalling: e.g. UUS): 
in this case the data provided 
by the application are encoded: 
- either within the class 2 RO-Invoke operation "circuit-Ca
ll-related-Services" in case of data associated to 
a circuit call (for e.g. UUS1, UUS2, UUS3). The ASN.1 format is described in clauses D.2 and D.6 

(HI3 interface); 
- or within the class 2 RO-Invoke operation "no-Circuit-Call-related-Services" in case of data not 
associated with a circuit call (for e.g. SMS). The 
ASN.1 format is described in clauses D.2 and D.6 
(HI3 interface). 
• TETRA data transfer: in this case all the informatio
n provided by the application are encoded within 
the class 2 RO-Invoke operation "Sending
-of-TETRA
-Data". The ASN.1 format is described in 
clauses D.2 and D.7. 
Depending on the class of the operation, the ASE
-HI may have to wait for an answer. In this case a timer, depending on 
the operation, is started on the sending of the operation and 
stopped on the receipt of an answer (RO_Result, RO_Error, 
RO_Reject). 
On timeout of the timer, the ASE_HI indicates to the LI_App
lication that no answer has been received. It is under the 
LI_Application responsibility to send again the data or to inform the administrator of the problem. 
On receipt of an answer component (after verification th
at the component is not erroneous), the ASE_HI stop the 
relevant timer and acts depending on the type of component: 
• On receipt of a RO_Result, the ASE_HI provide the re
levant LI_Application an indication that the data has 
been received by the peer LI_Application and the 
possible parameters contained in the RO_Result. 
• On receipt of a RO_Error, the ASE_HI provide the releva
nt LI_Application an indication that the data has not 
been received by the peer LI_Application and the possibl
e "Error cause". The error causes are defined for each 
operation in the relevant ASN.1 script. It is under the LI_Application responsibility to generate or not an alarm 

message toward an operator or administrator. 
• On receipt of a RO_Reject_U/P, the ASE_HI provide the 
relevant LI_Application an indication that the data 
has not been received by the peer LI_Application and the "Problem cause". The problem causes are defined in 
ITU-T Recommendations X.880 [35] to X.882 [37]. It is under the LI_Application responsibility to send again 

the data or to inform the operator/administrator of the error. 
On receipt of an erroneous component, the ASE_HI act
s as described in ITU-T Recommendations X.880 [35] to 
X.882 [37]. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)70 C.1.2.2 Receiving part 
On receipt of a ROSE operation from the lower layers: 
• When receiving operations from the peer entity, the ASE_HI verifies the syntax of the component and 
transmits the parameters to the LI_Application. If
 no error/problem is detected, in accordance with 
the ITU-T Recommendations X.880 [35] to X.882 [37] standard result (only Class2 operation are defined), the 

ASE_HI sends back a RO_Result which coding is determined by the relevant operation ASN.1 script. The 

different operations which can be received are: 
- RO-Invoke operation "sending-of-HI1-Notification" (HI1 interface); 
- RO-Invoke operation "sending-of-IRI" (HI2 interface); 
- RO-Invoke operation "circuit-Call-related-Services" (HI3 interface); 
- RO-Invoke operation "no-Circuit-Call-related-Services" (HI3 interface); 
- RO-Invoke operation "Sending-of-TETRA-Data" (HI3 interface). 
In case of error, the ASE_HI acts depending on the reason of the error or problem: 
• In accordance with the rules defined by ITU-T Recommendations X.880 [35] to X.882 [37], a RO_Error is 
sent in case of unsuccessfully operation at the applicatio
n level. The Error cause provided is one among those 
defined by the ASN.1 script of the relevant operation. 
• In accordance with the rules defined in ITU-T Recommendations X.880 [35] to X.882 [37], a RO_Reject_U/P 
is sent in case of erroneous component. On receipt of an erroneous component, the ASE_HI acts as described 

in ITU-T Recommendations X.880 [35] to X.882 [37]. 
C.1.2.3 Data link management 
This function is used to establish or release a data li
nk between two peer LI_Applications entities (MF and LEMF). 
C.1.2.3.1 Data link establishment 
Depending on a per destination address configuration data, the data link establishment may be required either by the 
LEMF LI_Application or by the MF LI_Application. 
To request the establishment of a data link toward a peer entity, the LI_Application provides, among others, the 
destination address of the peer entity (implicitly, this address defined the protocol layers immediately under the 

ASE_HI: TCP/IP, X25, etc.). On receipt of this request, 
the ASE_HI request the establishment of the data link with 
respect of the rules of the under layers protocol. 
As soon as the data link is established, the requesting LI_Application initiates an authentication procedure: 
• The origin LI_Application requests the ASE_HI to send the class 2 RO-Invoke operation 
"sending-of-Password" which includes the "origin password" provided by the LI_Application. 
• The peer LI_Application, on receipt of the "origin pass
word" and after acceptance, requests to its ASE_HI to 
send back a RO_Result. In addition, this destination application requests the ASE_HI to send the class 2 
RO-Invoke operation "sending-of-Password" which includes the "destination password" provided by the 
LI_Application. 
• The origin LI_Application, on receipt of the "destina
tion password" and after acceptance, requests to its 
ASE_HI to send back a RO_Result. This application is allowed to send data. 
• After receipt of the RO_Result, this application is allowed to send data. 
In case of erroneous password, the data link is immediately re
leased and a "password error indication" is sent toward the 
operator.
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)71 Optionally a 
Data link test
 procedure may be used to verify periodically the data link: 
• When no data have been exchanged during a network dependent period of time toward an address, (may vary 
from 1 minute to 30 minutes) the LI_Application requests the ASE_HI to send the class 2 RO-Invoke 

operation "data-Link-Test". 
• The peer LI_Application, on receipt of this operation, 
requests to its ASE_HI to
 send back a RO_Result. 
• On receipt of the Result the test is c
onsidered valid by the LI_Application. 
• If no Result is received or if a Reject/Error message is received, the LI_Application requests the ASE_LI to 
release the data link and send an error message toward the operator. 
C.1.2.3.2 Data link release 
• The End of the connection toward the peer LI_Application is under responsibility of the LI_Application. 
E.g. the End of the connection may be requested in the following cases: 
- when all the data (IRI, etc.) has been sent. To prevent unnecessary release, the datalink may be released 
only when no LI_Application data have been exchanged during a network dependent period of time; 
- the data link is established when a call is intercepte
d and released when the intercepted call is released 
(and all the relevant data have been sent); 
- for security purposes; 
- for changing of password or address of the LEMF/IIF;  
- etc. • To end the connection a LI_Application requests the ASE_HI to send the class 2 RO-Invoke operation 
"end-of-Connection". 
• The peer LI_Application, on receipt of this operation, 
requests to its ASE_HI to
 send back a RO_Result. 
• On receipt of the Result the LI_Application requ
ests the ASE_LI to release the data link. 
• If no Result is received after a network dependent period of time, or if a Reject/Error message is received, the 
LI_Application requests the ASE_LI to release the data link and to send an error message toward the 
operator/administrator. 
C.1.2.4 Handling of unrecognized fields and parameters 
See annex G. 
C.1.3 Void 
C.2 FTP 
C.2.1 Introduction 
At HI2 interface FTP is used over Internet protocol stack for the delivery of the IRI. The FTP is defined in 
RFC 959 [46]. The IP is defined in RFC 791 [51]. The TCP is defined in RFC 793 [52]. 
FTP supports reliable delivery of data. The data may be temporarily buffered in the Mediation Function (MF) in case of 
link failure. FTP is independent of the payload data it carries. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)72 C.2.2 Usage of the FTP 
The MF acts as the FTP client and the LEMF acts as the FTP server. The client pushes the data to the server. 
The receiving node LEMF stores the received data as files. The MF may buffer files. 
Several records may be gathered to bigger packages pr
ior to sending, to increase bandwidth efficiency. 
The following configurable intercept data collection (= transfer package closing/file change) threshold parameters 
should be supported: 
• frequency of transfer, based on send timeout, e.g. X ms; 
• frequency of transfer, based on volume trigger, e.g. X octets. 
Every file shall contain only complete IRI records. The single IRI record shall not be divided into several files. 
There are two possible ways how the interception data may be
 sent from the MF to the LEMF. One way is to produce 
files that contain interception data only for one observed target (ref: "File naming method A)"). The other way is to 

multiplex all the intercepted data that MF receives to the same
 sequence of general purpose interception files sent by the 
MF (ref: "File naming method B)"). 
File naming: 
The names for the files transferred to a LEA are formed accord
ing to one of the two available formats, depending on the 
delivery file strategy chosen (e.g. due to national convention or operator preference). 
Either each file contains data of only one observed target (as in method A) or several targets' data is put to files common 
to all observed target traffic through MF (as in method B). 
lThe maximum set of allowed characters in interception file names are "a"–"z", "A"–"Z", "-", "_", ".", and decimals 
"0"–"9". 
File naming method A): 
<LIID>_<seq>.<ext> 
where: 
LIID
 =  As defined in the present document clause "Law
ful Interception IDentifier (LIID)". This field has 
a character string (or digit string for subaddress option) value, e.g. "ABCD123456". This is a 

unique interception request identifier allocated by the ADMF. It will be given by the ADMF to the 
LEA via the HI1 interface after the ADMF has been
 authorized to command the start of the 
interception of a specific target. The possible network operator identifier part used should be 

agreed with (and allocated by) the regula
tory organization administrating the local 
telecommunication practises. 
seq
 =  Integer ranging between [0–.2
64-1
], in ASCII form (not exceeding 20 ASCII digits), identifying 
the sequence number for file transfer from this node per a specific target. 
ext
 =  ASCII integer ranging between ["1"..."8"] (in hex: 31H...38H), identifying the file type. The 
possible file types are shown in table C.2.1. Type "1" is reserved for IRI data files and type "8" is 
reserved for data files according to a national requ
irement by using the same file naming concept. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)73 Table C.2.1: Possible file types 
File types that the LEA may get
 Intercepted data types
 "1" (in binary: 0011 0001) 
IRI/ as option HI1 notifications 
"2" (in binary: 0011 0010) 
CC (MO)  
(see clause F.3.2.2) 
"4" (in binary: 0011 0100) 
CC (MT)  
(see clause F.3.2.2) 
"6" (in binary: 0011 0110) 
CC (MO&MT)  
(see clause F.3.2.2) 
"7" (in binary: 0011 0111) 
IRI + CC (MO&MT)  
(see clause F.3.2.2) 
"8" (in binary: 0011 1000) for national use 
 This alternative A is used when each target's IRI is gathered per observed target to dedicated delivery files. This method 
provides the result of interception in a very refined form to
 the LEAs, but requires somewhat more resources in the MF 
than alternative B. With this method, the data sorting and interpretation tasks of the LEMF are considerably easier to 

facilitate in near real time than in alternative B. 
File naming method B): 
The other choice is to use monolithic fixed format file names (with no trailing file type part in the file name): 
<filenamestring> of the format ABXYyymmddhhmmsseeeet 
where: 
AB = Two letter ASCII Operator ID (as agreed with the national telecom regulators). 
XY = Two letter ASCII identification of the MF node (as assigned by the operator). 
yy = Two digits ASCII integer ranging between ["00"..."99"], identifying the last two digits of the year. 
mm = Two digits ASCII integer ranging between ["01"..."12"], identifying the month. 
dd = Two digits ASCII integer ranging between ["01"..."31"], identifying the day. 
hh = Two digits ASCII integer ranging between ["00"..."23"], identifying the hour. 
mm = Two digits ASCII integer ranging between ["00"..."59"], identifying the minute. 
ss = Two digits ASCII integer ranging between ["00"..."59"], identifying the second. 
eeee = Alphanumeric extension made up of four character
s chosen at the discretion of the Operator and/or 
the MF to avoid file name clashes within the MF. Each of the position shall be out of "A"..."Z", 
"0"..."9". 
t = ASCII integer ranging between ["1"..."8"] (in hex: 31H...38H), identifying the file type. The 
possible file types are shown in table C.2.1. Type "1" is reserved for IRI data files and type "8" is 

reserved for data files according to a national requ
irement by using the same file naming concept. 
EXAMPLE: <filenamestring> (e.g. ABXY00041014084400001). 
where: 
ABXY
 = source node identifier part, used for all files by the mobile network operator "AB" from this MF 
node named "XY". 
00 =  year 2000. 
04 = month April. 
10 =  day 10. 
14 =  hour. 
08 =  minutes. 
44 =  seconds. 
0000 =  extension. 
1 =  file type. The type "1" is reserved for IRI data files and type "8" is reserved for national use.  
(Codings "2" = CC(MO), "4" = CC(MT), "6" = CC(MO&MT) are reserved for HI3). 
This alternative B is used when several targets' intercepted data is gathered to common delivery files. This method does 
not provide the result of interception in as refined form to the LEAs as the alternative A, but it is faster in performance 

for the MF point of view. With this method, the MF does not need to keep many files open like in alternative A. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)74 C.2.3 Profiles 
NOTE: This clause is informative only. 
As there are several ways (usage profiles) how data transfer can be arranged by using the FTP, this clause contains 
practical considerations how the communications can be se
t up. Guidance is given for client-server arrangements, 
session establishments, time outs, the handling of the files (in RAM or disk). Example batch file is described for the 

case that the sending FTP client uses files. If instead (logical) files are sent directly from the client's RAM memory, 

then the procedure can be in principle similar though no script file would then be needed. 
At the LEMF side, FTP server process is run, and at MF, FTP client. No FTP server (which could be accessed from 
outside the operator network) shall run in the MF. The FTP client can be implemented in many ways, and here the FTP 
usage is presented with an example only. The FTP client can be implemented by a batch file or a file sender program 
that uses FTP via an API. The login needs to occur only on
ce per e.g. <destaddr> and <leauser> - pair. Once the login is 
done, the files can then be transferred just by repeating "m
put" command and checking the transfer status (e.g. from the 
API routine return value). To prevent inactivity timer triggering, a dummy command (e.g. "pwd") can be sent every 

T seconds (T should be less than L, the actual idle time limit). If the number of FTP connections is wanted to be as 
minimized as possible, the FTP file transfer method "B" is to be preferred to the method A (though the method A helps 
more the LEMF by pre-sorting the data sent). 
Simple example of a batch file extract: 

FTP commands usage scenario for transferring a list of files: 

To prevent FTP cmd line buffer overflow the best way is to use wildcarded file names, and let the FTP implementation 
do the file name expansion (instead of shell). The number of files for one mput is not limited this way: 
ftp <flags> <destaddr>  user <leauser> <leapasswd>  cd <destpath>  lcd <srcpath>  bin  mput <files> 
 nlist <lastfile> <checkfile>  close EOF  This set of commands opens an FTP connection to a LEA site, logs in with a given account (auto-login is disabled), 
transfers a list of files in binary mode, and checks the transfer status in a simplified way. 
Brief descriptions for the FTP commands used in the example: 
user <user-name> <password> Identify the client to the remote FTP server. 
cd <remote-directory> Change the working directory on the remote machine to 
remote-directory. lcd <directory> Change the working directory on the local machine. 
bin Set the file transfer type to support binary image transfer 
mput <local-files> Expand wild cards in the list of local files given as 
arguments and do a put for each file in the resulting list. Store each local file on the remote machine. nlist <remote-directory> <local-file> Print a list of the files in a directory on the remote 
machine. Send the output to local-file. close Terminate the FTP session with the remote server, and return 
to the command interpreter. Any defined macros are erased.  The parameters are as follows: 
<flags>
 contains the FTP command options, e.g. "-i -n -V -p" which equals to "interactive prompting off", "auto-login 
disabled", "verbose mode disabled", and "passive mode enabled". (These are dependent on the used ftp-version.) 
<destaddr>
 contains the IP address or DNS address of the destination (LEA) 
<leauser>
 contains the receiving (LEA) username 
<leapasswd>
 contains the receiving (LEA) user's password 
<destpath>
 contains the destination path 
<srcpath>
 contains the source path 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)75 <files>
 wild carded file specification (matching the files to be transferred) 
<lastfile>
 the name of the last file to be transferred 
<checkfile>
 is a (local) file to be checked upon 
transfer completion; if it exists then
 the transfer is considered successful 
The FTP application should to do the following things if the check file is not found: 
• keep the failed files; 
• raise "file transfer failure" error condition (i.e. send alarm to the corresponding LEA); 
• the data can be buffered for a time that the buffer size allows. If that would finally be exhausted, DF would 
start dropping the corresponding target's data until the transfer failure is fixed; 
• the transmission of the failed files is retried until the 
transfer eventually succeeds. Then the DF would again 
start collecting the data; 
• upon successful file transfer the sent files are deleted from the DF. 
The FTP server at LEMF shall not allow anonymous login of an FTP client. 
It is required that FTP implementation guarantees that LEMF will start processing data only after data transfer is 
complete. 
The following implementation example addresses a particular issue of FTP implementation. It is important however to 
highlight that there are multiple ways of addressing the problem in question, and therefore the given example does not 

in any way suggest being the default one. 
• MF sends data with a filename, which indicates that the file is temporary. Once data transfer is complete, MF 
renames temporary file into ordinary one (as defined in clause C.2.2). 
 The procedure for renaming filename should be as follow: 
1) open FTP channel (if not already open) from MF to LEMF; 

2) sends data to LEMF using command "put" with temporary filename; 
3) after MF finished sending the file, renaming it as ordinary one with command "ren". 
 Brief descriptions for the FTP commands used in the example: 
ren <from-name> <to-name> renaming filename from-name to to-name. 
 If the ftp-client want to send file to LEMF using the command "mput" (e.g. MF stored many IRI files and want 
to send all together with one command), every filename transferred successfully must be renamed each after 

command "mput" ended. 
C.2.4 File content 
The file content is in method A relating to only one intercepted target. 
In the file transfer method B, the file content may relate to
 any intercepted targets whose 
intercept records are sent to 
the particular LEMF address. 
Individual IRI records shall not be fragmented into separate files at the FTP layer. 
C.2.5 Exceptional procedures 
Overflow at the receiving end (LEMF) is av
oided due to the nature of the protocol. 
In case the transit network or receiving end system (LEMF) 
is down for a reasonably short time period, the local 
buffering at the MF will be sufficient as a delivery reliability backup procedure. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)76 In case the transit network or receiving end system (LEMF) is down for a very long period, the local buffering at the 
MF may have to be terminated. Then the following intercepted data coming from the intercepting nodes to the MF 

would be discarded, until the transit network or LEMF is up and running again. 
C.2.6 Other considerations 
The FTP protocol mode parameters used: 
• Transmission Mode: stream. 
• Format: non-print. 
• Structure: file-structure. 
• Type: binary. 
The FTP client (= user-FTP process at the MF) uses e.g. th
e default standard FTP ports 20 (for data connection) and 21 
(for control connection), "passive" mode is supported. The data transfer process listens the data port for a connection 

from a server-FTP process.
 For the file transfer from the MF to the LEMF(s) e.g. the following data transfer parameters are provided for the FTP 
client (at the MF):
 • transfer destination (IP) address, e.g. "194.89.205.4"; 
• transfer destination username, e.g. "LEA1"; 
• transfer destination directory path, e.g. "/usr/local/LEA1/1234-8291"; 
• transfer destination password; 
• interception file type, "1" (this is needed only if the file naming method A is used).
 LEMF may use various kind directory structures for the recep
tion of interception files. It 
is strongly recommended that 
at the LEMF machine the structure and access and modification ri
ghts of the storage directories are adjusted to prevent 
unwanted directory operations by a FTP client. 
Timing considerations for the HI2 FTP transmission: 
The MF and LEMF sides control the timers to ensure reliabl
e, near-real time data transfer. The transmission related 
timers are defined within the lower layers of the used protocol and are out of scope of the present document. 
The following timers may be used within the LI application. 
Table C.2.2: Timing considerations 
Name
 Controlled by
 Units Description
 T1 inactivity timer 
LEMF Seconds 
Triggered by no activity within the FTP session (no new files). 
The FTP session is torn down when the T1 expires. To send 

another file the new connection will be established. The timer 

avoids the FTP session overflow at the LEMF side. 
T2 send file trigger 
MF Milliseconds 
Forces the file to be transmitted to the LEMF (even if the size 
limit has not been reached yet in case of volume trigger active). If 

the timer is set to 0 the only trigger to send the file is the file size 

parameter (see clause C.2.2). 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)77 Annex D (normative): 
Structure of data at the Handover Interface 
This annex specifies the coding details at the Handover Interface HI for all data, which may be sent from the 
NWO/AP/SvP's equipment to the LEMF, across HI. 
At the three Handover Interface (HI) ports, the following data may be present: 
• interface port HI1: Interception 
administration information; 
• interface port HI2: Intercept Related Information (IRI); 
• interface port HI3: records containing Content of Communication (CC). 
The detailed coding specification for these types of information is contained in this annex, including sufficient details 
for a consistent implementation in the NWO/AP/SvP's equipment and the LEMF. 
It must be noticed some data are ROSE specific and have no meaning when FTP is used. Those specificities are 
described at the beginning of each clause (clauses D.3 to D.6). 
D.1 Syntax definitions 
The transferred information and messages are encoded to be binary compatible with ITU-T 

Recommendations X.680 [33] (Abstract Syntax Notation One (ASN.1)) and X.690 [34] (Basic Encoding Rules (BER)). 
These recommendations use precise definitions of the words 
type
, class
, value, and 
parameter
. Those definitions are 
paraphrased below for clarity. 
A type
, in the context of the abstract syntax or transfer syntax
, is a set of all possible values. For example, an INTEGER 
is a type for all negative and positive integers. 
A class
, in the context of the abstract syntax or transfer syntax, is a one of four possible domains for uniquely defining a 
type. The classes defined by ASN.1 and BER are: UNIVERSAL, APPLICATION, CONTEXT, and PRIVATE. 
The UNIVERSAL class is reserved for international standards such as ITU-T Recommendations X.680 [33] and 
X.690 [34]. Most parameter type identifiers in the HI ROSE operations are encoded as CONTEXT specific class. Users 
of the protocol may extend the syntax with PRIVATE class parameters without conflict with the present document, but 

risk conflict with other users' extensions. APPLICATION class parameters are reserved for future extensions. 
A value is a particular instance of a type. For example, five (5) is a possible value of the type INTEGER. 
A parameter
 in the present document is a particular instance of the transfer syntax to transport a value consisting of a 
tag to identify the parameter type, a length to specify the number of octets in the value, and the value. 
In the BER a 
tag
 (a particular type and class identifier) may 
either be a primitive or a constructor. A 
primitive
 is a pre-defined type (of class UNIVERSAL) and a 
constructor
 consists of other types (primitives or other constructors). A 
constructor type may either be IMPLICIT or EXPLICIT. An IMPLICIT type is encoded with the constructor identifier 

alone. Both ends of a communication must understand the underlying structure of the IMPLICIT types. EXPLICIT 

types are encoded with the identifiers of all the contained types. For example, an IMPLICIT Number of type INTEGER 

would be tagged only with the 
Number
 tag, where an EXPLICIT number of type INTEGER would have the 
INTEGER
 tag within the 
Number
 tag. The present document uses IMPLICIT tagging for more compact message encoding. 
For the coding of the value part of each parameter the general rule is to use a widely use a standardized format when it 
exists (ISUP, DSS1, MAP, etc.). 
As a large part of the information exchanged between the users may be transmitted within ISUP/DSS1 signalling, the 
using of the coding defined for this signalling guarantee the integrity of the information provided to the LEMF and the 

evolution of the interface. For example if new values are used within existing ISUP parameters, this new values shall be 
transmitted transparently toward the LEMF. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)78 For the ASN.1 parameters of the type "OCTET STRING", the ordering of the individual halfoctets of each octet shall 
be such that the most significant halfoctet is put into bit position 5 to 8 and the least significant halfoctet into bit 

position 1 to 4. This general rule shall not apply when parameter formats are imported from other standards, e.g. an 

E.164 number coded according to ISUP (ITU-T Recommendation Q.763 [48]). In this case the ordering of the halfoctet 

shall be according to that standard and not be changed. 
D.2 Object tree 
specific version 
identified-organization (4) 
etsi(0) 
securityDomain(2) 
lawfulIntercept(2) 
fraud(1) 
en301040(1040) 
ts101909(1909) 
[section D.
4] hi1(0) 
hi2(1) 
him(3) 
hi3(2) 
threeGPP(4)
 li-ps(5) 
itu-t(0) 
part20(20) 
subpart(2) 
notificationOperations(1)
 circuitLI(1)
 tETRALI(2)
 gPRSLI(3) 
cclinkLI(4) 
subpart(1) 
r7(7) 
gSMLI(5) 
[section D.
3] [section D.
5] [section D.
6] [TS 101 90
9-20-1] [section D.
9] [section D.
8] [TS 133.10
8] mobileDomain(0)) 
[section D.
7] [TS 301 04
0} [TS 102 23
2-1) rdHeader(0)
 [TS 102 65
7) retainedData(3) 
tetra(6) 
hi2(2) 
hi1(1) 
notificationOperations(1)
 hi3(3) 
[section D.1
0]  Figure D.2.1: Object Tree: Lawful Interception in ETSI domain 
TR 102 503 [i.4] describes the structure for the ETSI domain with the included Lawful Intercept (LI) domain and 
ASN.1 modules from other Lawful Interception specifications in detail. It gives an overview over all the relevant Object 

IDentifiers (OID) used in ASN.1 modules of the Lawful Intercept specifications and point to the specification where the 

modules can be found. 
The ASN.1 definitions are contained in nine .txt files ("HIManagementOperations, ver3.txt", 
"HI1NotificationOperations, ver6.txt", "HI2Operations, ver11.txt", "HI3CircuitDataOperations, ver3.txt", 
"HI3CCLinkData, ver4.txt", "Gprs-HI3-PS,ver3.txt", "TETRA-HI1NotificationOperations,ver0.txt", 

"TETRA-HI2Operations,ver0.txt" and "TETRA-HIManag
ementOperations,ver0.txt"
 contained in archive 
"ts_101671v030501p0.zip") which accompanies the present document. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)79 D.3 HI management operation 
This data description applies only for ROSE delivery mechanism. 
ASN.1 description of HI management operation (any HI interface) 
HIManagementOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) him(3) version3(3)}  DEFINITIONS IMPLICIT TAGS ::= BEGIN   EXPORTS     sending-of-Password, 
 data-Link-Test,  end-Of-Connection;  IMPORTS     OPERATION, 
 ERROR   FROM 
Remote-Operations-Information-Objects   {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)}; 
 -- ============================= -- Object Identifier definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- him Domain himDomainId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId him(3)} himOperationId OBJECT IDENTIFIER ::= {himDomainId version3(3)}  sending-of-Password  OPERATION ::= 
{  ARGUMENT Password-Name 
 ERRORS  {ErrorsHim} 
 CODE  global:{himDomainId sending-of-Password(1) version1(1)} 
} -- Class 2 operation. The timer must be set to a value between 3s and 240s -- The timer default value is 60s  data-Link-Test   OPERATION ::= 
{  ERRORS   {other-failure-causes} 
 CODE  global:{himDomainId data-link-test(2) version1(1)} 
} -- Class 2 operation. The timer must be set to a value between 3s and 240s -- The timer default value is 60s  end-Of-Connection  OPERATION ::= 
{  ERRORS   {other-failure-causes} 
 CODE  global:{himDomainId end-of-connection(3) version1(1)} 
} -- Class 2 operation. The timer must be set to a value between 3s and 240s -- The timer default value is 60s  other-failure-causes ERROR ::= {CODE local:0} 
missing-parameter  ERROR ::= {CODE local:1} 
unknown-parameter  ERROR ::= {CODE local:2} 
erroneous-parameter  ERROR ::= {CODE local:3} 
 ErrorsHim    
ERROR ::= {  other-failure-causes | 
 missing-parameter | 
 unknown-parameter | 
 erroneous-parameter 
}    ETSI ETSI TS 101 671 V3.5.1
 (2009
-11)80 Password-Name ::= SEQUENCE {  domainID [0] OBJECT IDENTIFIER (himOperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism
  password [1] OCTET STRING (SIZE (1..25)), 
 name  [2] OCTET STRING (SIZE (1..25)), 
 ... 
}  -- IA5 string recommended 
 END Œ- end of HIManagementOperations  D.4 LI management notification 
Declaration of ROSE operation "sending-of-HI1-Notification"
 is ROSE delivery mechanism specific. When using FTP 
delivery mechanism, data HI1-Operation must be considered. 
NOTE: This annex does not describe an electronic Handover Interface, but HI1 information, which is sent to the 
LEMF across the HI2 port. 
ASN.1 description of LI management not
ification operation (HI1 interface) 
HI1NotificationOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi1(0) notificationOperations(1) version6(6)}  DEFINITIONS IMPLICIT TAGS ::= BEGIN  IMPORTS  OPERATION,  ERROR   FROM 
Remote-Operations-Information-Objects   {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)} 
  -- from clause D.5 
 CommunicationIdentifier,  TimeStamp,  LawfulInterceptionIdentifier   FROM 
HI2Operations   {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) 
version10(10)};  -- ============================= -- Object Identifier Definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi1 Domain hi1NotificationOperationsId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi1(0) notificationOperations(1)} hi1OperationId OBJECT IDENTIFIER ::= {hi1NotificationOperationsId version6(6)}  sending-of-HI1-Notification  OPERATION ::= 
{  ARGUMENT HI1-Operation 
 ERRORS  {ErrorHI1Notifications} 
 CODE  global:{hi1NotificationOperationsId version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s. -- NOTE: The value for this timer is to be set on the equipment waiting for the returned message; -- its value shall be agreed between the NWO/AP/SvP and the LEA, depending on their equipment -- properties.    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)81 other-failure-causes  ERROR ::= {CODE local:0} 
missing-parameter  ERROR ::= {CODE local:1} 
unknown-parameter  ERROR ::= {CODE local:2} 
erroneous-parameter  ERROR ::= {CODE local:3} 
 ErrorHI1Notifications ERROR ::= {  other-failure-causes | 
 missing-parameter | 
 unknown-parameter | 
 erroneous-parameter 
}  HI1-Operation ::= CHOICE {  liActivated      [1] Notification, 
 liDeactivated     [2] Notification, 
 liModified      [3] Notification, 
 alarms-indicator    [4] Alarm-Indicator, 
 ..., 
 national-HI1-ASN1parameters
  [5] National-HI1-ASN1parameters 
}  -- ================== -- PARAMETERS FORMATS -- ==================  Notification ::= SEQUENCE {  domainID      [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 lawfulInterceptionIdentifier  [1] LawfulInterceptionIdentifier, 
  -- This identifier is the LIID identity provided with the lawful authorization 
  -- for each target. 
 communicationIdentifier   [2] CommunicationIdentifier OPTIONAL, 
  -- Only the NWO/PA/SvPIdentifier is provided (the one provided with the Lawful 
  -- authorization). 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671 [i.5] 
 timeStamp      [3] TimeStamp, 
  -- date and time of the report. 
 ..., 
 national-HI1-ASN1parameters
  [5] National-HI1-ASN1parameters OPTIONAL, 
 target-Information    [6] OCTET STRING (SIZE (1..256)) OPTIONAL 
  -- provides information about the number or the characteristic of the target  
  -- (e.g. E-mail address, E.164 number), ASCII format 
}  Alarm-Indicator ::= SEQUENCE {  domainID      [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 communicationIdentifier   [1] CommunicationIdentifier OPTIONAL, 
  -- Only the NWO/PA/SvPIdentifier is provided (the one provided with the 
  -- Lawful authorization) 
 timeStamp      [2] TimeStamp, 
  -- date and time of the report. 
 alarm-information    [3] OCTET STRING (SIZE (1..25)), 
  -- Provides information about alarms (free format). 
 ..., 
 lawfulInterceptionIdentifier [4] LawfulInterceptionIdentifier OPTIONAL, 
  -- This identifier is the LIID identity provided with the lawful authorization 
  -- for each target in according to national law 
 national-HI1-ASN1parameters
  [5] National-HI1-ASN1parameters OPTIONAL 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)82 National-HI1-ASN1parameters ::= SEQUENCE {  domainID  [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism. 
 countryCode  [1] PrintableString (SIZE (2)), 
  -- Country Code according to ISO 3166-1 [67], 
  -- the country to which the parameters inserted after the extension marker apply. 
 ... 
  -- In case a given country wants to use additional national parameters according to its law, 
  -- these national parameters should be defined using the ASN.1 syntax and added after the 
  -- extension marker (...). 
  -- It is recommended that "version parameter" and "vendor identification parameter" are 
  -- included in the national parameters definition. Vendor identifications can be 
  -- retrieved from IANA web site (see annex J). Besides, it is recommended to avoid 
  -- using tags from 240 to 255 in a formal type definition. 
}  END -Œ end of HI1NotificationOperations  D.5 Intercept related information (HI2 PS and CS) 
Declaration of ROSE operation "sending-of-IRI" is ROSE delivery mechanism specific. When using FTP delivery 
mechanism, data IRIsContent must be considered. 
ASN.1 description of IRI (HI2 interface) 
HI2Operations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) version11(11)}  DEFINITIONS IMPLICIT TAGS ::=  BEGIN  IMPORTS OPERATION,  ERROR   FROM 
Remote-Operations-Information-Objects   {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)} 
  -- from 3GPP TS 33.108 [61] 
 UmtsQos,  IMSevent,  LDIevent, 
 CorrelationValues 
  FROM UmtsHI2Operations 
  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulintercept(2) 
threeGPP(4) hi2(1) r8(8) version-1(1)}   -- from TS 101 909-20-01 [69] 
 TARGETACTIVITYMONITOR-1   FROM 
TS101909201   {itu-t(0) identified-organization(4) etsi(0) ts101909(1909) part20(20) subpart1(1) 
interceptVersion(0)}   -- from EN 301 040 [72] 
 TARGETACTIVITYMONITORind,  TARGETCOMMSMONITORind, 
 TTRAFFICind,
  CTTRAFFICind   FROM 
EN301040   {itu-t(0) identified-organization(4) etsi(0) en301040 (1040) interceptVersion (0)}; 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)83 -- ============================= -- Object Identifier Definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- Security Subdomains hi2DomainId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi2(1)} hi2OperationId OBJECT IDENTIFIER ::= {hi2DomainId version11(11)}  sending-of-IRI OPERATION ::= {  ARGUMENT IRIsContent 
 ERRORS  {OperationErrors} 
 CODE  global:{hi2DomainId sending-of-IRI(1) version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s. -- NOTE: The same note as for HI management operation applies.  IRIsContent ::= CHOICE {  iRIContent
   [0] IRIContent,
  iRISequence   [1] IRISequence
 }  IRISequence ::= SEQUENCE OF IRIContent  -- Aggregation of IRIContent is an optional feature. 
 -- It may be applied in cases when at a given point in time several IRI records are 
 -- available for delivery to the same LEA destination. 
 -- As a general rule, records created at any event shall be sent immediately and shall 
 -- not held in the DF or MF in order to apply aggregation. 
 -- When aggregation is not to be applied, IRIContent needs to be chosen. 
 IRIContent ::= CHOICE {  iRI-Begin-record  [1] IRI-Parameters, 
  -- At least one optional parameter must be included within the iRI-Begin-Record. 
 iRI-End-record   [2] IRI-Parameters, 
 iRI-Continue-record  [3] IRI-Parameters, 
  -- At least one optional parameter must be included within the iRI-Continue-Record. 
 iRI-Report-record  [4] IRI-Parameters, 
  -- At least one optional parameter must be included within the iRI-Report-Record. 
 ... 
}  unknown-version   ERROR ::= {CODE local:0} 
missing-parameter  ERROR ::= {CODE local:1} 
unknown-parameter-value ERROR ::= {CODE local:2} unknown-parameter  ERROR ::= {CODE local:3} 
 OperationErrors   
ERROR ::= {  unknown-version | 
 missing-parameter | 
 unknown-parameter-value | 
 unknown-parameter 
} -- These values may be sent by the LEMF, when an operation or a parameter is misunderstood.    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)84 IRI-Parameters ::= SEQUENCE {  domainID       [0] OBJECT IDENTIFIER (hi2OperationId) OPTIONAL, 
  -- for the sending entity the inclusion of the Object Identifier is mandatory 
 iRIversion     
  [23] ENUMERATED 
 { 
  version2(2),   ..., 
  version3(3),   version4(4),   version5(5),   version6(6),   version7(7),   lastVersion(8)  } OPTIONAL, 
  -- Optional parameter "iRIversion" (tag 23) is redundant starting  
  -- from TS 101 671 v2.4.1 [i.5] 
  -- where to the object identifier "domainID" was introduced into IRI-Parameters. 
  -- In order to keep backward compatibility, even when the version of the "domainID" 
  -- parameter will be incremented it is recommended to always send to LEMF the same: 
  -- enumeration value "lastVersion(8)". 
  -- if not present, it means version 1 is handled 
 lawfulInterceptionIdentifier  [1] LawfulInterceptionIdentifier, 
  -- This identifier is associated to the target. 
 communicationIdentifier    [2] CommunicationIdentifier, 
  -- used to uniquely identify an intercepted call. 
  -- Called "callIdentifier" in v1.1.1 of ES 201 671 [i.5]. 
 timeStamp       [3] TimeStamp, 
  -- date and time of the event triggering the report. 
 intercepted-Call-Direct    [4] ENUMERATED 
 { 
  not-Available(0),   originating-Target(1),    -- In case of GPRS, this indicates that the PDP context activation, modification 
   -- or deactivation is MS requested. 
  terminating-Target(2),    -- In case of GPRS, this indicates that the PDP context activation, modification 
   -- or deactivation is network initiated. 
  ... 
 } OPTIONAL, 
 intercepted-Call-State     [5] Intercepted-Call-State OPTIONAL, 
 ringingDuration      [6] OCTET STRING (SIZE (3)) OPTIONAL, 
  -- Duration in seconds. BCD coded : HHMMSS 
 conversationDuration     [7] OCTET STRING (SIZE (3)) OPTIONAL, 
  -- Duration in seconds. BCD coded : HHMMSS 
 locationOfTheTarget     [8] Location OPTIONAL, 
  -- location of the target subscriber 
 partyInformation      [9] SET SIZE (1..10) OF PartyInformation OPTIONAL, 
  -- This parameter provides the concerned party (Originating, Terminating or forwarded 
  -- party), the identity(ies) of the party and all the information provided by the party. 
 callContentLinkInformation   [10] SEQUENCE 
 { 
  cCLink1Characteristics  [1] CallContentLinkCharacteristics OPTIONAL, 
   -- Information concerning the Content of Communication Link Tx channel established 
   -- toward the LEMF (or the sum signal channel, in case of mono mode). 
  cCLink2Characteristics  [2] CallContentLinkCharacteristics OPTIONAL, 
   -- Information concerning the Content of Communication Link Rx channel established 
   -- toward the LEMF. 
  ... 
 } OPTIONAL, 
 release-Reason-Of-Intercepted-Call [11] OCTET STRING (SIZE (2)) OPTIONAL, 
  -- Release cause coded in ITU-T Q.850 [31] format. 
  -- This parameter indicates the reason why the intercepted call cannot be established or 
  -- why the intercepted call has been released after the active phase. 
 nature-Of-The-intercepted-call  [12] ENUMERATED 
 { 
  -- Nature of the intercepted "call": 
  gSM-ISDN-PSTN-circuit-call(0),    -- the possible UUS content is sent through the HI2 or HI3 "data" interface 
   -- the possible call content call is established through the HI3 "circuit" interface 
  gSM-SMS-Message(1),    -- the SMS content is sent through the HI2 or HI3 "data" interface 
  uUS4-Messages(2),    -- the UUS content is sent through the HI2 or HI3 "data" interface 
  tETRA-circuit-call(3),    -- the possible call content call is established through the HI3 "circuit" interface 
   -- the possible data are sent through the HI3 "data" interface 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)85   teTRA-Packet-Data(4),    -- the data are sent through the HI3 "data" interface 
  gPRS-Packet-Data(5),    -- the data are sent through the HI3 "data" interface 
  ..., 
  uMTS-circuit-call(6)    -- the possible call content call is established through the HI3 "circuit" interface 
   -- the possible data are sent through the HI3 "data" interface 
 } OPTIONAL, 
 serverCenterAddress     [13] PartyInformation OPTIONAL, 
  -- e.g. in case of SMS message this parameter provides the address of the relevant 
  -- server within the calling (if server is originating) or called 
  -- (if server is terminating) party address parameters 
 sMS         [14] SMS-report OPTIONAL, 
  -- this parameter provides the SMS content and associated information 
 cC-Link-Identifier     [15] CC-Link-Identifier OPTIONAL, 
  -- Depending on a network option, this parameter may be used to identify a CC link 
  -- in case of multiparty calls. 
 national-Parameters     [16] National-Parameters OPTIONAL, 
 gPRSCorrelationNumber    [18] GPRSCorrelationNumber OPTIONAL, 
 gPRSevent        [20] GPRSEvent OPTIONAL, 
  -- This information is used to provide particular action of the target 
  -- such as attach/detach 
 sgsnAddress       [21] DataNodeAddress OPTIONAL, 
 gPRSOperationErrorCode     [22] GPRSOperationErrorCode OPTIONAL, 
 ..., 
 ggsnAddress       [24] DataNodeAddress OPTIONAL, 
 qOS         [25] UmtsQos OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 networkIdentifier     [26] Network-Identifier OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 sMSOriginatingAddress     [27] DataNodeAddress OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 sMSTerminatingAddress     [28] DataNodeAddress OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 iMSevent       [29] IMSevent OPTIONAL, 
 sIPMessage       [30] OCTET STRING OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 servingSGSN-number     [31] OCTET STRING (SIZE (1..20)) OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 servingSGSN-address     [32] OCTET STRING (SIZE (5..17)) OPTIONAL, 
  -- Octets are coded according to 3GPP TS 23.003 [76] 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 tARGETACTIVITYMONITOR    [33] TARGETACTIVITYMONITOR-1 OPTIONAL, 
  -- Parameter is used in TS 101 909-20-1 [69] 
 ldiEvent        [34] LDIevent OPTIONAL, 
  -- The "Location Dependent Interception" parameter is duplicated from 3GPP TS 33.108 [61] 
 correlation       [35] CorrelationValues OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61] 
 tARGETACTIVITYMONITORind   
[36] TARGETACTIVITYMONITORind OPTIONAL,   -- Parameter is used in EN 301 040 [72]
  tARGETCOMMSMONITORind    
[37] TARGETCOMMSMONITORind OPTIONAL,   -- Parameter is used in EN 301 040 [72]
  tTRAFFICind       
[38] TTRAFFICind OPTIONAL,   -- Parameter is used in EN 301 040 [72]
  cTTRAFFICind      [39] CTTRAFFICind OPTIONAL, 
  -- Parameter is used in EN 301 040 [72] 
 national-HI2-ASN1parameters   [255] National-HI2-ASN1parameters OPTIONAL 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)86 -- ================== -- PARAMETERS FORMATS -- ==================  CommunicationIdentifier ::= SEQUENCE {  communication-Identity-Number [0] OCTET STRING (SIZE (1..8)) OPTIONAL, 
  -- Temporary Identifier of an intercepted call to uniquely identify an intercepted call 
  -- within the node. This parameter is mandatory if there is associated 
  -- information sent over HI3interface (CClink, data,..) or when 
  -- CommunicationIdentifier is used for IRI other than IRI-Report-record 
  -- This parameter was called "call-Identity-Number" in V1.1.1 of ES 201 671 [i.5] 
  -- The individual digits of the communication-Identity-Number shall be represented in 
  -- ASCII format, e.g. "12345678" = 8 octets 0x31 0x32 0x33 0x34 0x35 0x36 0x37 0x38. 
  -- For subaddress option only "0"..."9" shall be used. 
 network-Identifier    [1] Network-Identifier, 
 ... 
} -- NOTE: The same "CommunicationIdentifier" value is sent : -- with the HI3 information for correlation purpose between the IRI and the information sent on -- the HI3 interfaces (CCLink, data, ..) with each IRI associated to a same intercepted call -- for correlation purpose between the different IRI.  Network-Identifier ::= SEQUENCE {  operator-Identifier   [0] OCTET STRING (SIZE (1..5)), 
  -- It is a notification of the NWO/AP/SvP in ASCII- characters. 
  -- For subaddress option only "0"..."9" shall be used. 
  -- The parameter is mandatory. 
 network-Element-Identifier [1] Network-Element-Identifier OPTIONAL, 
 ... 
}  Network-Element-Identifier ::= CHOICE {  e164-Format   [1] OCTET STRING (SIZE (1..25)), 
  -- E164 address of the node in international format. Coded in the same format as the 
  -- calling party number parameter of the ISUP (parameter part: EN 300 356 [5]). 
 x25-Format   [2] OCTET STRING (SIZE (1..25)), 
  -- X25 address 
 iP-Format   [3] OCTET STRING (SIZE (1..25)), 
  -- IP address 
 dNS-Format   [4] OCTET STRING (SIZE (1..25)), 
  -- DNS address 
 ..., 
 iP-Address   [5] IPAddress 
}  CC-Link-Identifier ::=  OCTET STRING (SIZE (1..8))  -- Depending on a network option, this parameter may be used to identify a CClink 
 -- in case of multiparty calls. 
 -- The individual digits of the CC-Link-Identifier shall be represented in 
 -- ASCII format, e.g. "12345678" = 8 octets 0x31 0x32 0x33 0x34 0x35 0x36 0x37 0x38. 
 -- For subaddress option only "0"..."9" shall be used. 
 TimeStamp ::= CHOICE { -- The minimum resolution required is one second. -- "Resolution" is the smallest incremental change that can be measured for time and -- is expressed with a definite number of decimal digits or bits.  localTime   [0] LocalTimeStamp, 
 utcTime    [1] UTCTime 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)87 LocalTimeStamp ::= SEQUENCE {  generalizedTime     [0] GeneralizedTime, 
  -- The minimum resolution required is one second.   -- "Resolution" is the smallest incremental change that can be measured for time and 
  -- is expressed with a definite number of decimal digits or bits. 
 winterSummerIndication   [1] ENUMERATED 
 { 
  notProvided(0),   winterTime(1),   summerTime(2),   ... 
 } 
}  PartyInformation ::= SEQUENCE {  party-Qualifier      [0] ENUMERATED 
 { 
  originating-Party(0),    -- In this case, the partyInformation parameter provides the identities related to 
   -- the originating party and all information provided by this party. 
   -- This parameter provides also all the information concerning the redirecting 
   -- party when a forwarded call reaches a target. 
  terminating-Party(1),    -- In this case, the partyInformation parameter provides the identities related to 
   -- the terminating party and all information provided by this party. 
  forwarded-to-Party(2),    -- In this case, the partyInformation parameter provides the identities related to 
   -- the forwarded to party and parties beyond this one and all information 
   -- provided by this parties, including the call forwarding reason. 
  gPRS-Target(3),   ... 
 }, 
 partyIdentity       [1] SEQUENCE 
 { 
  imei    [1] OCTET STRING (SIZE (8)) OPTIONAL, 
   -- See MAP format TS GSM 09.02 [32] 
  tei     [2] OCTET STRING (SIZE (1..15)) OPTIONAL, 
   -- ISDN-based Terminal Equipment Identity 
  imsi    [3] OCTET STRING (SIZE (3..8)) OPTIONAL, 
   -- See MAP format TS GSM 09.02 [32] International Mobile 
   -- Station Identity E.212 number beginning with Mobile Country Code 
  callingPartyNumber [4] CallingPartyNumber OPTIONAL, 
   -- The calling party format is used to transmit the identity of a calling party 
  calledPartyNumber [5] CalledPartyNumber OPTIONAL, 
   -- The called party format is used to transmit the identity of a called party or 
   -- a forwarded to party. 
  msISDN    [6] OCTET STRING (SIZE (1..9)) OPTIONAL, 
   -- MSISDN of the target, encoded in the same format as the AddressString 
   -- parameters defined in MAP format TS GSM 09.02 [32] 
  ..., 
  e164-Format   [7] OCTET STRING (SIZE (1..25)) OPTIONAL, 
   -- E164 address of the node in international format. Coded in the same format as 
   -- the calling party number parameter of the ISUP (parameter part: EN 300 356 [5]) 
  sip-uri    [8] OCTET STRING OPTIONAL, 
   -- Session Initiation Protocol - Uniform Resource Identifier. See RFC 3261 [59]. 
   -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
  tel-url     [9] OCTET STRING OPTIONAL 
   -- See "URLs for Telephone Calls", RFC 3966 [68]. 
   -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 }, 
 services-Information    [2] Services-Information OPTIONAL, 
  -- This parameter is used to transmit all the information concerning the 
  -- complementary information associated to the basic call 
 supplementary-Services-Information [3] Supplementary-Services OPTIONAL, 
  -- This parameter is used to transmit all the information concerning the 
  -- activation/invocation of supplementary services during a call or out-of call not 
  -- provided by the previous parameters. 
 services-Data-Information    [4] Services-Data-Information OPTIONAL, 
  -- This parameter is used to transmit all the information concerning the complementary 
  -- information associated to the basic data call. 
 ... 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)88 CallingPartyNumber ::= CHOICE {  iSUP-Format   [1] OCTET STRING (SIZE (1..25)), 
  -- Encoded in the same format as the calling party number (parameter field) 
  -- of the ISUP (see EN 300 356 [5]). 
 dSS1-Format   [2] OCTET STRING (SIZE (1..25)), 
  -- Encoded in the format defined for the value part of the Calling party number 
  -- information element of DSS1 protocol EN 300 403-1 [6]. 
  -- The DSS1 Information element identifier and the DSS1 length are not included. 
 ..., 
 mAP-Format   [3] OCTET STRING (SIZE (1..25)) 
  -- Encoded as AddressString of the MAP protocol TS GSM 09.02 [32]. 
}  CalledPartyNumber ::= CHOICE {  iSUP-Format   [1] OCTET STRING (SIZE (1..25)), 
  -- Encoded in the same format as the called party number (parameter field) 
  -- of the ISUP (see EN 300 356 [5]). 
 mAP-Format   [2] OCTET STRING (SIZE (1..25)), 
  -- Encoded as AddressString of the MAP protocol TS GSM 09.02 [32]. 
 dSS1-Format   [3] OCTET STRING (SIZE (1..25)), 
  -- Encoded in the format defined for the value part of the Called party number information 
  -- element of DSS1 protocol EN 300 403-1 [6]. 
  -- The DSS1 Information element identifier and the DSS1 length are not included. 
 ... 
}  Location ::= SEQUENCE {  e164-Number   [1] OCTET STRING (SIZE (1..25)) OPTIONAL, 
  -- Coded in the same format as the ISUP location number (parameter 
  --field) of the ISUP (see EN 300 356 [5]). 
 globalCellID  [2] OCTET STRING (SIZE (5..7)) OPTIONAL, 
  -- See MAP format (see TS GSM 09.02 [32]). 
 tetraLocation  [3] TetraLocation OPTIONAL, 
  -- This optional parameter is not in use anymore, but is kept for backwards compatibility. 
 rAI     [4] OCTET STRING (SIZE (6)) OPTIONAL, 
  -- The Routeing Area Identifier (RAI) in the current SGSN is coded in accordance with 
  -- 3GPP TS 24.008 [41] without the Routing Area Identification IEI (only the 
  -- last 6 octets are used). 
 gsmLocation   [5] GSMLocation OPTIONAL, 
 umtsLocation
  [6] UMTSLocation OPTIONAL, 
 sAI     [7] OCTET STRING (SIZE (7)) OPTIONAL, 
  -- format: PLMN-ID 3 octets (no. 1-3), 
  --    LAC  2 octets (no. 4-5), 
  --    SAC  2 octets (no. 6-7) 
  --    (according to 3GPP TS 25.431 [62]). 
 ..., 
 oldRAI    [8] OCTET STRING (SIZE (6)) OPTIONAL 
  -- the "Routeing Area Identifier" in the old SGSN is coded in accordance with 
  -- 3GPP TS 24.008 [41] without the Routing Area Identification IEI 
  -- (only the last 6 octets are used). 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
}  TetraLocation ::= CHOICE  -- This optional parameter is not in use anymore, but is kept for backwards compatibility. 
{  ms-Loc  [1] SEQUENCE 
 { 
  mcc    [1] INTEGER (0..1023), 
   -- 10 bits EN 300 392-1 [40] 
  mnc    [2] INTEGER (0..16383), 
   -- 14 bits EN 300 392-1 [40] 
  lai    [3] INTEGER (0..65535), 
   -- 14 bits EN 300 392-1 [40] 
  ci    [4] INTEGER OPTIONAL 
 }, 
 ls-Loc  [2] INTEGER 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)89 GSMLocation ::= CHOICE {  geoCoordinates   [1] SEQUENCE 
 { 
  latitude [1] PrintableString (SIZE(7..10)), 
   -- format: XDDMMSS.SS 
  longitude [2] PrintableString (SIZE(8..11)), 
   -- format: XDDDMMSS.SS 
  mapDatum [3] MapDatum DEFAULT wGS84, 
  ..., 
  azimuth  [4] INTEGER (0..359) OPTIONAL 
   -- The azimuth is the bearing, relative to true north 
 }, 
  -- format:  XDDDMMSS.SS 
  --   X   : 
N(orth), S(outh), E(ast), W(est)   --   DD or DDD  : degrees (numeric characters) 
  --   MM   : minutes (numeric characters) 
  --   SS.SS   : seconds, the second part (.SS) is optional 
  -- Example: 
  --   latitude short form  N502312 
  --   longitude long form  E1122312.18 
  utmCoordinates  [2] SEQUENCE 
 { 
  utm-East  [1] PrintableString (SIZE(10)), 
  utm-North  [2] PrintableString (SIZE(7)), 
   -- Universal Transverse Mercator 
   -- example utm-East 32U0439955 
   --    utm-North 5540736 
  mapDatum [3] MapDatum DEFAULT wGS84, 
  ..., 
  azimuth  [4] INTEGER (0..359) OPTIONAL 
   -- The azimuth is the bearing, relative to true north 
 }, 
  utmRefCoordinates [3] SEQUENCE 
 { 
  utmref-string [2] PrintableString (SIZE(13)), 
  mapDatum  [3] MapDatum DEFAULT wGS84, 
  ... 
 }, 
  -- example 32UPU91294045 
  wGS84Coordinates  [4] OCTET STRING 
 -- format is as defined in 3GPP TS 03.32 [57] 
}  MapDatum ::= ENUMERATED {  wGS84(0),   -- World Geodetic System 1984 
 wGS72(1),  eD50(2),   -- European Datum 50 
 ... 
}  UMTSLocation ::= CHOICE {  point     [1] GA-Point, 
 pointWithUnCertainty [2] GA-PointWithUnCertainty, 
 polygon     [3] GA-Polygon, 
 ... 
}  GeographicalCoordinates ::= SEQUENCE {  latitudeSign [0] ENUMERATED 
 { 
  north(0),   south(1)  }, 
 latitude  [1] INTEGER (0..8388607), 
 longitude  [2] INTEGER (-8388608..8388607), 
 ... 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)90 GA-Point ::= SEQUENCE {  geographicalCoordinates  [0] GeographicalCoordinates, 
 ... 
}  GA-PointWithUnCertainty ::=SEQUENCE {  geographicalCoordinates  [0] GeographicalCoordinates, 
 uncertaintyCode    [1] INTEGER (0..127) 
}  maxNrOfPoints INTEGER ::= 15  GA-Polygon ::= SEQUENCE (SIZE (1..maxNrOfPoints)) OF  SEQUENCE 
 { 
  geographicalCoordinates  [0] GeographicalCoordinates, 
  ... 
 } 
 CallContentLinkCharacteristics ::= SEQUENCE {  cCLink-State   [1] CCLink-State OPTIONAL, 
  -- current state of the CCLink 
 release-Time   [2] TimeStamp OPTIONAL, 
  -- date and time of the release of the Call Content Link. 
 release-Reason   [3] OCTET STRING (SIZE(2)) OPTIONAL, 
  -- Release cause coded in Q.850 [31] format 
 lEMF-Address   [4] CalledPartyNumber OPTIONAL, 
  -- Directory number used to route the call toward the LEMF 
 ... 
}  CCLink-State ::= ENUMERATED {  setUpInProcess(1),   -- The set-up of the call is in process 
 callActive(2),  callReleased(3),  lack-of-resource(4),   -- The lack-of-resource state is sent when a CC Link cannot 
  -- be established because of lack of resource at the MF level. 
 ... 
}  Intercepted-Call-State ::= ENUMERATED {  idle(1),   -- When the intercept call is released, the state is IDLE and the reason is provided 
  -- by the release-Reason-Of-Intercepted-Call parameter. 
 setUpInProcess(2),   -- The set-up of the call is in process 
 connected(3),   -- The answer has been received 
 ... 
}  Services-Information ::= SEQUENCE {  iSUP-parameters    [1] ISUP-parameters OPTIONAL, 
 dSS1-parameters-codeset-0 [2] DSS1-parameters-codeset-0 OPTIONAL, 
 ..., 
 mAP-parameters    [3] MAP-parameters OPTIONAL 
}    ETSI ETSI TS 101 671 V3.5
.1 (2009
-11)91 ISUP-parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one additional ISUP parameter TLV coded not already defined in 
 -- the previous parameters. The Tag value is the one given in EN 300 356 [5]. 
  -- In version 1 of the present document "iSUP-parameters" is defined as mandatory. 
 -- It might occur that no ISUP parameter is available. In that case in a version 1 
 -- implementation the value "zero" may be included in the first octet string of the SET. 
  -- The Length and the Value are coded in accordance with the parameter definition in 
 -- EN 300 356 [5]. Hereafter are listed the main parameters. 
 -- However other parameters may be added: 
  -- Transmission medium requirement: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Transmission medium requirement prime: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
 DSS1-parameters-codeset-0 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-0. The parameter is coded as 
 -- described in EN 300 403-1 [6] (The DSS1 Information element identifier and the DSS1 length 
 -- are included). Hereafter are listed the main parameters. 
 -- However other parameters may be added: 
  -- Bearer capability: this parameter may be repeated. Format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
  -- High Layer Compatibility: this parameter may be repeated. Format defined in EN 300 403-1 [6] 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
  -- Low Layer capability: this parameter may be repeated. Format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
 MAP-parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE(1..256))  -- Each "OCTET STRING" contains one MAP parameter. The parameter is coded as described in 
 -- TS GSM 09.02 [32] (The map-TS-Code is included). 
 Supplementary-Services ::= SEQUENCE {  standard-Supplementary-Services  [1] Standard-Supplementary-Services OPTIONAL, 
 non-Standard-Supplementary-Services [2] Non-Standard-Supplementary-Services OPTIONAL,  other-Services      [3] Other-Services OPTIONAL, 
 ... 
}  Standard-Supplementary-Services ::= SEQUENCE {  iSUP-SS-parameters    [1] ISUP-SS-parameters OPTIONAL, 
 dSS1-SS-parameters-codeset-0 [2] DSS1-SS-parameters-codeset-0 OPTIONAL, 
 dSS1-SS-parameters-codeset-4 [3] DSS1-SS-parameters-codeset-4 OPTIONAL, 
 dSS1-SS-parameters-codeset-5 [4] DSS1-SS-parameters-codeset-5 OPTIONAL, 
 dSS1-SS-parameters-codeset-6 [5] DSS1-SS-parameters-codeset-6 OPTIONAL, 
 dSS1-SS-parameters-codeset-7 [6] DSS1-SS-parameters-codeset-7 OPTIONAL, 
 dSS1-SS-Invoke-components  [7] DSS1-SS-Invoke-Components OPTIONAL, 
 mAP-SS-Parameters    [8] MAP-SS-Parameters OPTIONAL, 
 mAP-SS-Invoke-Components  [9] MAP-SS-Invoke-Components OPTIONAL, 
 ... 
}  Non-Standard-Supplementary-Services ::= SET SIZE (1..20) OF CHOICE {  simpleIndication  [1] SimpleIndication, 
 sciData     [2] SciDataMode, 
 ... 
}  Other-Services ::= SET SIZE (1..50) OF OCTET STRING (SIZE (1..256))  -- Reference manufacturer manuals. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)92 ISUP-SS-parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- It must be noticed this parameter is retained for compatibility reasons. 
 -- It is recommended not to use it in new work but to use ISUP-parameters parameter. 
  -- Each "OCTET STRING" contains one additional ISUP parameter TLV coded not already defined in 
 -- the previous parameters. The Tag value is the one given in EN 300 356 [5]. 
 -- The Length and the Value are coded in accordance with the parameter definition in  
 -- EN 300 356 [5]. Hereafter are listed the main parameters.  
 -- However other parameters may be added: 
  -- Connected Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- RedirectingNumber: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "originating party" 
 -- or/and of the ﬁterminating partyﬂ. 
  -- Original Called Party Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "originating party". 
  -- Redirection information: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "originating party", "forwarded to party" or/and "Terminating party". 
  -- Redirection Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "forwarded to party" or "Terminating party". 
  -- Call diversion information: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "forwarded to party" or "Terminating party". 
  -- Generic Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
 -- This parameters are used to transmit additional identities (additional, calling party 
 -- number, additional called number, etc.). 
  -- Generic Notification: format defined in EN 300 356 [5]. 
 -- This parameter may be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
 -- This parameters transmit the notification to the other part of the call of the supplementary 
 -- services activated or invoked by a subscriber during the call. 
  -- CUG Interlock Code: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)93 DSS1-SS-parameters-codeset-0 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-0. The parameter is coded as 
 -- described in EN 300 403-1 [6] (The DSS1 Information element identifier and the DSS1 length 
 -- are included). Hereafter are listed the main parameters. 
 -- However other parameters may be added: 
  -- Calling Party Subaddress: format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Called Party Subaddress: format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Connected Subaddress: format defined in recommendation (see EN 300 097-1 [14]). 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- Connected Number: format defined in recommendation (see EN 300 097-1 [14]). 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- Keypad facility: format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
  -- Called Party Number: format defined in EN 300 403-1 [6]. 
 -- This parameter could be provided with the "Party Information" of the "calling party" 
 -- when target is the originating party; it contains the dialled digits before modification 
 -- at network level (e.g. IN interaction, translation, etc –). 
  -- User-user: format defined in EN 300 286-1 [23]). 
 -- This parameter can be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
 DSS1-SS-parameters-codeset-4 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-4. The parameter is coded as 
 -- described in the relevant recommendation. 
 DSS1-SS-parameters-codeset-5 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-5. The parameter is coded as 
 -- described in the relevant national recommendation. 
 DSS1-SS-parameters-codeset-6 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-6. The parameter is coded as 
 -- described in the relevant local network recommendation. 
 DSS1-SS-parameters-codeset-7 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "octet string" contains one DSS1 parameter of the codeset-7. The parameter is coded as 
 -- described in the relevant user specific recommendation. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)94 DSS1-SS-Invoke-Components ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "octet string" contains one DSS1 Invoke or Return Result component. 
 -- The invoke or return result component is coded as 
 -- described in the relevant DSS1 supplementary service recommendation. 
  -- Invoke or Return Result component (BeginCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (AddCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (SplitCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (DropCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (IsolateCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (ReattachCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (PartyDISC): EN 300 185-1 [19] 
 -- Invoke or Return Result component (MCIDRequest): EN 300 130-1 [16] 
 -- Invoke or Return Result component (Begin3PTY): EN 300 188-1 [20] 
 -- Invoke or Return Result component (End3PTY): EN 300 188-1 [20] 
 -- Invoke or Return Result component (ECTExecute): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTInform): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTLinkIdRequest): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTLoopTest): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ExplicitECTExecute): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECT: RequestSubaddress): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECT: SubaddressTransfer): EN 300 369-1 [25] 
 -- Invoke or Return Result component (CF: ActivationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DeactivationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: ActivationStatusNotification): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DeactivationStatusNotification): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: InterrogationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: InterrogationServedUserNumber): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DiversionInformation): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: CallDeflection): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: CallRerouteing): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation1): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation2): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation3): EN 300 207-1 [21] 
 -- other invoke or return result components ... 
 MAP-SS-Invoke-Components ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "octet string" contains one MAP Invoke or Return Result component. 
 -- The invoke or return result component is coded as 
 -- described in the relevant MAP supplementary service recommendation. 
 MAP-SS-Parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "octet string" contains one MAP Parameter. The parameter is coded as 
 -- described in the relevant MAP supplementary service recommendation. 
 SimpleIndication ::= ENUMERATED {  call-Waiting-Indication(0),   -- The target has received a call waiting indication for this call 
 add-conf-Indication(1),   -- this call has been added to a conference 
 call-on-hold-Indication(2),   -- indication that this call is on hold 
 retrieve-Indication(3),   -- indication that this call has been retrieved 
 suspend-Indication(4),   -- indication that this call has been suspended 
 resume-Indication(5),   -- indication that this call has been resumed 
 answer-Indication(6),   -- indication that this call has been answered 
 ... 
}  SciDataMode ::= OCTET STRING (SIZE (1..256))    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)95 SMS-report ::= SEQUENCE {  communicationIdentifier  [1] CommunicationIdentifier, 
  -- used to uniquely identify an intercepted call: the same used for the 
  -- relevant IRI 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671 [i.5] 
 timeStamp     [2] TimeStamp, 
  -- date and time of the report. The format is 
  -- the one defined in case a) of the ASN.1 ITU-T Recommendation X.680 [33]. 
  -- (year month day hour minutes seconds) 
 sMS-Contents    [3] SEQUENCE 
 { 
  initiator   [1] ENUMERATED 
  { 
   -- party which sent the SMS 
   target(0),    server(1),    undefined-party(2),    ... 
  }, 
  transfer-status  [2] ENUMERATED 
  { 
   succeed-transfer(0),     --the transfer of the SMS message succeeds 
   not-succeed-transfer(1),    undefined(2),    ... 
  } OPTIONAL, 
  other-message  [3] ENUMERATED 
  { 
   -- In case of terminating call, indicates if the server will send other SMS. 
   yes(0),    no(1),    undefined(2),    ... 
  } OPTIONAL, 
  content    [4] OCTET STRING (SIZE (1..270)) OPTIONAL, 
   -- Encoded in the format defined for the SMS mobile. 
  ... 
 } 
}  LawfulInterceptionIdentifier ::= OCTET STRING (SIZE (1..25))  -- It is recommended to use ASCII characters in "a"–"z", "A"–"Z", "-", "_", ".", and "0"–"9". 
 -- For subaddress option only "0"..."9" shall be used. 
 National-Parameters ::= SET SIZE (1..40) OF OCTET STRING (SIZE (1..256))  -- Content defined by national law. 
 GPRSCorrelationNumber ::= OCTET STRING (SIZE(8..20))  GPRSEvent ::= ENUMERATED  -- see 3GPP TS 03.33 [42] 
{  pDPContextActivation(1),  startOfInterceptionWithPDPContextActive(2),  pDPContextDeactivation(4),  gPRSAttach(5),  gPRSDetach(6),  cellOrRAUpdate(10),  sMS(11),  ..., 
 pDPContextModification(13) }  Services-Data-Information ::= SEQUENCE {  gPRS-parameters  [1] GPRS-parameters OPTIONAL, 
 ... 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)96 GPRS-parameters ::= SEQUENCE {  pDP-address-allocated-to-the-target  [1] DataNodeAddress OPTIONAL, 
 aPN          [2] OCTET STRING (SIZE(1..100)) OPTIONAL, 
  -- The Access Point Name (APN) is coded in accordance with 
  -- 3GPP TS 24.008 [41] without the APN IEI (only the last 100 octets are used).
   -- Octets are coded according to 3GPP TS 23.003 [76]. 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 pDP-type         [3] OCTET STRING (SIZE(2)) OPTIONAL, 
 ... 
}  GPRSOperationErrorCode ::= OCTET STRING (SIZE(2))  -- Refer to 3GPP TS 24.008 [41] for values (GMM cause or SM cause parameter). 
 DataNodeAddress ::= CHOICE {  ipAddress  [1] IPAddress, 
 x25Address  [2] X25Address,  ... 
}  IPAddress ::= SEQUENCE {  iP-type   
[1] ENUMERATED  { 
  iPV4(0),   iPV6(1),   ... 
 }, 
 iP-value  [2] IP-value,  iP-assignment 
[3] ENUMERATED  { 
  static
(1),    -- The static coding shall be used to report a static address. 
  dynamic
(2),    -- The dynamic coding shall be used to report a dynamically allocated address. 
  notKnown
(3),    -- The notKnown coding shall be used to report other then static or dynamically 
   -- allocated IP addresses. 
  ... 
 } OPTIONAL, 
 ... 
}  IP-value ::= CHOICE {  iPBinaryAddress [1] OCTET STRING (SIZE(4..16)),  iPTextAddress [2] IA5String (SIZE(7..45)), 
 ... 
}  X25Address ::= OCTET STRING (SIZE(1..25))  National-HI2-ASN1parameters ::= SEQUENCE {  countryCode  [1] PrintableString (SIZE (2)), 
  -- Country Code according to ISO 3166-1 [67], 
  -- the country to which the parameters inserted after the extension marker apply. 
 ... 
  -- In case a given country wants to use additional national parameters according to its law, 
  -- these national parameters should be defined using the ASN.1 syntax and added after the 
  -- extension marker (...). 
  -- It is recommended that "version parameter" and "vendor identification parameter" are 
  -- included in the national parameters definition. Vendor identifications can be 
  -- retrieved from the IANA web site (see annex J). Besides, it is recommended to avoid 
  -- using tags from 240 to 255 in a formal type definition. 
}  END -Œ end of HI2Operations    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)97 D.6 User data packet transfer (HI3 CS) 
Declaration of ROSE operations "circuit-Call-related-Se
rvices" and "no-Circuit-Call-related-Services" are ROSE 
delivery mechanism specific. When using FTP delivery mechanism, data Content-Report must be considered. 
ASN.1 description of circuit data tr
ansfer operation (HI3 interface) 
HI3CircuitDataOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) circuitLI(1) version3(3)}  DEFINITIONS IMPLICIT TAGS ::=  -- The following operations are used to transmit user data which can be exchanged via the DSS1, ISUP 
-- or MAP signalling (e.g. UUS, SMS).  BEGIN  IMPORTS OPERATION,  ERROR   FROM 
Remote-Operations-Information-Objects   {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)} 
  -- from clause D.5 
 LawfulInterceptionIdentifier,  CommunicationIdentifier,  TimeStamp,  OperationErrors,  Supplementary-Services,  SMS-report   FROM 
HI2Operations   {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) 
version10(10)};  -- ============================= -- Object Identifier definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi3 Domain hi3CircuitLIId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi3(2) circuitLI(1)} hi3CircuitLIOperationId OBJECT IDENTIFIER ::= {hi3CircuitLIId version3(3)}  circuit-Call-related-Services OPERATION ::= 
{  ARGUMENT Content-Report 
 ERRORS  {OperationErrors} 
 CODE  global:{hi3CircuitLIId circuit-Call-Serv(1) version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s. -- NOTE: The same note as for HI management operation applies.  no-Circuit-Call-related-Services OPERATION ::= 
{  ARGUMENT Content-Report 
 ERRORS  {OperationErrors} 
 CODE  global:{hi3CircuitLIId no-Circuit-Call-Serv(2) version1(1)} 
} -- Class 2 operation. The timer must be set to a value between 10s and 120s. -- The timer default value is 60s.    ETSI ETSI TS 101
 671 V3.5.1 (2009
-11)98 Content-Report ::= SEQUENCE {  domainID      [0] OBJECT IDENTIFIER (hi3CircuitLIOperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 lawfulInterceptionIdentifier [6] LawfulInterceptionIdentifier OPTIONAL, 
 communicationIdentifier   [1] CommunicationIdentifier, 
  -- Used to uniquely identify an intercepted call: the same as used for the relevant IRI. 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671 [i.5] 
 timeStamp      [2] TimeStamp, 
 initiator      [3] ENUMERATED 
 { 
  originating-party(0),   terminating-party(1),   forwarded-to-party(2),   undefined-party(3),   ... 
 } OPTIONAL, 
 content       [4] Supplementary-Services OPTIONAL, 
  -- UUI are encoded in the format defined for the User-to-user information parameter 
  -- of the ISUP protocol (see EN 300 356 [5]). Only one UUI parameter is sent per message. 
 sMS-report      [5] SMS-report OPTIONAL, 
 ... 
}  END -Œ end of HI3CircuitDataOperations  D.7 TETRA data transfer (HI3 interface) 
Clauses A.4.1.1, A.4.2.1 and A.9 apply. 
D.8 Definition of the UUS1 content associated to the CC 
link 
ASN.1 description of the UUS1 content associated to the CC link 
HI3CCLinkData {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) cclinkLI(4) version4(4)}  DEFINITIONS IMPLICIT TAGS ::=  BEGIN  IMPORTS  -- from clause D.5 
 LawfulInterceptionIdentifier,  CommunicationIdentifier,  CC-Link-Identifier   FROM 
HI2Operations   {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) 
version10(10)};  -- ============================= -- Object Identifier Definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi3 Domain hi3CCLinkId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi3(2) ccLinkLI(4)} hi3CCLinkIdOperationId OBJECT IDENTIFIER ::= {hi3CCLinkId version4(4)}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)99 UUS1-Content ::= SEQUENCE {  domainID       [0] OBJECT IDENTIFIER (hi3CCLinkIdOperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 lawfullInterceptionIdentifier  [1] LawfulInterceptionIdentifier, 
 communicationIdentifier    [2] CommunicationIdentifier, 
 cC-Link-Identifier     [3] CC-Link-Identifier OPTIONAL, 
 direction-Indication    [4] Direction-Indication, 
 bearer-capability     [5] OCTET STRING (SIZE(1..12)) OPTIONAL, 
  -- transport the Bearer capability information element (value part) 
  -- Protocol: EN 300 403-1 [6] 
 service-Information
     [7] Service-Information OPTIONAL,
  ... 
}  -- ================== -- PARAMETERS FORMATS -- ==================  Direction-Indication ::= ENUMERATED {  mono-mode(0),  cc-from-target(1),  cc-from-other-party(2),  ..., 
 direction-unknown(3) }  Service-Information ::= SET {  high-layer-capability [0] OCTET STRING (SIZE(1)) OPTIONAL, 
  -- HLC (octet 4 only) 
  -- Protocol: EN 300 403-1 [6] 
 tMR      [1] OCTET STRING (SIZE(1)) OPTIONAL, 
  -- Transmission Medium Requirement 
  -- Protocol: ISUP EN 300 356 [5] 
 bearerServiceCode   [2] OCTET STRING (SIZE(1)) OPTIONAL, 
 teleServiceCode   [3] OCTET STRING (SIZE(1)) OPTIONAL 
  -- from MAP, TS GSM 09.02 [32] 
}  END -Œ end of HI3CCLinkData  D.9 Content of Communication (HI3 GPRS) 
ASN.1 description of the GPRS content 
Gprs-HI3-PS 
{itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) gPRSLI(3) version3(3)}  DEFINITIONS IMPLICIT TAGS ::=  BEGIN  IMPORTS  -- from 3GPP TS 33.108 [61] 
 CC-PDU   FROM 
Umts-HI3-PS   {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulintercept(2) 
threeGPP(4) hi3(2) r7(7) version-0(0)};    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)100 -- ============================= -- Object Identifier definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi3 Domain hi3GPRSLIId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi3(2) gPRSLI(3)} hi3GPRSLIIdOperationId OBJECT IDENTIFIER ::= {hi3GPRSLIId version3(3)}  ETSI-CC-PDU ::= SEQUENCE {  domainID   [0] OBJECT IDENTIFIER (hi3GPRSLIIdOperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 eTSI-CC-PDU   [1]
 CC-PDU,  ... 
}  END -Œ end of Gprs-HI3-PS  D.10 TETRA ASN.1 details 
Details for: 
• HI management. 
• HI1. 
• HI2. 
D.10.1 HI management operation 
This data description applies only for ROSE delivery mechanism. 
ASN.1 description of HI management operation (any HI interface) 
TETRA-HIManagementOperations  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulintercept(2) tetra(6) him(3) version0(0)}  DEFINITIONS IMPLICIT TAGS ::= BEGIN  IMPORTS     OPERATION, 
 ERROR    FROM 
Remote-Operations-Information-Objects    {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)}; 
 tETRA-sending-of-Password  OPERATION ::=  
{  ARGUMENT TETRA-Password-Name 
 ERRORS  {ErrorsHim} 
 CODE  global:{himDomainId sending-of-Password(1) version1(1)} 
} -- Class 2 operation. The timer must be set to a value between 3 s and 240s -- The timer default value is 60s  tETRA-data-Link-Test   OPERATION ::= 
{  ERRORS   {other-failure-causes} 
 CODE  global:{himDomainId data-link-test(2) version1(1)} 
} -- Class 2 operation. The timer must be set to a value between 3s and 240s -- The timer default value is 60s    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)101 tETRA-end-Of-Connection  OPERATION ::= 
{  ERRORS  {other-failure-causes} 
 CODE  global:{himDomainId end-of-connection(3) version1(1)} 
} -- Class 2 operation. The timer must be set to a value between 3s and 240s -- The timer default value is 60s  other-failure-causes ERROR ::= {CODE local:0} 
missing-parameter  ERROR ::= {CODE local:1} 
unknown-parameter  ERROR ::= {CODE local:2} 
erroneous-parameter  ERROR ::= {CODE local:3} 
 ErrorsHim    
ERROR ::=  {  other-failure-causes |  
 missing-parameter |  
 unknown-parameter |  
 erroneous-parameter  
}  -- ============================= -- Object Identifier Definitions -- =============================  -- himDomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- Security Subdomains tETRADomainId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId tETRA(6)} himDomainId OBJECT IDENTIFIER  ::= {tETRADomainId him(3) version0(0)}  TETRA-Password-Name   ::= SEQUENCE  
{  password [1] OCTET STRING (SIZE (1..25)), 
 name  [2] OCTET STRING (SIZE (1..25)), 
 ... 
}  -- IA5 string recommended 
 END -- end of TETRA-HIManagementOperations   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)102 D.10.2 LI management notification 
Declaration of ROSE operation "sending-of-HI1-Notification"
 is ROSE delivery mechanism specific. When using FTP 
delivery mechanism, data HI1-Operation must be considered. 
NOTE: This annex does not describe an electronic Handover Interface, but HI1 information, which is sent to the 
LEMF across the HI2 port. 
ASN.1 description of LI management not
ification operation (HI1 interface) 
TETRA-HI1NotificationOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) tetra(6) hi1(1) notificationOperations(1) version0(0)}  DEFINITIONS IMPLICIT TAGS ::= BEGIN  IMPORTS  OPERATION,  ERROR   FROM 
Remote-Operations-Information-Objects   {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)} 
  -- from clause D.5 
 CommunicationIdentifier,  TimeStamp,  LawfulInterceptionIdentifier   FROM HI2Operations 
  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) 
version10(10)}   -- from ETSI EN 301 040 [72] 
 TETRACGIType   FROM 
EN301040   {itu-t(0) identified-organization(4) etsi(0) en301040(1040) interceptVersion(0)}; 
 -- ============================= -- Object Identifier Definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi1 Domain tETRADomainId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId tETRA(6)} hi1OperationId OBJECT IDENTIFIER ::= {tETRADomainId hi1(1) notificationOperations(1) version0(0)}  sending-of-HI1-Notification  OPERATION ::= 
{  ARGUMENT HI1-Operation 
 ERRORS  {ErrorHI1Notifications} 
 CODE  global:{tETRADomainId version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s. -- NOTE: The value for this timer is to be set on the equipment waiting for the returned message; -- its value shall be agreed between the NWO/AP/SvP and the LEA, depending on their equipment -- properties.  other-failure-causes ERROR ::= {CODE local:0} 
missing-parameter  ERROR ::= {CODE local:1} 
unknown-parameter  ERROR ::= {CODE local:2} 
erroneous-parameter  ERROR ::= {CODE local:3} 
 ErrorHI1Notifications ERROR ::= {  other-failure-causes | 
 missing-parameter | 
 unknown-parameter | 
 erroneous-parameter 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)103 HI1-Operation  ::= CHOICE 
{  liActivated      [1] Notification, 
 liDeactivated     [2] Notification, 
 liModified      [3] Notification, 
 alarms-indicator    [4] Alarm-Indicator, 
 ..., 
 national-HI1-ASN1parameters
  [5] National-HI1-ASN1parameters 
}  -- ================== -- PARAMETERS FORMATS -- ==================  Notification  ::= SEQUENCE 
{  domainID      [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 lawfulInterceptionIdentifier  [1] LawfulInterceptionIdentifier, 
  -- This identifier is the LIID identity provided with the lawful authorization 
  -- for each target. 
 communicationIdentifier   [2] CommunicationIdentifier OPTIONAL, 
  -- Only the NWO/PA/SvPIdentifier is provided (the one provided with the Lawful 
  -- authorization) 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671 
 timeStamp      [3] TimeStamp, 
  -- date and time of the report 
 location      [4] TETRACGIType OPTIONAL, 
  -- only a valid location can be provided at the time of the notification 
 ..., 
 national-HI1-ASN1parameters
  [5] National-HI1-ASN1parameters OPTIONAL 
}  Alarm-Indicator  ::= SEQUENCE 
{  domainID      [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 communicationIdentifier   [1] CommunicationIdentifier OPTIONAL, 
  -- Only the NWO/PA/SvPIdentifier is provided (the one provided with the 
  -- Lawful authorization) 
 timeStamp      [2] TimeStamp, 
  -- date and time of the report 
 alarm-information    [3] OCTET STRING (SIZE (1..25)), 
  -- Provides information about alarms (free format) 
 ..., 
 lawfulInterceptionIdentifier [4] LawfulInterceptionIdentifier OPTIONAL, 
  -- This identifier is the LIID identity provided with the lawful authorization 
  -- for each target in according to national law 
 national-HI1-ASN1parameters
  [5] National-HI1-ASN1parameters OPTIONAL 
}  National-HI1-ASN1parameters  ::= SEQUENCE 
{  domainID  [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 countryCode  [1] PrintableString (SIZE (2)), 
  -- Country Code according to ISO 3166-1 [67], 
  -- the country to which the parameters inserted after the extension marker apply. 
 ... 
  -- In case a given country wants to use additional national parameters according to its law, 
  -- these national parameters should be defined using the ASN.1 syntax and added after the 
  -- extension marker (...). 
  -- It is recommended that "version parameter" and "vendor identification parameter" are 
  -- included in the national parameters definition. Vendor identifications can be 
  -- retrieved from IANA web site (see annex J). Besides, it is recommended to avoid 
  -- using tags from 240 to 255 in a formal type definition. 
}  END -Œ end of TETRA-HI1NotificationOperations   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)104 D.10.3 HI2 definitions 
The ASN.1 (ITU-T Recommendation X.680 [33]) module that represents the information in the present document and 
meets all stated requirements is shown below: 
TETRA-HI2Operations  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) tetra(6) hi2(2) version0(0)}  DEFINITIONS IMPLICIT TAGS ::=  
BEGIN  IMPORTS    OPERATION, 
 ERROR 
  FROM Remote-Operations-Information-Objects   {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)}   -- 
from 3GPP TS 33.108 [61]  UmtsQos, 
 IMSevent, 
 LDIevent, 
 CorrelationValues 
  FROM UmtsHI2Operations   {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulintercept(2) threeGPP(4) hi2(1) r7(7) version-3(3)}   -- from TS 101 909-20-01 [69]  TARGETACTIVITYMONITOR-1 
  FROM TS101909201   {itu-t(0) identified-organization(4) etsi(0) ts101909(1909) part20(20) subpart1(1) interceptVersion(0)}   -- from EN 301 040 [72]  TARGETACTIVITYMONITORind, 
 TARGETCOMMSMONITORind, 
 TTRAFFICind, 
 TETRAAddressType, 
 CTTRAFFICind 
  FROM EN301040   {itu-t(0) identified-organization(4) etsi(0) en301040(1040) interceptVersion(0)};  tetra-sending-of-IRI  OPERATION ::=  {  ARGUMENT TETRAIRIsContent 
 ERRORS  {OperationErrors} 
 CODE  global:{tETRADomainId hi2(1) opcode(1)} 
}  -- Class 2 operation . The timer shall be set to a value between 3s and 240s 
 -- The timer.default value is 60s 
 -- NOTE: The same note as for HI management operation applies 
 TETRAIRIsContent  ::= CHOICE 
{  tetraiRIContent   TetraIRIContent
,  tetraIRISequence  TetraIRISequence 
}  TetraIRISequence  ::= SEQUENCE OF TetraIRIContent 
 -- Aggregation of UmtsIRIContent is an optional feature. -- It may be applied in cases when at a given point in time -- several IRI records are available for delivery to the same LEA destination. -- As a general rule, records created at any event shall be sent -- immediately and not withheld in the DF or MF in order to -- apply aggragation. -- When aggregation is not to be applied,   -- UmtsIRIContent needs to be chosen.    ETSI ETSI TS 101 671 V3.5.1
 (2009
-11)105 -- ============================= -- Object Identifier Definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi1 Domain tETRADomainId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId tETRA(6)} hi2OperationId OBJECT IDENTIFIER ::= {tETRADomainId hi2(2) version0(0)}  TetraIRIContent  ::= CHOICE  
{  iRI-Begin-record  [1] Tetra-IRI-Parameters, 
  -- include at least one optional parameter 
 iRI-End-record   [2] Tetra-IRI-Parameters, 
 iRI-Continue-record  [3] Tetra-IRI-Parameters, 
  -- include at least one optional parameter 
 iRI-Report-record  [4] Tetra-IRI-Parameters 
  -- include at least one optional parameter 
}  unknown-version   ERROR ::= {CODE local:0} 
missing-parameter  ERROR ::= {CODE local:1} 
unknown-parameter-value ERROR ::= {CODE local:2} unknown-parameter  ERROR ::= {CODE local:3} 
 OperationErrors   ERROR ::=  {  unknown-version |  
 missing-parameter |  
 unknown-parameter-value |  
 unknown-parameter  
}  -- This values may be sent by the LEMF, when an operation or a parameter is misunderstood 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)106 Tetra-IRI-Parameters  ::= SEQUENCE  
{  domainID       [0] OBJECT IDENTIFIER (hi2OperationId) OPTIONAL, 
  -- for the sending entity the inclusion of the Object Identifier is mandatory 
 iRIversion       [23] ENUMERATED 
 { 
  version0(0),   ... 
 } OPTIONAL, 
  -- if not present, it means version 1 is handled 
 lawfulInterceptionIdentifier  [1] LawfulInterceptionIdentifier, 
  -- This identifier is associated to the target 
 communicationIdentifier    [2] CommunicationIdentifier, 
  -- used to uniquely identify an intercepted call 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671 [i.5] 
 timeStamp       [3] TimeStamp, 
  -- date and time of the event triggering the report 
 intercepted-Call-Direct    [4] ENUMERATED 
 { 
  not-Available(0),   originating-Target(1),    -- In case of GPRS, this indicates that the PDP context activation, modification 
   -- or deactivation is MS requested 
  terminating-Target(2),    -- In case of GPRS, this indicates that the PDP context activation, modification 
   -- or deactivation is network initiated 
  ... 
 } OPTIONAL, 
 intercepted-Call-State    [5] Intercepted-Call-State OPTIONAL, 
 ringingDuration      [6] OCTET STRING (SIZE (3)) OPTIONAL, 
  -- Duration in seconds. BCD coded : HHMMSS 
 conversationDuration    [7] OCTET STRING (SIZE (3)) OPTIONAL, 
  -- Duration in seconds. BCD coded : HHMMSS 
 locationOfTheTarget     [8] Location OPTIONAL, 
  -- location of the target subscriber 
 partyInformation     [9] SET SIZE (1..10) OF PartyInformation OPTIONAL, 
  -- This parameter provides the concerned party (Originating, Terminating or forwarded 
  -- party), the identity(ies) of the party and all the information provided by the party 
 callContentLinkInformation   [10] SEQUENCE 
 { 
  cCLink1Characteristics [1] CallContentLinkCharacteristics OPTIONAL, 
   -- Information concerning the Content of Communication Link Tx channel established 
   -- toward the LEMF (or the sum signal channel, in case of mono mode) 
  cCLink2Characteristics [2] CallContentLinkCharacteristics OPTIONAL, 
   -- Information concerning the Content of Communication Link Rx channel established 
   -- toward the LEMF 
  ... 
 } OPTIONAL, 
 release-Reason-Of-Intercepted-Call [11] OCTET STRING (SIZE (2)) OPTIONAL, 
  -- Release cause coded in ITU-T Q.850 [31] format. 
  -- This parameter indicates the reason why the intercepted call cannot be established or 
  -- why the intercepted call has been released after the active phase. 
 nature-Of-The-intercepted-call  [12] ENUMERATED 
 { 
  -- Nature of the intercepted "call": 
  gSM-ISDN-PSTN-circuit-call(0),    -- the possible UUS content is sent through the HI2 or HI3 "data" interface 
   -- the possible call content call is established through the HI3 "circuit" interface 
  gSM-SMS-Message(1),    -- the SMS content is sent through the HI2 or HI3 "data" interface 
  uUS4-Messages(2),    -- the UUS content is sent through the HI2 or HI3 "data" interface 
  tETRA-circuit-call(3),    -- the possible call content call is established through the HI3 "circuit" interface 
   -- the possible data are sent through the HI3 "data" interface 
  teTRA-Packet-Data(4),    -- the data are sent through the HI3 "data" interface 
  gPRS-Packet-Data(5),    -- the data are sent through the HI3 "data" interface 
  ..., 
  uMTS-circuit-call(6)    -- the possible call content call is established through the HI3 "circuit" interface 
   -- the possible data are sent through the HI3 "data" interface 
  } OPTIONAL, 
 serverCenterAddress     [13] PartyInformation OPTIONAL, 
  -- e.g. in case of SMS message this parameter provides the address of the relevant 
  -- server within the calling (if server is originating) or called 
  -- (if server is terminating) party address parameters 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)107  sMS         [14] SMS-report OPTIONAL, 
  -- this parameter provides the SMS content and associated information 
 cC-Link-Identifier   
  [15] CC-Link-Identifier OPTIONAL, 
  -- Depending on a network option, this parameter may be used to identify a CC link 
  -- in case of multiparty calls. 
 national-Parameters     [16] National-Parameters OPTIONAL, 
 gPRSCorrelationNumber    [18] GPRSCorrelationNumber OPTIONAL, 
 gPRSevent        [20] GPRSEvent OPTIONAL, 
  -- This information is used to provide particular action of the target 
  -- such as attach/detach 
 sgsnAddress       [21] DataNodeAddress OPTIONAL, 
 gPRSOperationErrorCode     [22] GPRSOperationErrorCode OPTIONAL, 
 ..., 
 ggsnAddress       [24] DataNodeAddress OPTIONAL, 
 qOS         [25] UmtsQos OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 networkIdentifier      [26] Network-Identifier OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 sMSOriginatingAddress     [27] DataNodeAddress OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 sMSTerminatingAddress     [28] DataNodeAddress OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 iMSevent        [29] IMSevent OPTIONAL, 
 sIPMessage        [30] OCTET STRING OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 servingSGSN-number      [31] OCTET STRING (SIZE (1..20)) OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 servingSGSN-address     [32] OCTET STRING (SIZE (5..17)) OPTIONAL, 
  -- Octets are coded according to TS 123 003 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 tARGETACTIVITYMONITOR     [33] TARGETACTIVITYMONITOR-1 OPTIONAL, 
  -- Parameter is used in TS 101 909-20-1 [69] 
 ldiEvent        [34] LDIevent OPTIONAL, 
  -- The "Location Dependent Interception" parameter is duplicated from 3GPP TS 33.108 [61]. 
 correlation       [35] CorrelationValues OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61] 
 tARGETACTIVITYMONITORind   [36] TARGETACTIVITYMONITORind OPTIONAL, 
  -- Parameter is used in EN 301 040 [72] 
 tARGETCOMMSMONITORind    [37] TARGETCOMMSMONITORind OPTIONAL, 
  -- Parameter is used in EN 301 040 [72] 
 tTRAFFICind       [38] TTRAFFICind OPTIONAL, 
  -- Parameter is used in EN 301 040 [72] 
 cTTRAFFICind       [39] CTTRAFFICind OPTIONAL, 
  -- Parameter is used in EN 301 040 [72] 
 tETRA-LI-Event       [40] TETRA-LI-Event OPTIONAL, 
 dMO-Indicator      [41] DMO-Indicator OPTIONAL, 
 tETRA-PartyInformation    [42] TETRAAddressType OPTIONAL, 
 tETRA-Other-PartyInformation  [43] TETRAAddressType OPTIONAL, 
 txGrantedStatus      [44] TxGrantedStatus OPTIONAL, 
 groupStatus       [45] GroupStatus OPTIONAL, 
 national-HI2-ASN1parameters   [255] National-HI2-ASN1parameters OPTIONAL 
}    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)108 -- ================= -- PARAMETER FORMATS -- =================  TETRA-LI-Event ::= ENUMERATED {  callSetupMobileOriginating(1),   -- Start of call, A party is target 
 callSetupMobileTerminating(2),   -- Start of call, B party is target 
 ringing(3),   -- Call reaches other party 
 queueing(4),   -- Call waiting at other party 
 connected(5),   -- Call established 
 handover(6),   -- Location change during call 
 callRelease(7),   -- Call is released 
 locationUpdate(8),   -- TETRA switch change while not in call 
 sDSMobileOriginating(9),   -- Target sends SDS 
 sDSMobileTerminating(10),   -- Target receives SDS 
 callForward(11),   -- Call forwarded to C party 
 callHold(12),   -- Call on hold 
 groupIndication(13),   -- Group indication action 
 txGranted(14),   -- Group talker tx granted 
 mobileOn(15),   -- Handset switched on 
 mobileOff(16),   -- Handset switched off 
 dMO(17),   -- Direct Mode Operation 
 ... 
}  DMO-Indicator ::= ENUMERATED {  dMOSTATETUNKNOWNC(0),  dMOSTATETTMOC(1),  dMOSTATETDMOC(2),  dMOSTATETIDLEDUALWATCHC(3),  dMOSTATETFULLDUALWATCHC(4),  dMOSTATETTXINHIBITC(5),  ... 
}  TxGrantedStatus ::= BOOLEAN  -- FALSE TxCeased, TRUE TxGranted 
 GroupStatus ::= BOOLEAN  -- FALSE when leaving group, TRUE when joining group 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)109 CommunicationIdentifier ::= SEQUENCE {  communication-Identity-Number  
[0] OCTET STRING (SIZE (1..8)) OPTIONAL,   -- Temporary Identifier of an intercepted call to uniquely identify an intercepted call   -- within the node. This parameter is mandatory if there is associated   -- information sent over HI3interface (CClink, data,..) or when   -- CommunicationIdentifier is used for IRI other than IRI-Report-record   -- This parameter was called "call-Identity-Number" in V1.1.1 of ES 201 671.   -- The individual digits of the communication-Identity-Number shall be represented in   -- ASCII format, e.g. "12345678" = 8 octets 0x31 0x32 0x33 0x34 0x35 0x36 0x37 0x38.  network-Identifier     
[1] Network-Identifier,  ... } -- NOTE: The same "CommunicationIdentifier" value is sent : -- with the HI3 information for correlation purpose between the IRI and the information sent on -- the HI3 interfaces (CCLink, data, ..) with each IRI associated to a same intercepted call -- for correlation purpose between the different IRI.  Network-Identifier ::= SEQUENCE {  operator-Identifier    
[0] OCTET STRING (SIZE (1..5)),   -- It is a notification of the NWO/AP/SvP in ASCII- characters   -- The parameter is mandatory  network-Element-Identifier  
[1] Network-Element-Identifier OPTIONAL,  ... }  Network-Element-Identifier ::= CHOICE {  e164-Format  
[1] OCTET STRING (SIZE (1..25)),   -- E164 address of the node in international format. Coded in the same format as the   -- calling party number parameter of the ISUP (parameter part: EN 300 356 [5])  x25-Format   
[2] OCTET STRING (SIZE (1..25)),   -- X25 address  iP-Format   
[3] OCTET STRING (SIZE (1..25)),   -- IP address  dNS-Format   
[4] OCTET STRING (SIZE (1..25)),   -- DNS address  ...,  iP-Address   
[5] IPAddress }  CC-Link-Identifier ::= OCTET STRING (SIZE (1..8))  -- Depending on a network option, this parameter may be used to identify a CClink  -- in case of multiparty calls.  -- The individual digits of the communication-Identity-Number shall be represented in  -- ASCII format, e.g. "12345678" = 8 octets 0x31 0x32 0x33 0x34 0x35 0x36 0x37 0x38.  TimeStamp ::= CHOICE {  -- The minimum resolution required is one second.  -- "Resolution" is the smallest incremental change that can be measured for time and  -- is expressed with a definite number of decimal digits or bits.  localTime  
[0] LocalTimeStamp,  utcTime   
[1] UTCTime }  LocalTimeStamp ::= SEQUENCE {  generalizedTime    
[0] GeneralizedTime,   -- The minimum resolution required is one second.   -- "Resolution" is the smallest incremental change that can be measured for time and   -- is expressed with a definite number of decimal digits or bits.  winterSummerIndication  
[1] ENUMERATED  {   notProvided
(0),   winterTime
(1),   summerTime
(2),   ...  } }    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)110 PartyInformation ::= SEQUENCE {  party-Qualifier      
[0] ENUMERATED  {   originating-Party
(0),    -- In this case, the partyInformation parameter provides the identities related to    -- the originating party and all information provided by this party.    -- This parameter provides also all the information concerning the redirecting    -- party when a forwarded call reaches a target.   terminating-Party
(1),    -- In this case, the partyInformation parameter provides the identities related to    -- the terminating party and all information provided by this party.   forwarded-to-Party
(2),    -- In this case, the partyInformation parameter provides the identities related to    -- the forwarded to party and parties beyond this one and all information    -- provided by this parties, including the call forwarding reason.   gPRS-Target
(3),   ...  },  partyIdentity       
[1] SEQUENCE  {   imei    
[1] OCTET STRING (SIZE (8)) OPTIONAL,    -- See MAP format TS GSM 09.02 [32]   tei     
[2] OCTET STRING (SIZE (1..15)) OPTIONAL,    -- ISDN-based Terminal Equipment Identity   imsi    
[3] OCTET STRING (SIZE (3..8)) OPTIONAL,    -- See MAP format TS GSM 09.02 [32] International Mobile    -- Station Identity E.212 number beginning with Mobile Country Code   callingPartyNumber 
[4] CallingPartyNumber OPTIONAL,    -- The calling party format is used to transmit the identity of a calling party   calledPartyNumber 
[5] CalledPartyNumber OPTIONAL,    -- The called party format is used to transmit the identity of a called party or    -- a forwarded to party.   msISDN    
[6] OCTET STRING (SIZE (1..9)) OPTIONAL,    -- MSISDN of the target, encoded in the same format as the AddressString    -- parameters defined in MAP format TS GSM 09.02 [32], clause 14.7.8.   ...,   e164-Format   
[7] OCTET STRING (SIZE (1..25)) OPTIONAL,    -- E164 address of the node in international format. Coded in the same format as    -- the calling party number parameter of the ISUP (parameter part: EN 300 356 [5])   sip-uri    
[8] OCTET STRING OPTIONAL,    -- Session Initiation Protocol - Uniform Resource Identifier. See RFC 3261 [59].    -- This parameter is duplicated from 3GPP TS 33.108 [61].   tel-url    
[9] OCTET STRING OPTIONAL    -- See "URLs for Telephone Calls", RFC 3966 [68].    -- This parameter is duplicated from 3GPP TS 33.108 [61].  },  services-Information    
[2] Services-Information OPTIONAL,    -- This parameter is used to transmit all the information concerning the    -- complementary information associated to the basic call  supplementary-Services-Information 
[3] Supplementary-Services OPTIONAL,    -- This parameter is used to transmit all the information concerning the    -- activation/invocation of supplementary services during a call or out-of call not    -- provided by the previous parameters.  services-Data-Information   
[4] Services-Data-Information OPTIONAL,    -- This parameter is used to transmit all the information concerning the complementary    -- information associated to the basic data call.  ... }  CallingPartyNumber ::= CHOICE {  iSUP-Format  
[1] OCTET STRING (SIZE (1..25)),   -- Encoded in the same format as the calling party number (parameter field)   -- of the ISUP (see EN 300 356 [5]).  dSS1-Format  
[2] OCTET STRING (SIZE (1..25)),   -- Encoded in the format defined for the value part of the Calling party number   -- information element of DSS1 protocol EN 300 403-1 [6].   -- The DSS1 Information element identifier and the DSS1 length are not included.  ...,  mAP-Format  
[3] OCTET STRING (SIZE (1..25))   -- Encoded as AddressString of the MAP protocol TS GSM 09.02 [32]. }    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)111 CalledPartyNumber ::= CHOICE {  iSUP-Format  
[1] OCTET STRING (SIZE (1..25)),   -- Encoded in the same format as the called party number (parameter field)   -- of the ISUP (see EN 300 356 [5]).  mAP-Format  
[2] OCTET STRING (SIZE (1..25)),   -- Encoded as AddressString of the MAP protocol TS GSM 09.02 [32].  dSS1-Format  
[3] OCTET STRING (SIZE (1..25)),   -- Encoded in the format defined for the value part of the Called party number information   -- element of DSS1 protocol EN 300 403-1 [6].   -- The DSS1 Information element identifier and the DSS1 length are not included.  ... }  Location ::= SEQUENCE {  e164-Number   
[1] OCTET STRING (SIZE (1..25)) OPTIONAL,   -- Coded in the same format as the ISUP location number (parameter   --field) of the ISUP (see EN 300 356 [5]).  globalCellID   
[2] OCTET STRING (SIZE (5..7)) OPTIONAL,   -- See MAP format (see TS GSM 09.02 [32]).  tetraLocation   
[3] TetraLocation OPTIONAL,   -- This optional parameter is not in use anymore, but is kept for backwards compatibility.  rAI     
[4] OCTET STRING (SIZE (6)) OPTIONAL,   -- The Routeing Area Identifier (RAI) in the current SGSN is coded in accordance with   -- 3GPP TS 24.008 [41] without the Routing Area Identification IEI (only the   -- last 6 octets are used).  gsmLocation   
[5] GSMLocation OPTIONAL,  umtsLocation   
[6] UMTSLocation OPTIONAL,  sAI     
[7] OCTET STRING (SIZE (7)) OPTIONAL,   -- format: PLMN-ID 3 octets (no. 1-3),   -- LAC 2 octets (no. 4-5),   -- SAC 2 octets (no. 6-7)   -- (according to 3GPP TS 25.431 [62])  ...,  oldRAI     
[8] OCTET STRING (SIZE (6)) OPTIONAL   -- the "Routeing Area Identifier" in the old SGSN is coded in accordance with   -- 3GPP TS 24.008 [41] without the Routing Area Identification IEI   -- (only the last 6 octets are used).   -- This parameter is duplicated from 3GPP TS 33.108 [61] }  TetraLocation ::= CHOICE {  ms-Loc    
[1] SEQUENCE  {   mcc  
[1] INTEGER (0..1023),    -- 10 bits EN 300 392-1 [40]   mnc  
[2] INTEGER (0..16383),    -- 14 bits EN 300 392-1 [40]   lai  
[3] INTEGER (0..65535),    -- 14 bits EN 300 392-1 [40]   ci   
[4] INTEGER OPTIONAL,   ... 
 },  ls-Loc    
[2] INTEGER }    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)112 GSMLocation ::= CHOICE {  geoCoordinates   
[1] SEQUENCE  {   latitude 
[1] PrintableString (SIZE(7..10)),    -- format: XDDMMSS.SS   longitude 
[2] PrintableString (SIZE(8..11)),    -- format: XDDDMMSS.SS   mapDatum 
[3] IMPLICIT MapDatum OPTIONAL,     -- DEFAULT wGS84 
  ...,   azimuth  
[4] INTEGER (0..359) OPTIONAL    -- The azimuth is the bearing, relative to true north.  }, 
  -- format: XDDDMMSS.SS   -- X : N(orth), S(outh), E(ast), W(est)   -- DD or DDD : degrees (numeric characters)   -- MM : minutes (numeric characters)   -- SS.SS : seconds, the second part (.SS) is optional   -- Example:   -- latitude short form N502312   -- longitude long form E1122312.18   utmCoordinates    
[2] SEQUENCE  {   utm-East  
[1] PrintableString (SIZE(10)),   utm-North  
[2] PrintableString (SIZE(7)),    -- Universal Transverse Mercator    -- example utm-East 32U0439955    -- utm-North 5540736   mapDatum  
[3] IMPLICIT MapDatum OPTIONAL,     -- DEFAULT wGS84 
  ...,   azimuth  
[4] INTEGER (0..359) OPTIONAL    -- The azimuth is the bearing, relative to true north.  },   utmRefCoordinates   
[3] SEQUENCE  {   utmref-string
 [2] PrintableString (SIZE(13)), 
  mapDatum   
[3] IMPLICIT MapDatum OPTIONAL,     -- DEFAULT wGS84 
  ...  }, 
  -- example 32UPU91294045   wGS84Coordinates   
[4] OCTET STRING   -- format is as defined in 3GPP TS 03.32 [57]. }  MapDatum ::= ENUMERATED {  wGS84
(0),   -- World Geodetic System 1984  wGS72
(1),  eD50
(2),   -- European Datum 50  ... }  UMTSLocation ::= CHOICE {  point      
[1] GA-Point,  pointWithUnCertainty  
[2] GA-PointWithUnCertainty,  polygon     
[3] GA-Polygon,  ... }    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)113 GeographicalCoordinates ::= SEQUENCE {  latitudeSign 
 [0] ENUMERATED 
 {   north
(1),   south
(2)  },  latitude 
  [1] INTEGER (0..8388607), 
 longitude
   [2] INTEGER (-8388608..8388607), 
 ... }  GA-Point ::= SEQUENCE {  geographicalCoordinates  
[0] GeographicalCoordinates,  ... }  GA-PointWithUnCertainty ::=SEQUENCE {  geographicalCoordinates  
[0] GeographicalCoordinates,  uncertaintyCode    
[1] INTEGER (0..127) }  maxNrOfPoints INTEGER ::= 15  GA-Polygon ::= SEQUENCE (SIZE (1..maxNrOfPoints)) OF  SEQUENCE  {   geographicalCoordinates  
[0] GeographicalCoordinates,   ...  }  CallContentLinkCharacteristics ::= SEQUENCE {  cCLink-State   
[1] CCLink-State OPTIONAL,   -- current state of the CCLink  release-Time   
[2] TimeStamp OPTIONAL,   -- date and time of the release of the Call Content Link  release-Reason   
[3] OCTET STRING (SIZE(2)) OPTIONAL,   -- Release cause coded in Q.850 [31] format  lEMF-Address   
[4] CalledPartyNumber OPTIONAL,   -- Directory number used to route the call toward the LEMF  ... }  CCLink-State ::= ENUMERATED {  setUpInProcess
(1),   -- The set-up of the call is in process.  callActive
(2),  callReleased
(3),  lack-of-resource
(4),   -- The lack-of-resource state is sent when a CC Link cannot   -- be established because of lack of resource at the MF level  ... }  Intercepted-Call-State ::= ENUMERATED {  idle
(1),   -- When the intercept call is released, the state is IDLE and the reason is provided   -- by the release-Reason-Of-Intercepted-Call parameter  setUpInProcess
(2),   -- The set-up of the call is in process  connected
(3),   -- The answer has been received  ... }    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)114 Services-Information ::= SEQUENCE {  iSUP-parameters    
[1] ISUP-parameters OPTIONAL,  dSS1-parameters-codeset-0  
[2] DSS1-parameters-codeset-0 OPTIONAL,  ...,  mAP-parameters     
[3] MAP-parameters OPTIONAL }  ISUP-parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one additional ISUP parameter TLV coded not already defined in 
 -- the previous parameters. The Tag value is the one given in EN 300 356 [5]. 
  -- In version 1 of the present document "iSUP-parameters" is defined as mandatory. 
 -- It might occur that no ISUP parameter is available. In that case in a version 1 
 -- implementation the value "zero" may be included in the first octet string of the SET. 
  -- The Length and the Value are coded in accordance with the parameter definition in 
 -- EN 300 356 [5]. Hereafter are listed the main parameters. 
 -- However other parameters may be added: 
  -- Transmission medium requirement: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Transmission medium requirement prime: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
 DSS1-parameters-codeset-0 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-0. The parameter is coded as 
 -- described in EN 300 403-1 [6] (The DSS1 Information element identifier and the DSS1 length 
 -- are included). Hereafter are listed the main parameters 
 -- However other parameters may be added: 
  -- Bearer capability: this parameter may be repeated. Format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
  -- High Layer Compatibility: this parameter may be repeated. Format defined in EN 300 403-1 [6] 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
  -- Low Layer capability: this parameter may be repeated. Format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
 MAP-parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE(1..256))  -- Each "OCTET STRING" contains one MAP parameter. The parameter is coded as described in 
 -- TS GSM 09.02 [32] (The map-TS-Code is included). 
 Supplementary-Services ::= SEQUENCE {  standard-Supplementary-Services   
[1] Standard-Supplementary-Services OPTIONAL,  non-Standard-Supplementary-Services  [2] Non-Standard-Supplementary-Services OPTIONAL,  other-Services        
[3] Other-Services OPTIONAL,  ... 
}  Standard-Supplementary-Services ::= SEQUENCE {  iSUP-SS-parameters       
[1] ISUP-SS-parameters OPTIONAL,  dSS1-SS-parameters-codeset-0    
[2] DSS1-SS-parameters-codeset-0 OPTIONAL,  dSS1-SS-parameters-codeset-4    
[3] DSS1-SS-parameters-codeset-4 OPTIONAL,  dSS1-SS-parameters-codeset-5    
[4] DSS1-SS-parameters-codeset-5 OPTIONAL,  dSS1-SS-parameters-codeset-6    
[5] DSS1-SS-parameters-codeset-6 OPTIONAL,  dSS1-SS-parameters-codeset-7    
[6] DSS1-SS-parameters-codeset-7 OPTIONAL,  dSS1-SS-Invoke-components     
[7] DSS1-SS-Invoke-Components OPTIONAL,  mAP-SS-Parameters       
[8] MAP-SS-Parameters OPTIONAL,  mAP-SS-Invoke-Components     
[9] MAP-SS-Invoke-Components OPTIONAL,  ... 
}  Non-Standard-Supplementary-Services ::= SET SIZE (1..20) OF CHOICE {  simpleIndication   
[1] SimpleIndication,  sciData     
[2] SciDataMode,  ... 
}   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)115  Other-Services ::= SET SIZE (1..50) OF OCTET STRING (SIZE (1..256))  -- Reference manufacturer manuals. 
 ISUP-SS-parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- It must be noticed this parameter is retained for compatibility reasons. 
 -- It is recommended not to use it in new work but to use ISUP-parameters parameter. 
  -- Each "OCTET STRING" contains one additional ISUP parameter TLV coded not already defined in 
 -- the previous parameters. The Tag value is the one given in EN 300 356 [5]. 
 -- The Length and the Value are coded in accordance with the parameter definition in 
 -- EN 300 356 [5]. 
 -- Hereafter are listed the main parameters. However other parameters may be added: 
  -- Connected Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- RedirectingNumber: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "originating party" 
 -- or/and of the ﬁterminating partyﬂ. 
  -- Original Called Party Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "originating party". 
  -- Redirection information: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "originating party", "forwarded to party" or/and "Terminating party". 
  -- Redirection Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "forwarded to party" or "Terminating party". 
  -- Call diversion information: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "forwarded to party" or "Terminating party". 
  -- Generic Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
 -- This parameters are used to transmit additional identities (additional, calling party 
 -- number, additional called number, etc). 
  -- Generic Notification: format defined in EN 300 356 [5]. 
 -- This parameter may be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
 -- This parameters transmit the notification to the other part of the call of the supplementary 
 -- services activated or invoked by a subscriber during the call. 
  -- CUG Interlock Code: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)116 DSS1-SS-parameters-codeset-0 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-0. The parameter is coded as 
 -- described in EN 300 403-1 [6] (The DSS1 Information element identifier and the DSS1 length 
 -- are included). Hereafter are listed the main parameters  
 -- (However other parameters may be added): 
  -- Calling Party Subaddress: format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Called Party Subaddress: format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Connected Subaddress: format defined in recommendation (see EN 300 097-1 [14]). 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- Connected Number: format defined in recommendation (see EN 300 097-1 [14]). 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- Keypad facility: format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
  -- Called Party Number: format defined in EN 300 403-1 [6]. 
 -- This parameter could be provided with the "Party Information" of the "calling party" 
 -- when target is the originating party; it contains the dialled digits before modification 
 -- at network level (e.g. IN interaction, translation, etc –). 
  -- User-user: format defined in EN 300 286-1 [23]). 
 -- This parameter can be provided with the "Party Information"of the 
 -- "calling party", "called party" or "forwarded to party". 
 DSS1-SS-parameters-codeset-4 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-4. The parameter is coded as 
 -- described in the relevant recommendation. 
 DSS1-SS-parameters-codeset-5 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-5. The parameter is coded as 
 -- described in the relevant national recommendation. 
 DSS1-SS-parameters-codeset-6 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "OCTET STRING" contains one DSS1 parameter of the codeset-6. The parameter is coded as 
 -- described in the relevant local network recommendation. 
 DSS1-SS-parameters-codeset-7 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "octet string" contains one DSS1 parameter of the codeset-7. The parameter is coded as 
 -- described in the relevant user specific recommendation. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)117 DSS1-SS-Invoke-Components ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "octet string" contains one DSS1 Invoke or Return Result component. 
 -- The invoke or return result component is coded as 
 -- described in the relevant DSS1 supplementary service recommendation. 
  -- Invoke or Return Result component (BeginCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (AddCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (SplitCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (DropCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (IsolateCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (ReattachCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (PartyDISC): EN 300 185-1 [19] 
 -- Invoke or Return Result component (MCIDRequest): EN 300 130-1 [16] 
 -- Invoke or Return Result component (Begin3PTY): EN 300 188-1 [20] 
 -- Invoke or Return Result component (End3PTY): EN 300 188-1 [20] 
 -- Invoke or Return Result component (ECTExecute): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTInform): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTLinkIdRequest): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTLoopTest): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ExplicitECTExecute): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECT: RequestSubaddress): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECT: SubaddressTransfer): EN 300 369-1 [25] 
 -- Invoke or Return Result component (CF: ActivationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DeactivationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: ActivationStatusNotification): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DeactivationStatusNotification): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: InterrogationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: InterrogationServedUserNumber): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DiversionInformation): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: CallDeflection): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: CallRerouteing): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation1): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation2): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation3): EN 300 207-1 [21] 
 -- other invoke or return result components ... 
 MAP-SS-Invoke-Components ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "octet string" contains one MAP Invoke or Return Result component. 
 -- The invoke or return result component is coded as 
 -- described in the relevant MAP supplementary service recommendation. 
 MAP-SS-Parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256))  -- Each "octet string" contains one MAP Parameter. The parameter is coded as 
 -- described in the relevant MAP supplementary service recommendation. 
 SimpleIndication ::= ENUMERATED {  call-Waiting-Indication
(0),   -- The target has received a call waiting indication for this call  add-conf-Indication
(1),   -- this call has been added to a conference  call-on-hold-Indication
(2),   -- indication that this call is on hold  retrieve-Indication
(3),   -- indication that this call has been retrieved  suspend-Indication
(4),   -- indication that this call has been suspended  resume-Indication
(5),   -- indication that this call has been resumed  answer-Indication
(6),   -- indication that this call has been answered  ... }  SciDataMode ::= OCTET STRING (SIZE (1..256))    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)118 SMS-report ::= SEQUENCE {  communicationIdentifier  
[1] CommunicationIdentifier,   -- used to uniquely identify an intercepted call: the same used for the   -- relevant IRI   -- Called "callIdentifier" in V1.1.1 of ES 201 671 [i.5].  timeStamp      
[2] TimeStamp,   -- date and time of the report. The format is   -- the one defined in case a) of the ASN.1 ITU-T Recommendation X.680 [33].   -- (year month day hour minutes seconds)  sMS-Contents     
[3] SEQUENCE  {   initiator   
[1] ENUMERATED   {    -- party which sent the SMS    target
(0),    server
(1),    undefined-party
(2),    ...   },  transfer-status  
[2] ENUMERATED  {   succeed-transfer
(0),    --the transfer of the SMS message succeeds   not-succeed-transfer
(1),   undefined
(2),   ...  } OPTIONAL, 
 other-message   
[3] ENUMERATED  {   -- In case of terminating call, indicates if the server will send other SMS.   yes
(0),   no
(1),   undefined
(2),   ...  } OPTIONAL,  content      
[4] OCTET STRING (SIZE (1..270)) OPTIONAL,   -- Encoded in the format defined for the SMS mobile.  ...  } }  LawfulInterceptionIdentifier ::= OCTET STRING (SIZE (1..25))  -- It is recommended to use ASCII characters in "a"–"z", "A"–"Z", "-", "_", ".", and "0"–"9".  -- For subaddress option only "0"..."9" shall be used.  National-Parameters ::= SET SIZE (1..40) OF OCTET STRING (SIZE (1..256))  -- Content defined by national law 
 GPRSCorrelationNumber ::= OCTET STRING (SIZE(8..20))  GPRSEvent ::= ENUMERATED {  pDPContextActivation
(1),  startOfInterceptionWithPDPContextActive
(2),  pDPContextDeactivation
(4),  gPRSAttach
(5),  gPRSDetach
(6),  cellOrRAUpdate
(10),  sMS
(11),  ...,  pDPContextModification
(13) } -- see 3GPP TS 03.33 [42]  Services-Data-Information ::= SEQUENCE {  gPRS-parameters 
[1] GPRS-parameters OPTIONAL,  ... }    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)119 GPRS-parameters ::= SEQUENCE {  pDP-address-allocated-to-the-target 
[1] DataNodeAddress OPTIONAL,  aPN         
[2] OCTET STRING (SIZE(1..100)) OPTIONAL,  pDP-type       
[3] OCTET STRING (SIZE(2)) OPTIONAL,  ... }  GPRSOperationErrorCode ::= OCTET STRING (SIZE(2))  -- Refer to 3GPP TS 24.008 [41] for values (GMM cause or SM cause parameter). 
 DataNodeAddress ::= CHOICE {  ipAddress 
[1] IPAddress,  x25Address 
[2] X25Address,  ... }  IPAddress ::= SEQUENCE {  iP-type   
[1] ENUMERATED  {   iPV4
(0),   iPV6
(1),   ...  },  iP-value  
[2] IP-value,  iP-assignment 
[3] ENUMERATED  {   static
(1),    -- The static coding shall be used to report a static address.   dynamic
(2),    -- The dynamic coding shall be used to report a dynamically allocated address.   notKnown
(3),    -- The notKnown coding shall be used to report other then static or dynamically    -- allocated IP addresses.   ...  } OPTIONAL,  ... }  IP-value ::= CHOICE {  iPBinaryAddress  
[1] OCTET STRING (SIZE(4..16)),  iPTextAddress   
[2] IA5String (SIZE(7..45)),  ... }  X25Address ::= OCTET STRING (SIZE(1..25))  National-HI2-ASN1parameters ::= SEQUENCE {  countryCode  
[1] PrintableString (SIZE (2)),   -- Country Code according to ISO 3166-1 [67],   -- the country to which the parameters inserted after the extension marker apply.  ...   -- In case a given country wants to use additional national parameters according to its law,   -- these national parameters should be defined using the ASN.1 syntax and added after the   -- extension marker (...).   -- It is recommended that "version parameter" and "vendor identification parameter" are   -- included in the national parameters definition. Vendor identifications can be   -- retrieved from the IANA web site (see annex J). Besides, it is recommended to avoid   -- using tags from 240 to 255 in a formal type definition. }  END -- end of TETRA-HI2Operations    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)120 Annex E (informative): 
Use of subaddress and calling party number to carry 
correlation information E.1 Introduction 
Not all ISDN networks fully support the use of the UUS1 service EN 300 286-1 [23]. Some networks may be limited to 
the transfer of only 32 octets of UUS1 user information rather than the 128 required for full support of the UUS1 

service. Some networks may not support UUS1 at all. 
This annex describes a procedure to provide correlation information which is appropriate: 
1) if a network does not support the delivery of UUS1; or 

2) if a network does not support the delivery of 128 octets for UUS1. 
If all network involved support the delivery of 128 octets for UUS1 then the procedure (described in this annex) is not 
appropriate. 
The calling party number, the Calling Party Subaddress (CgP Su
b) and the Called Party Subaddress (CdP Sub) are used 
to carry correlation information. 
E.2 Subaddress options 
The coding of a subaddress information element is given in EN 300 403-1 [6]. The following options are chosen: 
Table E.2.1: Subaddress options 
Option
 Value Type of subaddress user specified 
Odd/even indicator employed for Called Party Subaddress when no national parameters are used 
 E.3 Subaddress coding 
dThe coding of subaddress information is in accordance with EN 300 403-1 [6]. 
E.3.1 BCD values 
The values 0 to 9 are BCD coded according to their natural bi
nary values. The hexadecimal value F is used as a field 
separator. This coding is indicated in table E.3.1. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)121 Table E.3.1: Coding BCD values 
Item 
BCD representation
 Bit 4 Bit 3 Bit 2 Bit 1 0 0 0 0 0 
1 0 0 0 1 
2 0 0 1 0 
3 0 0 1 1 
4 0 1 0 0 
5 0 1 0 1 
6 0 1 1 0 
7 0 1 1 1 
8 1 0 0 0 
9 1 0 0 1 
Field separator 1 1 1 1 
 When items are packed two to an octet, the least significant item is coded by mapping bit 4 to bit 8, bit 3 to bit 7, etc. 
E.3.2 Field order and layout 
The fields are presented into the subaddress in the following order. 
Table E.3.2: Fields in the Called Party Subaddress 
Order
 Field 1 Operator-ID 
2 CIN 
3 CCLID 
4 National Parameters 
 Table E.3.3: Fields in the Calling Party Subaddress 
Order
 Field 1 Lawful Interception Identifier (LIID) 
2 Direction 
3 Service Octets 
 
Apart from "National Parameters", inclusion and format of which is determined by national regulations, each field noted 
above is included, whether empty or not. Each of the Operat
or-ID, CIN, CCLID, LIID and Direction fields is ended by 
a field separator. 
When the sending entity does not have a valid value for either
 of Operator-ID, CIN, CCLID, LIID or Direction fields, 
then the field is considered empty and it is represented only
 by its field separator (see table E.3.6 as example of the 
Called party subaddress without the CIN parameter). 
The parameters within the Information Elements "Called Party Subaddress" and "Calling Party Subaddress" are 
variable. Because of this variable length the parameters may start in different octets in the related Information Element. 

I.e. in the Calling Party Subaddress the Direction can be found in octet 17 when the LIID is 25 digits long (table E.3.5). 
When the LIID is composed of less than 25 digits, the field separator and direction indicator "moves up" and the rest of 
the octets is spare till octet 19 as shown in table E.3.7. Between the last digit of the LIID and the Direction is always a 

Field separator (value F). Also after the "Direction" one Field Separator is given. The last Field separator separates the 

relevant data from the spare part. So the location of the TMR and the other service Octets below are fixed within the 

Subaddress. The total length of the Calling Party Subaddress is fixed to 23 octets (including the two Mobile service 

octets) or 21 octets (without the two Mobile service octets). 
The Service Octets as available are always be mapped into octets 19 to 23 of the Calling Party Subaddress, as 
appropriate. If one of the parameters TMR, BC or HLC is not available, the octet is filled with "FF" hex. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)122 In relation to Mobile Bearer Service Code and Mobile Tele
service Code, the mapping of the values into octets 22 and 
23, respectively, is done as follows: 
• if both, Mobile Bearer Service Code and Mobile Teleservice Code are provided by signalling, octets 22 and 
23, are present, each containing the mapped value; 
• if Mobile Bearer Service Code is provided by signalli
ng, and Mobile Teleservice Code is NOT provided by 
signalling, octet 22 is present containing the mapped value, and octet 23 is omitted; 
• if Mobile Teleservice Code is provided by signalling,
 and Mobile Bearer Service Code is NOT provided by 
signalling, there are two implementation options: 
- neither octet 22 nor octet 23 are present; 
- octet 22 is filled with "FF" hex and octet 23 is present containing the mapped value; 
• if neither Mobile Teleservice Code nor Mobile Bearer Service Code is provided by signalling, neither octet 22 
nor octet 23 are present. 
As an option the Calling Party Subaddress and Called Party Subaddress may have a variable length. The length is given 
in octet 2. 
When the LIID is composed of less than 25 digits in the Calling Party Subaddress, the Field separator, Direction 
indicator, Field separator and all the Service Octets "moves up" as shown in table E.3.8. 
National Parameters in a variable length Called Party Subaddress may have variable length. 
Table E.3.4 represent Called Party Subaddress and table E.3.5 Calling Party Subaddress with the maximum length of 
the identifiers. 
Table E.3.4: Called Party Subaddress 
Bits Octets 
8 7 6 5 4 3 2 1 Called Party Subaddress identifier 1 
Length of Called Party Subaddress contents 2 
Type of subaddress = user specified, odd/even 
indicator 
3 Operator-ID 
 Operator-ID 
 4 
Operator-ID 
 Operator-ID 
 5 
Field separator Operator-ID 
 6 
CIN  CIN 
 7 
CIN  CIN 
 8 
CIN  CIN 
 9 
CIN  CIN 
 10 
CCLID 
 Field separator  11 
CCLID 
 CCLID 
 12 
CCLID 
 CCLID 
 13 
CCLID 
 CCLID 
 14 
Field separator  CCLID 
 15 
(see note) 16 
 17 
 18 
 19 
 20 
 21 
 22 
 23 
NOTE: The Octets after the final field (CCLID) of the Called 
Party Subaddress are reserved for national use, e.g. for 
authentication purposes. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)123 Table E.3.5: Calling Party Subaddress 
Bits Octets 
8 7 6 5 4 3 2 1 Calling Party Subaddress identifier 1 
Length of Calling Party Subaddress contents 2 
Type of subaddress = user specified, odd/even 
indicator according to the amount of BCD-digits 
3 LIID  LIID 
 4 
LIID  LIID 
 5 
LIID  LIID 
 6 
LIID  LIID 
 7 
LIID  LIID 
 8 
LIID  LIID 
 9 
LIID  LIID 
 10 
LIID  LIID 
 11 
LIID  LIID 
 12 
LIID  LIID 
 13 
LIID  LIID 
 14 
LIID  LIID 
 15 
Field separator LIID 
 16 
Field separator Direction 17 
spare spare 18 
ITU-T Recommendation Q.763 [48] TMR 
(see note 1) 
19 
ITU-T Recommendation Q.931 BC [56] octet 3 
(see note 2) 
20 
ITU-T Recommendation Q.931 HLC [56] 
octet 4 (see note 3) 
21 
Mobile Bearer Service Code 
(see note 4) 
22 
Mobile Teleservice Code (see note 5) 23 
NOTE 1: If available, the Transmission Medium Requirement 
according to EN 300 356 [5].  

If not available, the value is "FF" hex. 
NOTE 2: If available, only octet 3 of the Bearer Capability 
i.e. according to EN 300 403-1 [6].  
If not available, the value is "FF" hex. 
NOTE 3: If available, only octet 4 of the High Layer Compatibility 
i.e. according to EN 300 403-1 [6].  
If not available, the value is "FF" hex. 
NOTE 4: If available, the Mobile Bearer Service Code
 according to 
GSM TS 09.02 [32].  

If not available, the octets 22 and 23 (even if the mobile 
teleservice code is available) are not transmitted. 
If the mobile teleservice code is available optionally 

octet 22 could be filled with "FF" hex and be transmitted. 
NOTE 5: If available, the mobile teleservice code
 according to 
GSM TS 09.02 [32].  
If not available, the octet 23 is not transmitted. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)124 Table E.3.6: Example how field separator should be used when field is empty 
Called Party Subaddress without CIN parameter 
Bits Octets 
8 7 6 5 4 3 2 1 Called Party Subaddress identifier 1 
Length of Called Party Subaddress contents 2 
Type of subaddress = user specified, odd/even 
indicator  
3 Operator-ID 
 Operator-ID 
 4 
Operator-ID 
 Operator-ID 
 5 
Field separator Operator-ID 
 6 
CCLID 
 Field separator 7 
CCLID 
 CCLID 
 8 
CCLID 
 CCLID 
 9 
CCLID 
 CCLID 
 10 
Field separator CCLID 
 11 
spare spare 12 
spare spare 13 
spare spare 14 
spare spare 15 
(see note) 16 
 17 
 18 
 19 
 20 
 21 
 22 
 23 
NOTE: The Octets after the final field (CCLID) of the Called 
Party Subaddress are reserved for national use, e.g. for 

authentication purposes. 
 Tables E.3.7 and E.3.8 represent the Calling Party Subaddress containing an LIID with a length of only 5 octets. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)125 Table E.3.7: Calling Party Subaddress 
(fixed length of 23 octets; example with LIID of only 5 digits) 
Bits Octets 
8 7 6 5 4 3 2 1 Calling Party Subaddress identifier 1 
Length of Calling Party Subaddress contents 2 
Type of subaddress = user specified, odd/even 
indicator according to the amount of BCD-digits 
3 LIID  LIID 
 4 
LIID  LIID 
 5 
Field separator LIID 
 6 
Field separator Direction 7 
spare spare 8 
spare spare 9 
spare spare 10 
spare spare 11 
spare spare 12 
spare spare 13 
spare spare 14 
spare spare 15 
spare spare 16 
spare spare 17 
spare spare 18 
ITU-T Recommendation Q.763 [48] TMR 
(see note 1) 
19 
ITU-T Recommendation Q.931 BC [56] 
octet 3 (see note 2) 
20 
ITU-T Recommendation Q.931 HLC [56] 
octet 4 (see note 3) 
21 
Mobile Bearer Service Code 
(see note 4) 
22 
Mobile Teleservice Code (see note 5) 23 
NOTE 1: If available, the Transmission Medium Requirement 
according to EN 300 356 [5].  
If not available, the value is "FF" hex. 
NOTE 2: If available, only octet 3 of the Bearer Capability i.e. 
according to EN 300 403-1 [6].  
If not available, the value is "FF" hex. 
NOTE 3: If available, only octet 4 of the High Layer Compatibility 
i.e. according to EN 300 403-1 [6].  

If not available, the value is "FF" hex. 
NOTE 4: If available, the Mobile Bearer Service Code
 according to 
GSM TS 09.02 [32].  

If not available, the octets 22 and 23 (even if the mobile 

teleservice code is available) are not transmitted. Optional 
octet 22 could be filled with "FF" hex and the Mobile 
Teleservice Code be transmitted. 
NOTE 5: If available, the Mobile Teleservice Code
 according to 
GSM TS 09.02 [32].  
If not available, the octet 23 is not transmitted. 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)126 Table E.3.8: Calling Party Subaddress 
(variable length; example with LIID of only 5 digits) 
Bits Octets 
8 7 6 5 4 3 2 1 Calling Party Subaddress identifier 1 
Length of Calling Party Subaddress contents 2 
Type of subaddress = user specified, odd/even 
indicator according to the amount of BCD-digits 
3 LIID  LIID 
 4 
LIID  LIID 
 5 
Field separator LIID 
 6 
Field separator Direction 7 
spare (see note 6) spare (see note 6) 8 
ITU-T Recommendation Q.763 [48] TMR 
(see note 1) 
9 ITU-T Recommendation Q.931 BC [56] 
octet 3 (see note 2) 
10 
ITU-T Recommendation Q.931 HLC [56] 
octet 4 (see note 3) 
11 
Mobile Bearer Service Code (see note 4) 12 
Mobile Teleservice Code (see note 5) 13 
NOTE 1: If available, the Transmission Medium Requirement according to 
EN 300 356 [5].  

If not available, the value is "FF" hex. 
NOTE 2: If available, only octet 3 of the Bearer Capability i.e. according to 
EN 300 403-1 [6].  
If not available, the value is "FF" hex. 
NOTE 3: If available, only octet 4 of the High Layer Compatibility i.e. 
according to EN 300 403-1 [6].  
If not available, the value is "FF" hex. 
NOTE 4: If available, the Mobile Bearer Service Code
 according to 
TS GSM 09.02 [32].  

If not available, the octet (even if the mobile teleservice code is 
available) is not transmitted. 
Optional this octet could be filled with "FF" hex and the Mobile 

Teleservice Code be transmitted. 
NOTE 5: If available, the Mobile Teleservice Code
 according to 
TS GSM 09.02 [32].  
If not available, the octet is not transmitted. 
NOTE 6: If the number of half octets for the LIID field and the direction 
field including the field separators is odd, then three half octets 
with the spare pattern "F" are included. 
If the number of half octets for the LIID field and the direction 

field including the field separators is even, then two half octets 

with the spare pattern "F" are included. 
 E.4 Field coding 
Each field employs decimal coding, except for the Service Octets (octets 19 to 23 of the CgP Sub) and the octets 
reserved for national use (octets 16 to 23 of the CdP Sub). Other values are not permitted. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)127 E.4.1 Direction The direction field is coded as follows. 
Table E.4.1: Direction coding 
Indication
 Value Mono mode (combined signal) (historic) 0 
CC from target 1 
CC to target 2 
Direction unknown 3 
NOTE: CC stereo mode (values 1 and 2) is the default mode. 
CC mono mode (value 0) is reserved to be compatible with previous versions of 
the present document and it could be adopted according to national requirements. 
 E.4.2 Coding of the Calling Party Number 
The Network Element Identifier (NEID) is carried by the calling party number information element. The coding is as 
follows, depending on the type of network access (see note). 
NOTE: The relevant national specification of the Signalling System Number 7 may also specify requirements on 
the Nature of address for national specific use in national variants of ISUP. 
Table E.4.2: Calling Party Number coding 
Field Value Numbering plan identification ISDN/telephony numbering plan (ITU-T Recommendation E.164 [58]) 
Nature of address 
As specified in ITU-T Recommendation Q.731.3 [63] (see note 1) (e.g. national (significant) 
number or international number) (in case of ISUP signalling) 
Type of number 
As specified in ITU-T Recommendation Q.951.1 [64] and ITU-T 
Recommendation Q.951.3 [65], EN 300 092 [66] (e.g. unknown, subscriber number, 

national number or international number), an
d Network Operator specific type of access 
(BRA or PRA) (in case of DSS1 signalling, see notes 2 and 3) 
Screening indicator Network provided (in case ISUP signalling) 
Screening indicator User-provided, not screened (in case of DSS1 signalling, see note 3) 
Presentation indicator Presentation allowed 
NOTE 1: The relevant national specification of the Signalling System Number 7 may also specify requirements on the 
Nature of address for national specific use in national variants of ISUP. 
NOTE 2: Usually, the IIF respectively the Mediation Function is connected to the network by links using Signalling System 
Number 7 and ISDN User Part (ISUP), whereby the parameters are coded according to EN 300 356 [5]. But in 

some cases, the IIF respectively the Mediation Function may be connected via a Basic Rate Access or a Primary 

Rate Access using D-Channel signalling, whereby the parameters are coded according to EN 300 403-1 [6]. 
NOTE 3: The network will perform screening, i.e. the number
 will arrive at the LEMF as "user-provided, verified and 
passed" with the appropriate "type of number" indicator. A network provided number is also accepted at the 

LEMF. 
E.5 Length of fields 
The length of the identifiers is variable. The maximum an
d recommended minimum length of each field is given in 
table E.5.1. 
Table E.5.1: Field length 
Field 
Minimum length
 (decimal digits) 
Maximum 
length
 (decimal digits) 
Maximum length
 (Half-Octets) 
I.E. Operator ID 2 5 5 + 1 CdP Sub 
CIN 6 8 8 + 1 CdP Sub 
CCLID 1 8 8 + 1 CdP Sub 
LIID 2 25 25 + 1 CgP Sub 
Direction 1 1 1 + 1 CgP Sub 
Service Octets   10 CgP Sub 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)128 Annex F
 (informative): 
GPRS HI3 interface 
F.1 Functional architecture 
Figure F.1.1 contains the reference configuration for lawful interception (see 3GPP TS 03.33 [43]). 
LEASGSN
GGSN
ADMF
CC MFIRI MF
DF3PDF2PNWO/AP/SvP™s
administration
centre
X1P
X2P
X3P
HI1
HI2
HI3
IIF Figure F.1.1: Reference configuration 
There is one ADMinistration Function (ADMF) in the network. Together with the delivery functions it is used to hide 
from the xGSN that there might be multiple activations by different Law Enforcement Agencies (LEAs) on the same 

target. 
NOTE: GGSN interception is a national option. 
The reference configuration is only a logical representation of the entities involved in lawful interception and does not 
mandate separate physical entities. This allows for higher levels of integration. 
A call could be intercepted based on several identities (MSISDN, IMSI, IMEI) of the same target. 

For the delivery of the CC and IRI the xGSN provides a correlation number and target identity to the DF2P and DF3P 
which is used there to select the differe
nt LEAs where CC/IRI is delivered to. 
F.2 Correlation Correlation of GSM IDs of 3GPP TS 03.33 [43] to the present document IDs. 
Warrant reference number 
 Lawful Interception IDentifier (LIID). 
xGSN address  
 Network IDentifier (NID). 
F.3 HI3 Delivery Content of Communication (CC) 
There are two possible methods for delivery of Content of Communication to the LEMF: 
• GPRS LI Correlation (GLIC) Header and UDP/TCP (see clause F.3.1); 
• FTP/TCP (see clause F.3.2). 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)129 According to national requirements al least one of these methods have to be provided. 
However, when TCP is used as across the HI3, real time de
livery of the result of the interception cannot be guaranteed. 
NOTE: Apart from transport layer protocol selection, real time delivery depends on network performance. 
F.3.1 GPRS LI correlation header 
F.3.1.1 Introduction 
The header and the payload of the communication between the 
intercepted subscriber and the other party (later called: 
Information Element) are duplicated
. A new header (later called: GLIC-Header, see table F.3.1) is added 
(see table F.3.3) before it is sent to LEMF. 
Data packets with the GLIC header ar
e send to the LEA via UDP or TCP/IP. 
F.3.1.2 Definition of GLIC header 
GLIC header contains the following attributes: 
• correlation number; 
• message type (a value of 255 is used for HI3-PDUs); 
• direction; 
• sequence number; 
• length; 
• GPRS Support Node (GSN) type. 
T-PDU contains the intercepted information. 
Table F.3.1: Outline of GLIC header 
Octets 
Bits 8 7 6 5 4 3 2 1 1 Version ("0 0 0") "1" 
Spare "1" 
GSN type 
DIR "0" 
2 Message Type (value 255) 
3-4 Length 
5-6 Sequence Number 
7-8 not used (value 0) 
9 not used (value 255) 
10 not used (value 255) 
11 not used (value 255) 
12 not used (value 255) 
13-20 correlation number 
 For interception tunnelling the GLIC header is used as follows: 
• version is set to 0 to indicate the first version of GLIC header; 
• DIR indicates the direction of the T-PDU: 
- "1" indicating uplink (from observed mobile user); and 
- "0" indicating downlink (to observed mobile user); 
  ETSI ETSI TS 101 
671 V3.5.1 (2009
-11)130 • message type is set to 255 (the unique value that is used for T-PDU within GTP (3GPP TS 09.60 [45]); 
• length is the length, in octets, of the signalling message excluding the GLIC header. Bit 8 of octet 3 is the most 
significant bit and bit 1 of octet 4 is the least significant bit of the length field; 
• sequence number is an increasing sequence number for tunnelled T-PDUs. Bit 8 of octet 5 is the most 
significant bit and bit 1 of octet 6 is the least significant bit of the sequence number field; 
NOTE: When a handoff occurs between SGSNs, the DF3 serving the LEA may change. If the DF3 serving an 
LEA changes as a result of an handoff between SGSNs, contiguous sequencing may not occur as new 

sequencing may be initiated at the new DF3. Accordingly, the LEA should not assume that sequencing is 

contiguous when handoff occurs between SGSNs and the DF3 serving the LEA changes. 
• correlation number consists of two parts: GGSN-ID 
identifies the GGSN which creates the Charging-ID: 
- Charging-ID is defined in 3GPP TS 09.60 [45] and assigned uniquely to each PDP context activation on 
that GGSN (4 octets). 
- The correlation number consists of 8 octets and guar
antees a unique identification of the tunnel to the 
LEA over a long time. The requirements for this identification are similar to that defined for charging in 

3GPP TS 09.60 [45], clause 5.4. Therefore it is proposed to use the Charging-ID, defined in 

3GPP TS 09.60 [45], clause 5.4 as part of correlation number. The Charging-ID is signalled to the new 

SGSN in case of SGSN-change so the tunnel identifier could be used "seamlessly" for the HI3 interface. 
Table F.3.2: Outline of correlation number 
0          1          2          3  Octets 
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 Charging-ID 
Octet 1 
Charging-ID 
Octet 2 
Charging-ID 
Octet 3 
Charging-ID 
Octet 4 
13-16 
GGSN-ID  
17-20  The GLIC header is followed by a subsequent payload information element. Only one information element is allowed in 
a single signalling message. 
Table F.3.3: GLIC header followed by the subsequent payload 
Information Element (IE) 
Octets Bits 8 7 6 5 4 3 2 1  1-20 GLIC- Header 
21-n Information Element 
 • GPRS Support Node (GSN) type. Indicates whether the T-PDU was intercepted in the GGSN or in the SGSN: 
"0" indicating GGSN; and "1" indicating SGSN. 
This parameter is needed only in case the GGSN and the SG
SN use the same Delivery Function/Mediation Function for 
the delivery of Content of Communication (CC). 
The Information Element (IE) contains the header and th
e payload of the communication between the intercepted 
subscriber and the other party. 
F.3.1.3 Exceptional procedure 
With UDP and GLIC: the delivering node does not take care about any problems at LEMF. 
With TCP and GLIC: TCP tries to establish a connection to LEMF and resending (buffering in the sending node) of 
packets is also supported by TCP. 
In both cases it might happen that call content gets lost (i
n case the LEMF or the transit network between MF and 
LEMF is down for a long time). 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)131 F.3.1.4 Other considerations 
The use of IPsec for this interface is recommended. 
The required functions in LEMF are: 
• Collecting and storing of the incoming packets inline with the sequence numbers. 
• Correlating of CC to IRI with the use of the correlation number in the GLIC header. 
F.3.2 FTP 
F.3.2.1 Introduction 
At HI3 interface FTP is used over the Internet protocol st
ack for the delivery of the result of interception. FTP is 
defined in RFC 959 [46]. The IP is defined in RFC 791 [51]. The TCP is defined in RFC 793 [52]. 
FTP supports reliable delivery of data. The data may be temporarily buffered in the sending node (MF) in case of link 
failure. FTP is independent of the payload data it carries. 
F.3.2.2 Usage of the FTP 
In the packet data LI the MF acts as the FTP client and the receiving node (LEMF) acts as the FTP server. The client 

pushes the data to the server. 
The receiving node LEMF stores the received data as files. The sending entity (MF) may buffer files. 
Several smaller intercepted data units may be gathered to bigger packages prior to sending, to increase bandwidth 
efficiency. 
The following configurable intercept data collection (= transfer package closing/file change) threshold parameters 
should be supported: 
• frequency of transfer, based on send timeout, e.g. X ms; 
• frequency of transfer, based on volume trigger, e.g. X octets. 
There are two possible ways how the interception data may be
 sent from the MF to the LEMF. One way is to produce 
files that contain interception data only for one observed target (ref: "File naming method A)"). The other way is to 

multiplex all the intercepted data that MF receives to the same
 sequence of general purpose interception files sent by the 
MF (ref: "File naming method B)"). 
The HI2 and HI3 are logically different interfaces, even thou
gh in some installations the HI2 and HI3 packet streams 
might also be delivered via a common transmission path from
 a MF to a LEMF. It is possible to correlate HI2 and HI3 
packet streams by having common (referencing) data fi
elds embedded in the IRI and the CC packet streams. 
File naming: 
The names for the files transferred to a LEA are formed accord
ing to one of the 2 available formats, depending on the 
delivery file strategy chosen (e.g. due to national convention or operator preference). 
Either each file contains data of only one observed target (as in method A) or several targets' data is put to files common 
to all observed target traffic through a particular MF node (as in method B). 
The maximum set of allowed characters in interception file names are "a"–"z", "A"–"Z", "-", "_", ".", and 
decimals "0"–"9". 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)132 File naming method A): 
<LIID>_<seq>.<ext> 
LIID
 =  as defined in the present document. This field has a character string value, e.g. "ABCD123456". 
This is a unique interception request identifier allocated by the ADMF. It will be given by the 

ADMF to the LEA via the HI1 interface after the AD
MF has been authorized to command the start 
of the interception of a specific target. The possibl
e network operator identifier part used should be 
agreed with (and allocated by) the regula
tory organization administrating the local 
telecommunication practises. 
seq
 =  integer ranging between [0..2
64-1
], in ASCII form (not exceeding 20 ASCII digits), identifying the 
sequence number for file transfer from this node per a specific target. 
ext
 =  ASCII integer ranging between ["1"..."8"] (in hex: 31H...38H), identifying the file type. The 
possible file type codings for intercepted data are shown in table F.3.4. The types "2", "4", and "6" 

are reserved for the HI3 interface and type "8" is 
reserved for data files according to a national 
requirement by using the same file naming concept. 
Table F.3.4: Possible file types 
File types that the LEA may get
 Intercepted data types
 "1" (in binary: 0011 0001) 
IRI/  as option HI1 notifications 
(see clause C.2.2) 
"2" (in binary: 0011 0010) CC (MO) 
"4" (in binary: 0011 0100) CC (MT) 
"6" (in binary: 0011 0110) CC (MO&MT) 
"7" (in binary: 0011 0111) IRI + CC (MO&MT) 
"8" (in binary: 0011 1000) for national use 
 The least significant bit that is "1" in file type 1, is reserved for indicating IRI data and may be used for indicating that 
the HI2 and HI3 packet streams are delivered via a 
common transmission path from a MF to a LEMF. 
The bit 2 of the 
ext
 tells whether the Mobile Originated (MO) Content of Communication (CC) is included to the 
intercepted data. 
The bit 3 of the 
ext
 tells whether the Mobile Terminated (MT) Content of Communication (CC) is included to the 
intercepted data.  
The bit 4 of the 
ext
 tells whether the intercepted data is
 according to a national requirement. 
Thus, for Mobile Originated Content of Communication data, the file type is "2", for MT CC data "4", for MO&MT CC 
data "6" and for "national use" data the file type is "8". 
Thus, for Mobile Originated Content of Communication data, the file type is "2", for MT CC data "4" and for 
MO&MT CC data "6". 
When HI2 and HI3 packet streams are delivered via a common 
transmission path from a MF to a LEMF, then the file 
type is "7", that indicates the presence of both the IRI and the CC(MO&MT) data. 
This alternative A is used when each target's intercepted data
 is gathered per observed target to dedicated delivery files. 
This method provides the result of interception in a very refined form to the LEAs, but requires somewhat more 

resources in the sending node than alternative B. With this method, the data sorting and interpretation tasks of the 
LEMF are considerably easier to facilitate in near real time than in alternative B. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)133 File naming method B): 
The other choice is to use monolithic fixed format file names (with no trailing file type part in the file name): 
<filenamestring> of the format ABXYyymmddhhmmsseeeet 
where: 
AB =  Two letter ASCII Operator ID (as agreed with the national telecom regulators). 
XY =  Two letter ASCII identification of the MF node (as assigned by the operator). 
yy =  Two digits ASCII integer ranging between ["00"..."99"], identifying the last to digits of the year. 
mm =  Two digits ASCII integer ranging between ["01"..."12"], identifying the month. 
dd =  Two digits ASCII integer ranging between ["01"..."31"], identifying the day. 
hh =  Two digits ASCII integer ranging between ["00"..."23"], identifying the hour. 
mm =  Two digits ASCII integer ranging between ["00"..."59"], identifying the minute. 
ss =  Two digits ASCII integer ranging between ["00"..."59"], identifying the second. 
eeee =  Alphanumeric extension made up of four charact
ers chosen at the discretion of the Operator and/or 
the MF to avoid file name clashes within th
e MF. Each of the position is out of "A"...."Z", 
"0"...."9". 
t =  ASCII integer ranging between ["1"...."8"] (in hex: 31H...38H), identifying the file type. The 
possible file type codings for intercepted data are shown in table F.3.4. 
EXAMPLE: <filenamestring> (e.g. ABXY00041014084400006). 
where: 
ABXY
 =  Source node identifier part, used for all files by the mobile network operator "AB" from this MF 
node named "XY". 
00 =  year 2000. 
04 =  month April. 
10 =  day 10. 
14 =  hour. 
08 =  minutes. 
44 =  seconds. 
0000 =  extension. 
6 =  file type. Coding: "2" = CC (MO), "4" = CC (MT), "6" = CC (MO&MT), "8" = national use. 
The type "1" is reserved for IRI data files and may be used for indicating that the HI2 and HI3 
packet streams are delivered via a common transmissi
on path from a MF to a LEMF. In such case, 
the file type is "7", that indicates the presence of both the IRI and the CC(MO&MT) data. 
This alternative B is used when several targets' intercepted data is gathered to common delivery files. This method does 
not provide the result of interception in as refined form to the LEAs as the alternative A, but it is faster in performance 
for the MF point of view. With this method, the MF does not need to keep many files open like in alternative A. 
F.3.2.3 Profiles 
NOTE: This clause is informative only. 
As there are several ways (usage profiles) how data transfer can be arranged by using the FTP, this clause contains 
practical considerations how the communications can be se
t up. Guidance is given for client-server arrangements, 
session establishments, time outs, the handling of the files (in RAM or disk). Example batch file is described for the 

case that the sending FTP client uses files. If instead (logical) files are sent directly from the client's RAM memory, 

then the procedure can be in principle similar though no script file would then be needed. 
At the LEMF side, FTP server process is run, and at MF, FTP client. No FTP server (which could be accessed from 
outside the operator network) is runned in the MF. The FTP client can be implemented in many ways, and here the FTP 

usage is presented with an example only. The FTP client can be implemented by a batch file or a file sender program 

that uses FTP via an API. The login needs to occur only on
ce per e.g. <destaddr> and <leauser> - pair. Once the login is 
done, the files can then be transferred just by repeating "m
put" command and checking the transfer status (e.g. from the 
API routine return value). To prevent inactivity timer triggering, a dummy command (e.g. "pwd") can be sent every 
T seconds (T should be less than L, the actual idle time limit). If the number of FTP connections is wanted to be as 
minimized as possible, the FTP file transfer method "B" is to be preferred to the method A (though the method A helps 

more the LEMF by pre-sorting the data sent). 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)134 Simple example of a batch file extract: 
FTP commands usage scenario for transferring a list of files: 

To prevent FTP cmd line buffer overflow the best way is to use wildcarded file names, and let the FTP implementation 
do the file name expansion (instead of shell). The number of files for one mput is not limited this way: 
ftp <flags> <destaddr>  user <leauser> <leapasswd>  cd <destpath>  lcd <srcpath>  bin  mput <files>  nlist <lastfile> <checkfile>  close EOF  This set of commands opens an FTP connection to a LEA site, logs in with a given account (auto-login is disabled), 
transfers a list of files in binary mode, and checks the transfer status in a simplified way. 
Brief descriptions for the FTP commands used in the example: 
user <user-name> <password> Identify the client to the remote FTP server. 
cd <remote-directory> Change the working directory on the remote machine to 
remote-directory. lcd <directory> Change the working directory on the local machine. 
bin Set the file transfer type to support binary image transfer 
mput <local-files> Expand wild cards in the list of local files given as 
arguments and do a put for each file in the resulting list. Store each local file on the remote machine. nlist <remote-directory> <local-file> Print a list of the files in a directory on the remote 
machine. Send the output to local-file. close Terminate the FTP session with the remote server, and return 
to the command interpreter. Any defined macros are erased.  The parameters are as follows: 
<flags>
 contains the FTP command options, e.g. "-i -n -V -p" which equals to "interactive prompting off", "auto-login 
disabled", "verbose mode disabled", and "passive mode enabled". (These are dependent on the used ftp-version.) 
<destaddr>
 contains the IP address or DNS address of the destination (LEA). 
<leauser>
 contains the receiving (LEA) username. 
<leapasswd>
 contains the receiving (LEA) user's password. 
<destpath>
 contains the destination path. 
<srcpath>
 contains the source path. 
<files>
 wild carded file specification (matching the files to be transferred). 
<lastfile>
 the name of the last file to be transferred. 
<checkfile>
 is a (local) file to be checked upon transfer comple
tion; if it exists then the transfer is considered 
successful. 
The FTP application should to do the following things if the check file is not found: 
• keep the failed files; 
• raise "file transfer failure" error condition (i.e. send alarm to the corresponding LEA); 
• the data can be buffered for a time that the buffer size allows. If that would finally be exhausted, DF would 
start dropping the corresponding target's data until the transfer failure is fixed; 
• the transmission of the failed files is retried until the 
transfer eventually succeeds. Then the DF would again 
start collecting the data; 
• upon successful file transfer the sent files are deleted from the DF. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)135 The FTP server at LEMF is not allowed anonymous login of an FTP client. 
It is required that FTP implementation guarantees that LEMF will start processing data only after data transfer is 
complete. 
The following implementation example addresses a particular issue of FTP implementation. It is important however to 
highlight that there are multiple ways of addressing the problem in question, and therefore the given example does not 

in any way suggest being the default one. 
• MF sends data with a filename, which indicates that the file is temporary. Once data transfer is complete, MF 
renames temporary file into ordinary one (as defined in clause F.3.2.2). 
 The procedure for renaming filename should be as follow: 
1) open FTP channel (if not already open) from MF to LEMF; 

2) sends data to LEMF using command "put" with temporary filename; 
3) after MF finished to send the file, renaming it as ordinary one with command "ren".  
 Brief descriptions for the FTP commands used in the example: 
ren <from-name> <to-name> renaming filename from-name to to-name. 
 If the ftp-client want to send file to LEMF using the command "mput" (e.g. MF stored many IRI files and want 
to send all together with one command), every file
name transferred successfully is renamed each after 
command "mput" ended. 
F.3.2.4 Exceptional procedures 
Overflow at the receiving end (LEMF) is av
oided due to the nature of the protocol. 
In case the transit network or receiving end system (LEMF) 
is down for a reasonably short time period, the local 
buffering at the MF will be sufficient as a delivery reliability backup procedure. 
In case the transit network or receiving end system (LEMF) is down for a very long period, the local buffering at the 
MF may have to be terminated. Then the following intercepted data coming from the intercepting nodes towards the MF 

would be discarded, until the transit network or LEMF is up and running again. 
F.3.2.5 CC contents for FTP 
F.3.2.5.1 Fields 
The logical contents of the CC-header are described here. 
CC-header 
= (Version, HeaderLength, PayloadLength, Payl
oadType, PayloadTimeStamp, PayloadDirection, 
CCSeqNumber, CorrelationNumber, LIID, PrivateExtension). 
The Information Element CorrelationNumber forms the means to correlate the IRI and CC of the communication 
session intercepted. 
The first column indicates whether the Information Element (IE) referred is Mandatory, Conditional or Optional. 

The second column is the Type in decimal. 
The third column is the length of the Value in octets. 
(Notation used in table F.3.5: M = Mandatory, O = Optional, C = Conditional.)
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)136 Table F.3.5: Information Elements in the fist version of the CC header 
Mode Type
 Length Value M 130 2 
Version = The version number of the format version to be used. This field has a decimal 
value, this enables version changes to the format version. The values are allocated 
according to national conventions. 
O 131 2 
HeaderLength
 = Length of the CC-header up to the start of the payload in octets. 
(This field is optional since it is useful only in such cases that these information elements 
would be transferred without a dynamic length encapsulation that contains all the length 

information anyway. This field could be needed in case of e.g. adapting to a local 
encapsulation convention.) 
O 132 2 
PayloadLength
 = Length of the payload following the CC-header. 
(This field is optional since it is useful only in such cases that these information elements 
would be transferred without a dynamic length encapsulation that contains all the length 
information anyway. This field could be needed in case of e.g. adapting to a local 

encapsulation convention.) 
M 133 1 
PayloadType
 = Type of the payload, indicating the type of the CC. Type of the payload. 
This field has a decimal value. The possible PDP Type values can be found in the 
standards, e.g. 3GPP TS 09.60 [45]. The value 255 is reserved for future PDP Types and 

means: "Other". 
O 134 4 
PayloadTimeStamp
 = Payload timestamp according to intercepting node. (Precision: 1 s, 
timezone: UTC). Format: Seconds since 1970-01-01 as in e.g. Unix (length: 4 octets). 
C 137 1 
PayloadDirection
 = Direction of the payload data. This field has a decimal value 0 if the 
payload data is going towards the target (i.e. downstream), or 1 if the payload data is being 
sent from the target (i.e. upstream). If this in
formation is transferred otherwise, e.g. in the 
protocol header, this field is not required as mandatory. If the direction information is not 

available otherwise, it is mandatory to include it here in the CC header. 
O 141 4 
CCSeqNumber
 = Identifies the sequence number of each CC packet during interception of 
the target. This field has a 32-bit value.  
M 144 8 or 20 
CorrelationNumber
 = Identifies an intercepted session of the observed target. This can be 
implemented by using e.g. the Charging Id (4 octets, see 3GPP TS 12.15 [49]) with the 
(4-octet/16-octet) Ipv4/Ipv6 address of the PDP context maintaining GGSN node attached 

after the first 4 octets. 
   <Possible future parameters are to be allocated between 145 and 253>. 
O 254 1-25 
LIID = Field indicating the LIID as defined in the present document. This field has a 
character string value, e.g. "ABCD123456". 
O 255 1-N 
PrivateExtension
 = An optional field. The optional Private Extension contains vendor or 
LEA or operator specific information. It is described in 3GPP TS 09.60 [45]. 
   ETSI ETSI TS 101 671 V3.5
.1 (2009
-11)137 Table F.3.6: Information Elements in
 the second version of the CC header 
Mode Type
 Length Value M 130 2 
Version = The version number of the format version to be used. This field has a decimal 
value, this enables version changes to the format version. The values are allocated according 
to national conventions. 
O 131 2 
HeaderLength
 = Length of the CC-header up to the start of the payload in octets. 
(This field is optional since it is useful only in such cases that these information elements 
would be transferred without a dynamic length encapsulation that contains all the length 

information anyway. This field could be needed in case of e.g. adapting to a local 
encapsulation convention.)
 O 132 2 
PayloadLength
 = Length of the payload following the CC-header in octets. 
(This field is optional since it is useful only in such cases that these information elements 
would be transferred without a dynamic length encapsulation that contains all the length 
information anyway. This field could be needed in case of e.g. adapting to a local 

encapsulation convention.) 
M 133 1 
PayloadType 
= Type of the payload, indicating the type of the CC. Type of the payload. This 
field has a decimal value. The possible PDP Type values can be found in the standards 
(e.g. 3GPP TS 29.060 [60]). The value 255 is reserved for future PDP Types and means: 

"Other".
 O 134 4 
PayloadTimeStamp
 = Payload timestamp according to intercepting node. (Precision: 1 
second, timezone: UTC). Format: Seconds since 1970-01-01 as in e.g. Unix (length: 4 octets). 
C 137 1 
PayloadDirection
 = Direction of the payload data. This field has a decimal value 0 if the 
payload data is going towards the target (i.e. downstream), or 1 if the payload data is being 
sent from the target (i.e. upstream). If this in
formation is transferred otherwise, e.g. in the 
protocol header, this field is not required as mandatory. If the direction information is not 

available otherwise, it is mandatory to include it here in the CC header. 
O 141 4 
CCSeqNumber
 = Identifies the sequence number of each CC packet during interception of 
the target. This field has a 32-bit value.  
M 144 8 or 20 
CorrelationNumber 
= Identifies an intercepted session of the observed target. This can be 
implemented by using e.g. the Charging Id (4 octets, see EN 300 097-1 [14]) with the 
(4-octet/16-octet) Ipv4/Ipv6 address of the PDP context maintaining GGSN node attached 

after the first 4 octets.
    <Possible future parameters are to be allocated between 145 and 250> 
M 251 2 
MainElementID
 = Identifier for the TLV element that encompasses one or more 
HeaderElement-PayloadElement pairs for intercepted packets.  
M 252 2 
HeaderElementID
 = Identifier for the TLV element that encompasses the CC-header of a 
PayloadElement.  
M 253 2 
PayloadElementID
 = Identifier for the TLV element that encompasses one intercepted 
Payload packet.  
O 254 1-25 
LIID = Field indicating the LIID as defined in the present document. This field has a character 
string value, e.g. "ABCD123456".
 O 255 1-N 
PrivateExtension
 = An optional field. The optional Private Extension contains vendor or LEA 
or operator specific information. It is described in 3GPP TS 29.060 [60]. 
 F.3.2.5.2 Information Element syntax 
The dynamic TypeLengthValue (TLV) format is used for its ease of implementation and good encoding and decoding 
performance. Subfield sizes: Type = 2 octets, Length = 2 octets and Value = 0–N octets. From Length the T and L 

subfields are excluded. The Type is different for every different field standardized. 
The octets in the Type and Length subfields are ordered in the little-endian order, (i.e. least significant octet first). Any 
multioctet Value subfield is also to be interpreted as 
being little-endian orde
red (word/double word/long word) when it 
has a (hexadecimal 2/4/8-octet) numeric value, instead of bei
ng specified to have an ASCII character string value. This 
means that the least significant octet/word/double word is then sent before the more significant octet/word/double word. 
TLV encoding: 
Type (2 octets)
 Length (2 octets)
 Value (0-N octets)
    ETSI ETSI TS 101 671 V3.5.1 (2009
-11)138 TLV encoding can always be applied in a nested fashion for structured values. 
       
T L V T L V TLV TLV TLV TLV 
        
 NOTE: The small "
V" refers to the start of a Value field that has inside it a nested structure. 
 In figure F.3.1, the TLV structure for GPRS HI3 transfer is presented for the case that there is just one intercepted 
packet inside the CC message. (There can be more CC Header IEs and CC Payload IEs in the CC, if there are more 

intercepted packets in the same CC message.) 
(2 octets)
 MainElementID
CC Length
CC(2 octets)
(N octets)
(2 octets)
 HeaderElem.ID
HeaderLength
Header Value
(2 octets)
(N octets)
(2 octets)
 PayloadElem.ID
PayloadLength
Payload Value
(2 octets)
(N octets)
CC Payload IE
CC Header IE
(2 octets)
VersionID
Length
Version
(2 octets)
(2 octets)
(2 octets)
PrivateExt.ID
Length
PrivateExtension
(2 octets)
(N octets)
PrivateExtension IE
Version IE
Intercepted data packet
(The other IEs inside the CC Header
Value field are here between)
CC Information Element
 Figure F.3.1: IE structure of a CC message that contains one intercepted packet 
The first octet of the first TLV element will start right after the last octet of the header of the protocol that is being used
 to carry the CC information. 
The first TLV element (i.e. the main TLV IE) comprises the whole dynamic length CC information, i.e. the dynamic 
length CC header and the dynamic length CC payload. 
Inside the main TLV IE there are at least 2 TLV elements: the Header of the payload and the Payload itself. The Header 
contains all the ancillary IEs related to the intercepted CC packet. The Payload contains the actual intercepted packet. 
There may be more than one intercepted packet in one GPRS HI3 delivery protocol message. If the Value of the main 
TLV IE is longer than the 2 (first) TLV Information Elements inside it, then it is an indication that there are more than 

one intercepted packets inside the main TLV IE (i.e. 4 or more TLV IEs in total). The number of TLV IEs in the main 

TLV IE is always even, since for every intercepted packet there is one TLV IE for header and one TLV IE for payload. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)139 F.3.2.6 Other considerations 
The FTP protocol mode parameters used: 
• transmission mode: stream; 
• format: non-print; 
• structure: file-structure; 
• type: binary. 
The FTP service command to define the file system function at the server side: STORE mode for data transmission. 
The FTP client- (= user - FTP process at the MF) uses e.g. 
the default standard FTP ports 20 (for data connection) and 
21 (for control connection), "passive" mode is supported. The data transfer process listens the data port for a connection 

from a server-FTP process. 
For the file transfer from the MF to the LEMF(s) e.g. the following data transfer parameters are provided for the FTP 
client (at the MF): 
• transfer destination (IP) address, e.g. "194.89.205.4"; 
• transfer destination username, e.g. "LEA1"; 
• transfer destination directory path, e.g. "/usr/local/LEA1/1234-8291"; 
• transfer destination password; 
• interception file type, e.g. "2" (this is needed only if the file naming method A is used). 
LEMF may use various kind directory structures for the recep
tion of interception files. It 
is strongly recommended that 
at the LEMF machine the structure and access and modification ri
ghts of the storage directories are adjusted to prevent 
unwanted directory operations by a FTP client. 
The use of IPSec services for this interface is recommended. 
Timing considerations for the FTP transmission: 
The MF and LEMF sides control the timers to ensure reliabl
e, near-real time data transfer. The transmission related 
timers are defined within the lower layers of the used protocol and are out of scope of the present document. 
The following timers may be used within the LI application. 
Name
 Controlled by
 Units Description
 T1 inactivity timer 
LEMF Seconds 
Triggered by no activity within the FTP session (no new files). 
The FTP session is torn down when the T1 expires. To send 

another file the new connection will be established. The timer 
avoids the FTP session overflow at the LEMF side. 
T2 send file trigger 
MF Milliseconds 
Forces the file to be transmitted to the LEMF (even if the size 
limit has not been reached yet in case of volume trigger active). If 

the timer is set to 0 the only trigger to send the file is the file size 
parameter (see clause C.2.2). 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)140 Annex G (informative): 
LEMF requirements - handling of unrecognized fields and 
parameters 
During decoding of a record at the LEA, the 
following exceptional situations may occur: 
1) Unrecognized parameter: The parameter layout can be recognized, but its name is not recognized: 
The parameter is ignored, the processing of the record proceeds. 
2) The parameter content or value 
is not recognized or not allowed: 
The parameter is ignored, the processing of the record proceeds. 
3) The record cannot be decoded (e.g. it seems to be corrupted): 
The whole record is rejected when using ROSE delivery mechanism or ignored. 
NOTE: In cases 2 and 3, the LEMF may wish to raise 
an alarm to the NWO/AP/SvP
 administration centre. For 
case 1, no special error or alarm procedures need 
be started at the LEA because the reason may be the 
introduction of a new version of the specification in the 
network, not be an error as such security aspects. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)141 Annex H (informative): 
IP Multimedia Subsystem (IMS) handover 
This annex deals with IRI reporting in the IMS. IRI reporting in multi-media domain specified in this clause does not 
depend on the IP-Connectivity Access Network IP-CAN 3GPP TS 23.228 [70] used to transport the CC. When the 

IP-CAN is the UMTS PS domain, annex B applies for CC interception at the SGSN/GGSN. 
According to 3GPP TS 33.107 [71], interception has to be supported in P-CSCF and S-CSCF. For the identification of 
the intercepted traffic only the SIP-URL and TEL-URL are available. In the intercepting nodes (CSCFs) the relevant 

SIP-Messages are duplicated and forwarded to the MF HI2. 
For clarification see figure H.1. If P-CSCF and S-CSCF are 
in the same network the events are sent twice to the LEMF. 
Visited /Home Network
S-CSCF
P-CSCF
GGSN
SGSN
DF2
MF HI2
LEMF
CCIRI DF3
MF HI3
HI 2
HI3
 NOTE: GGSN interception is a national option. 
Figure H.1: IRI Interception at a CSCF 
H.1 Specific identifiers for LI 
Specific identifiers are necessary to identify a target for interception uniquely and to correlate between the data, which 
is conveyed over the different handover interfaces (HI2 an
d HI3). The identifiers are defined in the clauses below. 
For the delivery of CC and IRI the SGSN, GGSN and CSCFs (Call Session Control Function) provide correlation 
numbers and target identities to the HI2 and HI3. The correlation number provided in the PS domain (SGSN, GGSN) is 

unique per PDP context and is used to correlate CC with IRI and the different IRIs of one PDP context. 
Interception is performed on an IMS iden
tifier(s) associated with the intercept 
subject including identifiers such as 
SIP-URL and Tel-URL, RFC 3966 [68]. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)142 H.1.1 Lawful interception identifier 
For each target identity related to an
 interception measure, the 
authorized operator (NWO/AP/SvP) assigns a special 
LIID, which has been agreed between the LEA and the operator (NWO/AP/SvP). 
Using an indirect identification, pointing to a target identity makes it easier to keep the knowledge about a specific 
interception target limited within the authorized operator (NWO/AP/SvP) and the handling agents at the LEA. 
The LIID is a component of the CC delivery procedure and of
 the IRI records. It is used within any information 
exchanged at the handover interfaces HI2 and 
HI3 for identification and correlation purposes. 
The LIID format consists of alphanumer
ic characters. It might for example, among other information, contain a lawful 
authorization reference number, and the date, when the lawful authorization was issued. 
The authorized operator (NWO/AP/SvP) is either enter, based on an agreement with each LEA, a unique LIID for each 
target identity of the interception subject or a single LIID for multiple target identities all pertaining to the same 

interception subject. 
Note that, in order to simplify the use of the LIID at LEMF for the purpose of correlating IMS signalling with GSN CC, 
the use of a single LIID in association with potentially numerous IMS identities (SIP and TEL URIs) is recommended. 
If more than one LEA intercepts the same target identit
y, there are unique LIIDs assigned relating to each LEA. 
In case the LIID of a given target has different values in th
e GSN and in the CSCF, it is up to the LEMF to recover the 
association between the two LIIDs. 
H.1.2 Network identifier 
The network identifier (NID) is a mandatory parameter; it should be internationally unique. It consists of the following 

two identifiers. 
1) Operator- (NWO/AP/SvP) identifier (mandatory): 
Unique identification of network operator, 
access network provider or service provider. 
2) Network element identifier NEID (optional): 
The purpose of the network element identifier is to uniquely identify the relevant network element carrying out 
the LI operations, such as LI activation, IRI record sending, etc. 
 A network element identifier may be an IP address or other identifier. 
H.1.3 Correlation number 
The GPRS Correlation Number is unique per PDP context and used for the following purposes: 
• correlate CC with GPRS Support Node (GSN) IRI; 
• correlate different GSN IRI records within one PDP context. 
As an example, in the UMTS system, the GPRS Correlation Number may be the combination of GGSN address and 
charging ID. 
NOTE 1: It is an implementation matter how CSCF generates Correlation number value. However, in this release 
CSCF should use gPRSCorrelationNumber ASN.1 parameter as a container. 
If two PDP contexts are used for the communication (one 
for signalling and one for bearer) also two correlation 
numbers may be delivered via the CSCFs. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)143 Different identifiers may be used for correlating target's various SIP messages such as: 
• LIID; 
• implementation dependent number. 
NOTE 2: The implementation dependent number may be 
e.g. a "Call-id". However, when CSCF acts as a 
back-to-back user agent CSCF can have different "Call-id" values for different legs of signalling. 

Therefore some other number would be needed in such a case. 
NOTE 3: The LIID may be used to associate SIP messages 
with respective GSN IRI records. In case the target has 
a single SIP session active, the LIID is sufficient to
 correlate IMS IRI records with GSN IRI records. In 
case the target has multiple SIP sessions active, a combination of the LIID and an 
implementation 
dependent number may be used to correlate th
e IMS IRI records with the GSN IRI records. 
In case the LIID of a given target has different values in th
e GSN and in the CSCF, it is up to the LEMF to recover the 
association between the two LIIDs. 
SIP correlation number is used to correl
ate events of one specific SIP session. 
H.1.4 IRI for IMS 
In addition, information on non-transmission related actions of a target constitute IRI and is sent via HI2, 
e.g. information on subscriber controlled input. 
The IRI may be subdivided into the following categories: 
1) Control information for HI2 (e.g. correlation information). 
2) Basic data context information, for standard data transmission between two parties (e.g. SIP-message). 
For each event, a Record is sent to th
e LEMF, if this is required. The following table gives the mapping between event 
type received at DF2 level and record type sent to the LEMF. 
Table H.1.1: Mapping between IMS Events and HI2 Records Type 
Event
 IRI Record Type
 SIP-Message REPORT 
 A set of information is used to generate the record. The r
ecords used transmit the informat
ion from mediation function 
to LEMF. This set of information can be extended in the CSCF or DF2 MF, if new IEs are available and if this is 
necessary in a specific country. The following table gives the mapping between information received per event and 
information sent in records. 
Once IRI only interception is underway, LEMF receives 
IMS specific IRI only (SIP IRI) from CSCF. LEMF does not 
receive CC, and therefore it is not possibl
e to correlate IMS specific IRI with CC. 
Once IRI and CC interception is underway, LEMF receive
s IMS specific IRI both from a GSN and from a CSCF. 
LEMF receives SIP messages also from a GSN within CC. In
 certain cases, however, SIP messages within CC may be 
encrypted between UE and CSCF. In these cases LEMF need
s to receive unencrypted SIP IRI straight from CSCF. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)144 Table H.1.2: Mapping between IMS Events Information and IRI Information 
Parameter Description
 HI2 ASN.1 parameter
 Observed SIP URI Observed SIP URI partyInformation (sip-uri) 
Observed TEL URL Observed TEL URL partyInformation (tel-url) 
Event type IMS Event iMSevent 
Event date Date of the event generation in the CSCF timeStamp 
Event time Time of the event generation in the CSCF  
Network identifier Unique number of the intercepting CSCF networkIdentifier 
Correlation number 
Unique number for each PDP context delivered to the 
LEMF, to help the LEA, to have a correlation between 

each PDP Context and the IRI. Parameter of Rel. 5 and 
on  gPRSCorrelationNumber 
Correlation 
Correlation number; unique number for each PDP 
context delivered to the LEMF, to help the LEA, to have 
a correlation between each PDP Context and the IRI. 
ASN.1 as: iri-to-CC 

 
Signalling PDP context correlation number; unique 
number for signalling PDP context delivered to the 
LEMF, to help the LEA, to have a correlation between 

each PDP Context and the IRI. 

Used in the case two PDP contexts are used. 
ASN.1 as: iri-to-CC 
 
SIP correlation number; either Call-id or some 

implementation dependent number that uniquely identify 
SIP messages of the same SIP session. 
ASN.1 as: iri-to-iri 
correlation 
Lawful interception 
identifier 
Unique number for each lawful authorization. lawfulInterceptionIdentifier 
SIP message 
Either whole SIP message, or SIP message header 
(plus SDP body, if any). SIP message header (plus 
SDP) is used if warrant requires only IRI. In such case, 
specific content in the SIPMessage (e.g. "Message", 

etc.) is deleted; unknown headers are not deleted. 
sIPMessage 
 NOTE 1: LIID parameter is present in each record sent to the LEMF. 

NOTE 2: Details for the parameter SIP message. If the warrant requires only signalling information, specific 
content in the parameter "SIP message" like IMS (Immediate Messaging) has to be deleted/filtered. 
NOTE 3: In case of IMS event reporting, the gPRSCorrelationNumber HI2 ASN.1 parameter, which is also used in 
the IRIs coming from PS node
s, is used as container. 
H.1.4.1 Events and information 
This clause describes the information sent from the Delivery Function (DF) to the Law Enforcement Monitoring 
Facility (LEMF) to support Lawfully Authorized Electroni
c Surveillance (LAES). The information is described as 
records and information carried by a reco
rd. This focus is on describing the information being transferred to the LEMF. 
The IRI events and data are encoded into records as defined in the table H.1.1 Mapping between IMS Events and HI2 
Records Type and clause B.3 Intercept related information (HI2). IRI is described in terms of a "causing event" and 

information associated with that event. Within each IRI Re
cord there is a set of events and associated information 
elements to support the particular service. 
The communication events described in table H.1.1: Mapping between the IMS Event and HI2 Record Type and 
table H.1.2: Mapping between IMS Events Information and 
IRI Information convey the basic information for reporting 
the disposition of a communication. This clause describes those events and supporting information. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)145 Each record described in this cl
ause consists of a set of parameters. Each parameter is either: 
Mandatory (M): required for the record; 

Conditional (C): required in situations where a condition is met (the condition is given in the Description); or 

Optional (O): provided at the discretion of the implementation. 
The information to be carried by each parameter is identified. Both optional and conditional parameters are considered 
to be OPTIONAL syntactically in ASN.1 Stage 3 descriptions. The Stage 2 inclusion takes precedence over Stage 3 
syntax. 
Table H.1.3: SIP-Message REPORT Record 
Parameter MOC
 Description/Conditions
 observed SIP-URI C SIP URI of the interception target (if available) 
observed TEL-URL C TEL URL of the interception target (if available) 
event type M Provide IMS event type 
event date 
M Provide the date and time the event is detected 
event time 
network identifier M To be provided 
lawful intercept identifier M To be provided 
correlation number O If available and not included in the SIP-message 
correlation O If applicable for this communication 
SIP message M The relevant SIP message or SIP message header 
 H.1.5 Correlation indications of IMS IRI with GSN CC at the LEMF 
This clause is informative and provides some guidelines 
pertaining to correlating IMS IRI with GSN CC at the LEMF. 
For IMS-enabled multimedia communication s
cenarios involving a lawful intercept target, it will be necessary for the 
LEMF to be able to correlate the media streams (as provided in the CC intercepted by the GSN) with the specific SIP 
signalling (as provided in the IRI intercepted by the CSCFs) used to establish those media streams. The principal reason 

for this is that the Session Description Protocol (SDP) content within the SIP signalling may provide the information 

required to even be able to decode the media streams. In 
certain cases, for example, the information in the RTP header 
within the media stream packets may not be sufficient to
 be able to determine the specific encoding used. The SDP 
portion of the SIP signalling would need to provide this information. Another important reason is that the SIP signalling 
provides information about the participants
 in a SIP session (other than the targ
et) sending and receiving the associated 
media streams. The LIID parameter in the IMS IRI and GSN CC can be used to correlating all of the IMS IRI and all of 

the GSN CC associated with a particular target. If a single LIID is used in association all of the target's IMS identities 

(as per a NWO/AP/SvP agreement with the LEA), the proce
ss of associating the IMS IRI and GSN CC information is 
fairly straightforward. If, however, multiple LIIDs are used (e.g. one per IMS identity) then the LEMF needs to be able 

to associate each of the LIIDs that may be used for the IMS IRI with the LIID used for the CC. 
The SIP messages provided to the LEMF would contain a number of additional items of information that could be 
relevant with respect to supporting correlations of various types. Their potential role in correlating IMS IRI and GSN 

CC (or, more specifically, correlating SIP dialogs with media streams) is discussed below: 
• Call-ID, From tag, To tag:
 These SIP headers would identify differ
ent SIP messages belonging to the same 
SIP dialog (a call leg between the target user and a peer 
SIP user). It should be noted that the Call-ID alone is 
not sufficient to identify a dialog. Correlating specific SIP dialogs with specific media streams is the principal 
objective of this discussion. 
• P-Charging-Vector (IMS Charging ID):
 The principal purpose of the IMS Charging ID (ICID) in IMS is to 
correlate charging information provided by different network entities for the same call. The ICID could be 

useful in correlating SIP messages belonging to the same cal
l, even if their SIP dialog identifiers are modified 
(e.g. by a B2BUA application server). It should be note
d, however, that the use of the ICID is not necessary 
for the purpose of correlating SIP dialogs and the corresponding media streams. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)146 • P-Charging-Vector (GPRS Charging ID, GGSN address):
 GCIDs, along with the GGSN address, may be 
used as identifiers of the PDP contexts. These identifi
ers (one for each PDP context used by the SIP session) 
are made available to the P-CSCF and subsequently to
 the S-CSCF. They could be used to correlate SIP 
messages with the PDP context(s) used. For the purpos
e of correlating SIP dialogs with media streams, this 
type of correlation would be useful, although not essential. 
• SDP Connection addresses and ports:
 The address and port information within the SDP of the SIP messages 
need to be matched with the addresses and ports corresponding to the media streams as provided in the CC 
reports. This implies a need to look both at the SDP co
ntent of the SIP messages as well as in the packets 
provided by the GSN. The set of PDP context identifier
s included in the P-Charging-Vector could be used to 
simplify the search for a match. It should also be no
ted that the SDP contained in the SIP message may also 
include essential information about the encoding of each of the media streams, without which it may not be 
possible to decode. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)147 Annex I (informative): 
Latest ASN.1 module versions 
This annex is listing the ASN.1 modules with the actual version numbers as defined in annex D. In case of any 
discrepancy the definitions given in annex D are the valid ones. This annex is just a summary of the ASN.1 modules. 

TR 102 503 [i.4] gives a complete overview over the relevant Object Identifiers (OID) used in ASN.1 modules of the 
Lawful Intercept specifications and point to th
e specification where the modules can be found. 
Defined in clause D.3: 
HIManagementOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) him(3) version3(3)} Current version is 3. 
Defined in clause D.4: 
HI1NotificationOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi1(0) notificationOperations(1) version6(6)} Current version is 6. 
Defined in clause D.5: 
HI2Operations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) version11(11)} Current version is 11. 
Defined in clause D.6: 
HI3CircuitDataOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) circuitLI(1) version3(3)} Current version is 3. 
Defined in clause D.7 and clause A.9.1: 
EN301040 {{itu-t(0) identified-organization(4) etsi(0) en301040(1040) interceptVersion(0)}} Current version is 0. 
Defined in clause D.8: 
HI3CCLinkData {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) cclinkLI(4) version4(4)} Current version is 4. 
Defined in clause D.9: 
Gprs-HI3-PS {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) gPRSLI(3) version3(3)} Current version is 3. 
Defined in clause D.10.1: 
TETRA-HIManagementOperations  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulintercept(2) tetra(6) him(3) version0(0)} Current version is 0. 
Defined in clause D.10.2: 
TETRA-HI1NotificationOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) tetra(6) hi1(1) notificationOperations(1) version0(0)} Current version is 0. 
Defined in clause D.10.3: 
TETRA-HI2Operations  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) tetra(6) hi2(2) version0(0)} Current version is 0. 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)148 Annex J (informative): 
Bibliography 
ETSI EN 300 052-1: "Integrated Services Digital Network (ISDN); Multiple Subscriber Number (MSN) supplementary 
service; Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 300 055-1: "Integrated Services Digital Network 
(ISDN); Terminal Portability (TP) supplementary service; 
Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 300 058-1: "Integrated Services Digital Network (ISDN); Call Waiting (CW) supplementary service; Digital 
Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 300 064-1: "Integrated Services Digital Network (ISDN); Direct Dialling In (DDI) supplementary service; 
Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 300 093-1: "Integrated Services Digital Network (ISDN); Calling Line Identification Restriction (CLIR) 
supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 300 141-1: "Integrated Services Digital Network (ISDN); Call Hold (HOLD) supplementary service; Digital 
Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 300 210-1: "Integrated Services Digital Network (ISDN); Freephone (FPH) supplementary service; Digital 
Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 300 359-1: "Integrated Services Digital Network (ISDN); Completion of Calls to Busy Subscriber (CCBS) 
supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 300 745-1: "Integrated Services Digital Network (ISDN); Message Waiting Indication (MWI) supplementary 
service; Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 301 001-1 (V1.2.2): "Integrated Services Digital Network (ISDN); Outgoing Call Barring (OCB) 
supplementary services; Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 301 065-1 (V1.2.2): "Integrated Services Digital Network (ISDN); Completion of Calls on No Reply (CCNR) 
supplementary service; Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ITU-T Recommendation Q.699: "Interworking between ISDN access and non-ISDN access over ISDN User Part of 
Signalling System No. 7". 
ITU-T Recommendation I.210: "Principles of telecommunication services supported by an ISDN and the means to 
describe them". 
ETSI EN 300 138-1: "Integrated Services Digital Network (ISDN); Closed User Group (CUG) supplementary service; 
Digital Subscriber Signalling System No. one (DSS1) protocol; Part 1: Protocol specification". 
ETSI EN 301 344: "Digital cellular telecommunications system (Phase 2+) (GSM); General Packet Radio Service 
(GPRS); Service description; Stage 2 (GSM 03.60)". 
IETF RFC 2228: "FTP Security Extensions". 
IANA Private Enterprise numbers: 
http://www.iana.org/assignments/enterprise-numbers
. ITU-T Recommendation X.881: "Information technology - Remote Operations: OSI realizations - Remote Operations 
Service Element (ROSE) service definition". 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)149 Annex K (informative): 
Change Request history 
Status of the present document: TS 101 671
 Handover interface for the lawful interception of telecommunications traffic 
Date
 Version Remarks
 July 1999 
Ed 1 
Publication as ES 201 671 first Edition (v1.1.1) 
September 2001 
Ed 2 
Publication as ES 201 671 second Edition (v2.1.1) 
July 2001 1.1.1 TS version of ES 201 671 v2.1.1 (see note 1) 
December 2001 2.2.1 
Included Change Requests: 
TS101671CR001 (category D) on Removal of reference to TR 101 876 

TS101671CR002 rev1 (category D) on Example on missing information 
TS101671CR003 (category D) on Sending of IRI-END and IRI-CONTINUE records 
TS101671CR004 (category D) on Moving GPRS related text from main body to annex B 

TS101671CR005 rev1 (category F) on No additional work on HI1 interface port for 

administrative state 
TS101671CR006 rev1 (category F) on Version indication 
TS101671CR007 rev1 (category F) on No additional identifiers for Packet switched 

network handover 

TS101671CR008 rev2 (category D) on Several editorials 
TS101671CR009 (category F) on UUS1-parameter no
. 6: "bearer capability of target 
call" 

TS101671CR010 rev1 (category D) on Modification of the definition "CC link" 

TS101671CR011 (category D) on Modification of the definition "Internal Network 

Interface": change "mediation device" into "mediation function" 
TS101671CR013 (category D) on Deletion of the definition "mediation device" 
 
all CRs approved by SEC-LI#31 (27-29 November 2001; Wien) 

version 2.2.1 prepared by Peter van der Arend (KPN) (rapporteur) 
April 2002 2.3.1 
Included Change Requests: 
TS101671CR014 rev 2 (cat F) on annex E, Coding of the Calling Party Number 

TS101671CR015 rev 2 (cat F) on clause D.5 Coordinates 
TS101671CR016 (cat C) on clause D.5 - Exports Capabilities 
TS101671CR017 rev 1 (cat D) on clause C.2.2 - File naming method B; clause F.3.2.2 - 

File naming method B 

TS101671CR018 rev 1 (cat C) on clause D.5 - TimeStamp 
TS101671CR019 (cat F) on Correction of superfluous spaces in ASN.1 coding 
TS101671CR021 (cat D) on Reintroduction of deleted references 

TS101671CR022 rev 2 (cat F) on Aligning ETSI TS 101 671 with 3GPP TS 33.108 [61] 

TS101671CR025 (cat F) on Correction of Misalignment between the text and the ASN.1 
 all CRs approved by SEC-LI#32 (19-21 March 2002, Sophia Antipolis) 

version 2.3.1 prepared by Peter van der Arend (KPN) (rapporteur) 
June 2002 2.4.1 
Included Change Requests: 
TS101671CR026 (cat F) on Correcting "ccitt" into "itu-t" in ASN.1 Object Tree 

TS101671CR027 rev 1 (cat C) on Missing ISUP parameter in version 1 

TS101671CR028 rev 1 (cat B) on Use of the object identifier within the IRI 
TS101671CR030 rev 1 (cat B) on Extension/alignment of ASN.1 module with 33.108 
TS101671CR031 (cat F) on Missing/old reference 

TS101671CR032 rev 2 (cat B) on ASN.1 alignment with the UMTS module 

TS101671CR033 (cat B) on Adding a graphical ASN.1- Object tree 
 all CRs approved by SEC-LI#33 (18-20 June 2002, Sophia Antipolis); 

version 2.4.1 prepared by Peter van der Arend (KPN) (rapporteur) 
October 2002 2.5.1 
Included Change Requests: 
TS101671CR034 rev 1 (cat B) on Aggregation of IRI Records 

TS101671CR036 (cat F) on ASN.1 version number 

TS101671CR037 rev 1 (cat F) on Missing pDPContextModification parameter 

TS101671CR038 rev 1 (cat F) on Missing ggsnAddress parameter 
 all CRs approved by TC LI#01 (15-17 October 2002, Dublin); 

version 2.5.1 prepared by Peter van der Arend (KPN) (rapporteur) 

 Including editorial modifications by ETSI 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)150 Status of the present document: TS 101 671
 Handover interface for the lawful interception of telecommunications traffic 
Date
 Version Remarks
 March 2003 2.6.1 
Included Change Requests: 
TS101671CR035 (cat F) on Coding of ASN.1 parameters of the type OCTET STRING 

TS101671CR039r1 (cat C) on Composition of Calling Party Subaddress 
TS101671CR041 (cat C) on Additional value direction indication (PARTLY) 
TS101671CR042r2 (cat F) on Data Link Establishment and Sending part for ROSE 

operation 

TS101671 CR043r1 (cat C) on Clarification of definitions of sequence number and 
communication identity number 
TS101671CR045 (cat C) on HI3 delivery of CC 

TS101671CR046r1 (cat D) on Field separator in subaddress 

TS101671CR047r1 (cat F) on Essential correction to the LI events generated during 
RAU when PDP context is active 
TS101671CR048r2 (cat F) on Adjustments to the requirements on the delivery of the 

intercepted RT data over TCP 

 all CRs approved by TC LI#02 (4-6 March 2003, Benalmádena); 
 
See note 2. 

 TS101671CR044r1 (cat C) on Additional value antenna direction GSM location 
information 

TS101671CR049 (cat C) on CallingPartyNumber and mAP-Format 

 
version 2.6.1 prepared by Peter van der Arend (KPN) (rapporteur) 
June 2003 2.7.1 
agreed CRs in TC LI#02: 049, 041(partly) were put on hold because of changes to 
ASN.1 and these ASN.1 parts are included now (CRs 044r1 was modified): 

TS101671CR041 (cat C) on Additional value direction indication (PARTLY) 
TS101671CR049 (cat C) on CallingPartyNumber and mAP-Format 
 
Included Change Requests: 

TS101671CR044r3 (cat C) on Additional value antenna direction GSM location 
information 
TS101671CR050 (cat C) on Precision about Services-Information field 

TS101671CR051 (cat F) on Use of identifiers, elimination of "CC only" delivery option 

these CRs were approved by TC LI#03 (3-5 June 2003, Copenhagen); 
 Involved ASN.1 modules: 

HI2Operations ->v4 

HI3CCLinkData ->v3 
 version 2.7.1 prepared by Peter van der Arend (KPN) (rapporteur) 
October 2003 2.8.1 
Included Change Request: 
TS 101 671CR052r1 (cat F) on Inconsistency regarding definition of CIN length 
this CR was approved by TC LI#04 (14-16 October 2003, Moscow); 

 
version 2.8.1 prepared by Peter van der Arend (KPN) (rapporteur) 
March 2004 2.9.1 
Included Change Requests: 
TS101671CR054 (cat D) Editorials to clause C.1.2.1 

TS101671CR055 (cat D) Removal of superfluous spaces from ASN.1 description 
TS101671CR056r2 (cat B) Introduction of national parameters in the him module 
TS101671CR058r1 (cat B) Introduction of national ASN.1 coded parameters in HI2 

TS101671CR059 (cat D) Correction of the Routing Area Identifier 

TS101671CR060 (cat D) Correction of wrong use of abbreviations 
TS101671CR061 (cat D) Alignment names of RO-operations 
TS101671CR062r1 (cat B) Decoding HI1 Notification and HI2 IRI-Parameters FTP file 

TS101671CR063r1 (cat F) WGS 84 Coordinates updates 

TS101671CR064r2 (cat D) Editorial corrections to CS domain 

TS101671CR065 (cat F) Correction to the reference for Called Party Number 
TS101671CR066r2 (cat C) Field separator in subaddress 
TS101671CR068 (cat F) No SMS content in case of IRI only 

TS101671CR069r3 (cat F) Correction of the Subaddressing definitions 

These CRs were approved by TC LI#05 (23-25 March 2004, Oxford); 
 version 2.9.1 prepared by Peter van der Arend (KPN) (rapporteur) 
  ETSI ETSI TS 101 
671 V3.5.1 (2009
-11)151 Status of the present document: TS 101 671
 Handover interface for the lawful interception of telecommunications traffic 
Date
 Version Remarks
 July 2004 2.10.1 
Included Change Request: 
TS 101 671CR072r4 (cat B) Extensions to the "National-HI2-ASN1parameters" data 

type 
TS 101 671CR073r1 (cat D) Clarifying clause titles 
TS 101 671CR076r2 (cat F) References in TS 101 671 

TS 101 671CR077 (cat B) Nature of the intercepted call 

TS 101 671CR078 (cat F) Served User for CLIP and COLP and other minor correction 
TS 101 671CR079r4 (cat B) Importing CC definition for PS domain from 3GPP module 
TS 101 671CR080r1 (cat D) Spare Octets in the Subaddress in annex E 

TS 101 671CR081 (cat D) ed correction of parameter name "setUpInProcess" 

These CRs were approved by TC LI#06 (22-23 July, Póvoa de Varzim); 
 version 2.10.1 prepared by Peter van der Arend (KPN) (rapporteur) 
September 2004 2.11.1 
Included Change Request: 
TS101671CR082r1 (cat B) Addition of HI2 via to transfer UUS information 
TS101671CR083 (cat D) Explanation concerning the Sequence Number 

TS101671CR084r1 (cat D) Format of the CIN and CC-Link-Identifier 

TS101671CR085 (cat C) Addition of the domainID in the parameter "National-HI1-
ASN1" parameters 
TS101671CR086 (cat C) Addition of the Lawful Interception Identifier in the parameter 

"Alarm-Indicator" 

TS101671CR087 (cat D) New annex listing latest ASN.1 module versions in TS 101 671 

TS 101671 CR088 (cat D) PDP Context modification request 
TS101 671 CR089r2 (cat B) Aligning "IRI-Parameters" with those defined in 
3GPP TS 33.108 [61] 

TS101671CR090 (cat B) Interception of fixed NGN (including PSTN/ISDN emulation) 

and fixed IMS PSTN simulation 
Alignment of latest ASN.1 version of the imported ASN.1 modules 
These CRs were approved by TC LI#07 (28-30 September 2004, Bremen); 

 
version 2.11.1 prepared by Peter van der Arend (KPN) (rapporteur) 
February 2005 
June 2005 
2.12.1 
Included Change Request: 
TS 101 671CR091r2 (cat B) Support of TS 101 909-20 [69] Sub-Part 1 LI parameters 

TS 101 671CR092 (cat F) Correction to GLIC header Œ Alignment with 
 3GPP TS 33.108 [61] 
TS101671CR093 (cat F) References in TS 101 671 

These CRs were approved by TC LI#08 (22-24 February 2005, Kijkduin); 

 TS 101 671CR095 (cat C) Removing the SecurityDomainDefinitions in clause D.2. 
TS 101 671CR096r3 (cat D) Clarification of requirement to assign CIN values by 

relevant network element 

TS 101 671CR097r2 (cat D) Clarification of requirement to provide full IRI for intercepted 
SMS messages, even if some of the information is embedded in the SMS message body 
(IRI for SMS) 

TS101671CR098 (cat F) Updating imports statement for ASN.1 definition of the ULICv1 

header 
TS 101 671CR099r1 (cat F) Alignment CR for IMS LI 
TS 101 671CR100r2 (cat C) Freezing "iRIversion" parameter in ASN.1 module 

TS 101 671CR102r1 (cat D) Resolution 

TS 101 671CR103 (cat B) New parameters defined in3GPP TS 33.108 [61] 
These CRs were approved by TC LI#09 (28-30 June 2005, Rovaniemi) 
See note 3. 

version 2.12.1 prepared by Peter van der Arend (KPN) (rapporteur) 
October 2005 2.13.1 
Included Change Request: 
TS101671CR101r1 (cat C) Aligning LIID definitions 

TS101671CR105 (cat D) Informative example of FTP implementation across HI2/HI3 

These CRs were approved by TC LI#10 (4-6 October 2005, Sorrento 
 See note 4. 

 version 2.13.1 prepared by Peter van der Arend (KPN) (rapporteur) 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)152 Status of the present document: TS 101 671
 Handover interface for the lawful interception of telecommunications traffic 
Date
 Version Remarks
 February 2006 2.14.1 
Included Change Request: 
TS101671CR104r3 (cat C) Extending table C.2.1 and table F.3.4 for national use 

TS101671CR106r1 (cat D) Explanation on Open Issues 
TS101671CR107 (cat F) Correction on polygon type of shape 
TS101671CR109 (cat F) Handling of unknown SIP headers 

TS101671CR110r1 (cat F) TETRA finalization 

TS101671CR111 (cat F) Re-correcting changes made during publication process 
These CRs were approved by TC LI#11 (30 January - 1 February 2006, Saint Martin. 
 
See note 5. 

 version 2.14.1 prepared by Peter van der Arend (KPN) (rapporteur) 
September 2006  2.15.1 
Included Change Request: 
TS101671CR108r1 (cat B) TISPAN NGN PSTN Emulation Service and PSTN 
Simulation Service Stage 3 description 
TS101671CR112r1 (cat D) Modifications as requested by ETSI EditHelp 

These CRs were approved by TC LI#13 (6-8 September 2006 in Stockholm. 

 See note 6. 
 
version 2.15.1 prepared by Peter van der Arend (KPN) (rapporteur) 
May 2007 
Ed 3 
Publication as ES 201 671 third Edition (v3.1.1) 
June 2007 3.1.1 
TS version of ES 201 671 v3.1.1 as basis for further work 
 
version 3.1.1 prepared by Peter van der Arend (KPN) (rapporteur) 
October 2007  3.2.1 
Included Change Requests: 
TS101671CR114r1 (cat D) Correction of abbreviation and figure in IMS part 

TS101671CR115 (cat D) Add the explanation of characters limitation for specific 
identifiers in subaddress option  
TS101671CR116r3 (cat B) Add mono mode definition 

These CRs were approved by TC LI#15 (23-25 April 2007 in Riga). 

 TS101671CR113r4 (cat D) CC Encryption 
TC101671CR117 (cat D) Tag Values in IRIsContent 

These CRs were approved by TC LI#16 (2-4 October 2007 in Berlin). 

 version 3.2.1 prepared by Peter van der Arend (KPN) (rapporteur) 
January 2008  3.3.1 
Included Change Requests: 
TS101671CR118r1 (cat F) on Clarifications to FTP filenaming conventions 
TS101671CR119 (cat C) on Correction reference to GSM 09.02 
TS101671CR120 (cat B) on Addition of the possibility to provide a target information via 

the HI1 

These CRs were approved by TC LI#17 (22-24 January 2008 in Como). 
 version 3.3.1 prepared by Peter van der Arend (KPN) (rapporteur) 
October 2008 3.4.1 
Included Change Request: 
TS101671CR121r1 (cat F) on Clarification of encoding of Access Point Name (APN) 
This CR was approved by TC LI#19 (30 September Œ 2 October 2008 in Prague). 

 
version 3.4.1 prepared by Peter van der Arend (KPN) (rapporteur) 
September 2009  3.5.1 
Included Change Requests: 
TS101671CR123 (cat D) on Call forwarded description enhancement 

TS101671CR124 (cat C) on Update of FTP table details 
These CRs were approved by TC LI#21 (29 June Œ 1 July 2009 in Sophia Antipolis). 
 
TS101671CR122r2 (cat C) on TETRA details for IRI 

This CR was approved by TC LI#21 (29 June Œ 1 July 2009 in Sophia Antipolis). 

(note 6) 
version 3.5.1 prepared by Peter van der Arend (Vodafone) (rapporteur) 
  ETSI ETSI TS 101 671 V3.5.1 (2009
-11)153 Status of the present document: TS 101 671
 Handover interface for the lawful interception of telecommunications traffic 
Date
 Version Remarks
 NOTE 1: The V1.1.1 of the TS should also have been V2.1.1 (PvdA). 
NOTE 2:  Agreed CRs 044r1, 049, 041(partly) are put on hold because of changes to ASN.1 and will be included in a 
next version if the specification. 
NOTE 3:  Rapporteur: The new imported ASN.1 elements related to the nonpublished versions of 
TS 101 909-20-1 and 3GPP TS 33.108 R7 are put on hold and will be included later in v2.13.1. 
NOTE 4:  The new imported ASN.1 elements related to the non published versions of TS 101 909-20-1 are still not 
included and put on hold and will be included later in v2.14.1. The imported parameters from  
3GPP TS 33.108 R7 are included now in v2.13.1. 
NOTE 5: In v2.14.1 the ASN.1 parameter imported from TS 101 909-20-1 is included now. 

NOTE 6: V2.15.1 is the basis for Edition 3 (v3.1.1) of ES 201 671. 

NOTE 7: In the informative annexes all ﬁshallﬂ and ﬁmustﬂ statements have been ﬁcorrectedﬂ (as required by 
editHelp). 
   ETSI ETSI TS 101 671 V3.5.1 (2009
-11)154 History 
Document history 
V1.1.1 July 2001 Publication  
V2.5.0 November 2002 Publication (Withdrawn) 
V2.5.1 January 2003 Publication 
V2.7.1 September 2003 Publication 
V2.8.1 November 2003 Publication 
V2.9.1 May 2004 Publication 
V2.10.1 September 2004 Publication 
V2.11.1 November 2004 Publication 
V2.12.1 August 2005  Publication 
V2.13.1 January 2006 Publication 
V2.14.1 May 2006 Publication 
V2.15.1 November 2006 Publication 
V3.1.1 June 2007 Publication 
V3.2.1 December 2007 Publication 
V3.3.1 February 2008 Publication 
V3.4.1 January 2009 Publication 
V3.5.1 November 2009 Publication 
 