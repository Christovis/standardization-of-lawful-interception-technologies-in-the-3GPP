 
ETSI ES 201 671 V3.2.1 (2018-05)
 Lawful Interception (LI); 
Handover interface for the lawful interception of 
telecommunications traffic    
 ETSI STANDARD 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 2 

RES/LI-00154 

data, handover, interface, Lawful Interception, 
security, speech 
ETSI 
650 Route des Lucioles 
F-06921 Sophia Antipolis Cedex - FRANCE
 Tel.: +33 4 92 94 42 00   Fax: +33 4 93 65 47 16 
 Siret N° 348 623 562 00017 - NAF 742 C 
Association à but non lucratif enregistrée à la 
Sous-Préfecture de Grasse (06) N° 7803/88 
 Important notice 
The present document can be downloaded from: 
http://www.etsi.org/standards-search
 The present document may be made available in electronic versions and/or in print. The content of any 
electronic and/or 
print versions of the present document shall not be modified 
without the prior written authorization of ETSI. In case of any
 existing or perceived difference in contents between such versions and/or in print, the only prevailing document is the 
print of the Portable Document Format (PDF) version kept on a specific network drive within ETSI Secretariat. 
Users of the present document should be aware that the document may be subject to revision or change of status. 
Information on the current status of this and other ETSI documents is available at 
https://portal.etsi.org/TB/ETSIDeliverableStatus.aspx
 If you find errors in the present document, please send your comment to one of the following services: 
https://portal.etsi.org/People/CommiteeSupportStaff.aspx
 Copyright Notification 
No part may be reproduced or utilized in any form or by any
 means, electronic or mechanical, including photocopying 
and microfilm except as authorized by written permission of ETSI. 
The content of the PDF version shall not be modified without the written authorization of ETSI. 
The copyright and the foregoing restriction extend to reproduction in all media. 
 © ETSI 2018. 
All rights reserved. 
 DECTTM, PLUGTESTSTM, UMTS
TM and the ETSI logo are trademarks of ETSI registered for the benefit of its Members.
 3GPP
TM 
and LTETM are trademarks of ETSI registered for the benefit of its Members and 
of the 3GPP Organizational Partners. 
oneM2M
 logo is protected for the benefit of its Members. 
GSM® and the GSM logo are trademarks registered and owned by the GSM Association. 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 3 Contents 



















































































































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 4 


Annex A (normative):  Circuit switched network handover ............................................................. 30





















































































































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 5 

































































































































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 6 











Annex B (normative):  Packet switched network handover .............................................................. 58

































Annex C (normative):  HI2 Delivery mechanisms and procedures .................................................. 62








































Annex D (normative):  Structure of data at the Handover Interface ............................................... 71
















  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 7 





Annex E (informative):  Use of subaddress and calling party number to carry correlation 
information ..................................................................................................... 94






















Annex F
 (informative):  GPRS HI3 Interface ..................................................................................... 103










































Annex G (informative):  LEMF requirements - handling of unrecognized fields and 
parameters .................................................................................................... 115
Annex H (informative):  IP Multim
edia Subsystem (IMS) handover ............................................... 116























Annex I (informative):  Latest ASN.1 module versions .................................................................... 122
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 8 Annex J (informative):  Bibliography ..........................................................................................
....... 123Annex K (informative):  Change Request history ............................................................................... 
125

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 9 Intellectual Property Rights 
Essential patents  


ETSI members and non-members


"Intellectual Property Rights (IPRs); Essential, or potentially Essential, IPRs notified to ETSI in 
respect of ETSI standards"









Trademarks 








Foreword 


Modal verbs terminology 

shall

shall not

should

should not

may

need not
will

will not

can
cannot




must

must not

NOT

Introduction 






The present document is made historical and is th
erefore no longer ma
intained or revised. It has been 
superseded by ETSI TS 102 232 (all parts) [i.2] and ETSI TS 103 280 [i.3]. 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 10 1 Scope 











• 
 generic flow of information



• 



 
 




2 References 
2.1 Normative references 























  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 11 

































































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 12 








































































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 13 



































































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 14 




























2.2 Informative references 






































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 15 3 Definitions and abbreviations 
3.1 Definitions 
access provider:




activation/deactivation of supplementary services:



(to) buffer:


call:



CC link:



CC Link IDentifier (CCLID): 

communication: 


Communication IDentifier (CID): 

Communication Identity Number (CIN):

communications session: 




Content of Communication (CC):





Handover Interface (HI): 






identity:






information: 



interception: 




  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 16 interception configuration information:

interception interface:




interception measure:


interception subject:


Intercept Related Information (IRI):







Internal Interception
 Function (IIF):



Internal Network Interface (INI):


invocation and operation:











 Law Enforcement Agency (LEA):



Law Enforcement Monitoring Facility (LEMF):


lawful authorization:




Lawful Interception (LI):

Lawful Interception
 IDentifier (LIID):

location information: 


Mediation Function (MF):



 network element:


Network Element IDentifier (NEID): 

Network IDentifier (NID): 

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 17 NetWork Operator (NWO):




PSTN/ISDN Emulation Service:






PSTN/ISDN Simulation Service:





Quality of Service (QoS):





reliability:


result of interception: 






 sequence number: 

service information:




 Service Provider (SvP):


Short Message Service (SMS):


target identity:



target service:




telecommunications:


  ETSI ETSI ES 201 671 V3.2.1
 (2018
-05) 18 3.2 Abbreviations 































































































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 19 







































































































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 20 

















4 General requirements 
4.0 General 



4.1 Basic principles for the Handover Interface 










4.2 Legal requirements 


• 
• 
• 





4.3 Functional requirements 









  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 21 5 Overview of Handover Interface 
5.0 General 





















  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 22  NOTE 1: Figure 1 shows only a reference configuration, with a logical representation of the entities involved in 
lawful interception and does not mandate separate physical entities. 
NOTE 2: The mediation functions may be transparent. 
 Figure 1: Functional block diagram showing Handover Interface HI 
5.1 Handover Interface port 1 (HI1) 
5.1.0 General 


















  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 23 5.1.1 Manual interface 











5.1.2 Electronic interface 





5.2 Handover Interface port 2 (HI2) 























5.3 Handover Interface port 3 (HI3) 

6 Specific identifiers for LI 
6.0 General 







  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 24 6.1 Lawful Interception IDentifier (LIID) 
























6.2 Communication IDentifier (CID) 
6.2.0 General 






• 
• 






6.2.1 Network IDentifier (NID) 



 



 







  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 25 

6.2.2 Communication Identity Number (CIN) - optional 















7 HI1: Interface port for administrative information 
7.0 General 







7.1 Information for the activation of lawful interception 























  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 26 7.2 LI notifications towards the LEMF 







8 HI2: Interface port for In
tercept Related Information 8.0 General 





















8.1 Data transmission protocols 
8.1.0 Introduction 






• 
• 
• 




   ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 27 8.1.1 Application for IRI (HI2 information) 








8.2 Types of IRI records 



























9 HI3: Interface port for Content of Communication 













  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 28 10 Performance and quality 
10.1 Timing 



10.2 Quality 



11 Security aspects 
11.0 General 



11.1 Security properties 

• 
• 
• 
• 
Confidentiality

Integrity

Authentication

Availability




















  ETSI ETSI ES 201 671 V3.2
.1 (2018
-05) 29 11.2 Security mechanisms 


















12 Quantitative aspects 



  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 30 Annex A (normative): 
Circuit switched network handover 
A.0 General 

A.1 Specific identifiers for LI 
A.1.0 General 


A.1.1 CC Link IDentifier (CCLID) 











A.1.2 Circuit switched LI correlation between CC and IRI 



• 
• 
• 

• 
• 
A.1.3 Usage of Identifiers 






  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 31 Table A.1.1: Usage of identifiers, IRI and CC transmitted; options A, B (see clause A.5.4) 
Identifier IRI and CC transmitted (option A)
 IRI and CC transmitted (option B)
  HI1 HI2 HI3 HI1 HI2 HI3 LIID X X X X X X 
NID  X X  X X 
CIN  X X  X X (see note 1) 
CCLID     X X (see note 2) 
NOTE 1: The CIN of the first call for which this CC link has been set-up. 
NOTE 2: The CCLID may be omitted, see clause A.1.1. 
Table A.1.2: Usage of identifiers, only IRI transmitted 
Identifier Only IRI transmitted
  HI1 HI2 LIID X X NID  X CIN  X CCLID   A.2 HI1: interface port 
for administrative state 

A.3 HI2: interface port for IRI 
A.3.1 Definition of Intercept Related Information (IRI) 

















  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 32 A.3.2 Structure of IRI records 
A.3.2.0 General 






A.3.2.1 Control information for HI2 







IRIContent



iRIversion




CommunicationIdentifier,


LawfulInterceptionIdentifier,


TimeStamp






CC-Link-Identifier






Table A.3.1: Parameters for LI control info
rmation in IRI records (HI2 interface port) 
IRI parameters: LI control information
 IRI parameter name
 ASN.1 name (used in 
annex
 D) Type of record 
IRIContent 
Version indication 
iRIversion 
Lawful Interception IDentifier (LIID) 
LawfulInterceptionIdentifier 
Communication IDentifier (CID): 
 - Communication Identity Number (CIN); 
 - Network IDentifier (NID). 
CommunicationIdentifier 
Date and time 
TimeStamp 
CC Link IDentifier (CCLID) (only used in case of option B) CC-Link-Identifier  
A.3.2.2 Basic call information 








  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 33 






intercepted-Call-Direct


CallingPartyNumber 
 CalledPartyNumber





Services-Information



ISUP-parameters

DSS1-parameters-codeset-0







Location




National-Parameters
A.3.2.3 Information on Supplementary Se
rvices, related to a call in progress 








forwarded-to-Party



originatingParty
terminatingParty
forwarded-to-Party



originatingPartyInformation




terminatingPartyInformation



forwarded-to-Party

supplementary-Services-
Information






A.3.2.4 Information on non-call 
related Supplementary Services 




  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 34 
A.3.3 Selection of parameters for IRI records 









 







called 
party number





































Table A.3.2: List of parameters from standard protocols, which may be contained in IRI records 
IRI parameters: target call information, based on standard protocols
 IRI parameter name  
Name of ASN.1 parameter 
(of annex
 D) Related standard Ref. 
Three party conference 
invoke/result components 
(see note 2) 
PartyInformation 
supplementary-Services-Information 
DSS1 
ETSI EN 300 188-1 [20] 
Add on conference 
invoke/result components 
(see note 2) 
PartyInformation 

supplementary-Services-Information 
DSS1 
ETSI EN 300 185-1 [19] 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 35 IRI parameters: target call information, based on standard protocols
 IRI parameter name  
Name of ASN.1 parameter 
(of annex
 D) Related standard Ref. 
Bearer capability 
PartyInformation 
services-Information 
DSS1 ETSI EN 300 403-1 [6] 
Call diversion information 
PartyInformation 
supplementary-Services-Information 
ISUP/DSS1 ETSI EN 300 356 [5], 

ETSI EN 300 207-1 [21] 
Call transfer number 
PartyInformation 
supplementary-Services-Information 
ISUP ETSI EN 300 356 [5] 
Called party number 
PartyInformation 

CalledPartyNumber 
ISUP/DSS1/MAP 
ETSI EN 300 356 [5], 

ETSI EN 300 403-1 [6], 

3GPP TS 09.02 [32] 
Called party subaddress 
PartyInformation 
supplementary-Services-Information 
DSS1 ETSI EN 300 061-1 [10] 
Calling party number 
PartyInformation 
CallingPartyNumber 
ISUP/DSS1 ETSI EN 300 356 [5], 

ETSI EN 300 403-1 [6] 
Calling party subaddress 
PartyInformation 

supplementary-Services-Information 
DSS1 ETSI EN 300 061-1 [10] 
Cause indicator 
Release-Reason-Of-Intercepted-Call 
CallContentLinkCharacteristics 
ISUP/DSS1 ETSI EN 300 356 [5], 

ETSI EN 300 403-1 [6] 
Cell id 
Location 
MAP/ISUP 
3GPP TS 09.02 [32], 
ETSI EN 300 356 [5] 
Closed user group interlock 

code 
PartyInformation 

supplementary-Services-Information 
ISUP  Connected number 
PartyInformation 
supplementary-Services-Information 
ISUP/DSS1 ETSI EN 300 356 [5], 

ETSI EN 300 097-1 [14] 
Connected subaddress 
PartyInformation 
supplementary-Services-Information 
DSS1 ETSI EN 300 097-1 [14] 
Explicit Call Transfer  

invoke/result components 

(see note 2) 
PartyInformation 

supplementary-Services-Information 
DSS1 ETSI EN 300 369-1 [25] 
Facility (see note 3) 
PartyInformation 

supplementary-Services-Information 
DSS1 ETSI EN 300 196-1 [29] 
Generic notification indicator 
PartyInformation 
supplementary-Services-Information 
ISUP ETSI EN 300 356 [5] 
Generic number 
PartyInformation 
supplementary-Services-Information 
ISUP ETSI EN 300 356 [5] 
High layer compatibility 
PartyInformation 

services-Information 
DSS1 ETSI EN 300 403-1 [6] 
IMEI 
PartyInformation 

imei 
MAP 3GPP TS 09.02 [32] 
IMSI 
PartyInformation 

imsi 
MAP 3GPP TS 09.02 [32] 
Keypad facility 
PartyInformation 

supplementary-Services-Information 
DSS1 ETSI EN 300 196-1 [29] 
Location number 
Location 
ISUP/MAP 
ETSI EN 300 356 [5],  

3GPP TS 09.02 [32] 
Low layer compatibility 
PartyInformation 

services-Information 
DSS1 ETSI EN 300 403-1 [6] 
MCID response indicator 
PartyInformation 
services-Information 
ISUP ETSI EN 300 356 [5] 
MSISDN 
PartyIdentity/msISDN 
MAP 
3GPP TS 09.02 [32] 
Original called number 
PartyInformation 
supplementary-Services-Information 
ISUP ETSI EN 300 356 [5] 
Redirecting number 
PartyInformation 

supplementary-Services-Information 
ISUP/DSS1 ETSI EN 300 356 [5], 

ETSI EN 300 207-1 [21] 
Redirection information 
PartyInformation 

supplementary-Services-Information 
ISUP ETSI EN 300 356 [5] 
Redirection number 
PartyInformation 
supplementary-Services-Information 
ISUP/DSS1 ETSI EN 300 356 [5], 

ETSI EN 300 207-1 [21] 
Subaddress transfer 
PartyInformation 
supplementary-Services-Information 
DSS1 ETSI EN 300 369-1 [25] 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 36 IRI parameters: target call information, based on standard protocols
 IRI parameter name  
Name of ASN.1 parameter 
(of annex
 D) Related standard Ref. 
Transmission Medium 
Requirement (TMR) 
PartyInformation 

services-Information 
ISUP ETSI EN 300 356 [5] 
NOTE 1: Column "Related standard" indicates the ETSI standard, which specifies the format and coding of the 
parameter. 
NOTE 2: Refers to several ASN.1 encoded elements, which are in the DSS1 protocol embedded in a facility 
information element. 
NOTE 3: The facility IE is only included, if it contains one 
or more of the parameters, which are parts of this table. 
Table A.3.3: List of LI specific parameters, which may be contained in IRI 
IRI parameters: target call information, LI specific definition
 IRI parameter name
 ASN.1 name (used in annex
 D) Direction of call 
intercepted-Call-Direct 
Call event, e.g.: 

- answer indication 

- call waiting indication 

- hold indication 
- retrieve indication 
- suspend indication 

- resume indication 
simpleIndication 
Ringing duration 
ringingDuration 
Conversation duration 
conversationDuration 
CC link information 
callContentLinkInformation 
Subscriber controlled input data dSS1
-parameters-codese
t-0, or sciData 
NOTE: Format and coding details (see annex D). 
































A.3.4 Coding of parameters in IRI records 





  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 37 

A.3.5 Information content of the IRI record types 








A.4 HI3: interface port fo
r Content of Communication 
A.4.0 General 











A.4.1 Delivery of Content of Communication (CC) 
A.4.1.0 General 




















• 

• 





  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 38 












 Figure A.4.1: Content of Communication transmission from MF to LEMF 
A.4.1.1 Delivery of TETRA CC over 
circuit switched handover networks 











A.4.2 Delivery of packetized C
ontent of Communication (CC) 
(general) A.4.2.0 General 









Target
TLEMF
other party
PIIFMFTxbearer channel,
 signalling channel
Rxbearer channel,
signalling channel
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 39 




A.4.2.1 Delivery of TETRA CC over packet switched handover networks 



A.4.3 Control information for circuit switched Content of 
Communication (CC) 











Table A.4.1: Definition of HI3 specific signalling information; UUS1 coding details (see clause D.8) 
No. Used information element of 
CC link signalling protocol
 Information 
Purpose 
1 CLI-Parameter with attribute 
"network provided" 
See clause A.4.5 LEMF can check identity of origin of call 
2 UUS1-parameter 
Lawful Interception IDentifier (LIID); 
see clause 6 
Identifier, identifying target identity 
3 UUS1-parameter 
Communication IDentifier (CID), 

see clause 6 
Identifier, identifying specific call of 

target identity 
4 UUS1-parameter 
CC Link IDentifier (CCLID), if 
required; see clause A.1 
Identifier, used for correlation CC link-IRI 

records 
5 UUS1-parameter 
Direction indication 
(communication from/towards 
target/combined (mono)) 
Signal from (T
x)/towards (R
x) target identity or combined 
6 UUS1-parameter 
Bearer capa
bility of target call 
Indication to the LEMF of the basic 
service in use by the target 
7 Closed user group interlock 

code 
Closed user group interlock code  
Supplementary Service CUG Security 

measure at set up of the CC link 
8 Basic Service (BS) 
Basic Service (BS) of CC link:  

64 kbit/s unrestricted 
Guarantee transparent transmission of 

CC copy from MF to LEMF 
9 ISDN user part forward call 

indicators parameter 
ISDN user part preference  

indicator: "ISDN user part required 

all the way" 
Guarantee transparent  

transmission of UUS1 and other 

supplementary services information 
10 
ISDN user part optional forward 

call indicators parameter 
Connected line identity request 

parameter: requested 
Sending of the connected number by the 

destination network 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 40 



































A.4.4 Exception handling 
A.4.4.1 Failure of CC links 




A.4.4.2 Fault reporting 






Table A.4.2: Typical events causing messages 
Event type
 Event causing message with LI alarm information
 CC link failure No answer from LEA 
 LEA is busy 
 CC link failed due to a COLP error 
 CC link failed due to a CUG error 
 CC link set up failure within the network 
 CC link failed due to a lack of system resources 
 General CC link set up failure 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 41 A.4.5 Security requirements at the interface port HI3 
A.4.5.0 General 








A.4.5.1 LI access verification 






• 
• 







A.4.5.2 Access protection 


• 

• 

• 
• 
A.4.5.3 Authentication 



  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 42 A.5 LI procedures for circuit switched supplementary 
services 
A.5.1 General 




















• 
• 












• 
• 
• 














  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 43 





Table A.5.1: Supplementary Services with impact on LI CC links or IRI records content;  
see also clause A.6 
Supplementary 
Service
 Abbr. 
CC links: additional calls, impact  
IRI items related to service  
Call Waiting CW CC links for active or all calls (option A/B) 
Target: call waiting indication, calling party 
address 

other party: generic notification indicator 
call HOLD HOLD CC links for active or all calls (option A/B) 
Target: call hold indication 

other party: generic notification indicator 
call RETRIEVE RETRIEVE
 CC links for active or all calls (option A/B) 
Target: call retrieve indication 

other party: generic notification indicator 
Explicit Call 

Transfer 
ECT Before transfer: see HOLD 

After transfer: LI may or may not be stopped
 Target: components of Facility IE 

other party: generic notification indicator 
Terminal 

Portability 
TP No impact on CC links 
Target: call suspend/resume indications 

other party: generic notification indicator 
SUBaddressing SUB No impact on CC links 
Subaddress IE, as available  

(calling, called, etc.) 
Calling Line 

Identification 
Presentation 
CLIP No impact on CC links 
CLI parameter: part of originating-Party 

information 
Calling Line 
Identification 
Restriction 
CLIR No impact on CC links Restriction indicator is part of CLI parameter 
COnnected Line 
identification 

Presentation 
COLP No impact on CC links 
COL parameter: part of terminating-Party 

information 
COnnected Line 

identification 

Restriction 
COLR No impact on CC links Restriction indicator is part of COL parameter
 Closed User 

Group 
CUG No impact on CC links CUG interlock code 
add on 

CONFerence 
CONF Tx: signal from target; R
x call sum signal 
CC links depending on option A/B 
Target: components of Facility IE 

other party: generic notification indicator 
Three PartY 

conference 
3PTY Initially: held and active calls see HOLD 

Conf.: see CONF 
Target: components of Facility IE 

other party: generic notification indicator 
Call Forwarding 

Unconditional;  

(see note) 
CFU One CC link for each call, which is 
forwarded by the target 
Forwarding by other parties:  

no impact 
Target: see clause A.3.2.3, point 2, 3; if 

redirecting no. = target DN: not included 
Other party (call to target is a forwarded call):
 See clause A.3.2.3, point 1  
Other party (call from target gets forwarded):
 See clause A.3.2.3, point 3 
Call Forwarding 

No Reply;  

(see note) 
CFNR 1) basic call with standards CC links, 

 released after time-out (incl. CC links) 

2) forwarding: same as CFU 
1) basic call, released after time-out, 

 standard IRI 

2) forwarding: same parameters as for CFU 
Call Forwarding 

Busy; (see note) 
CFB Network determined user busy: see CFU 

User determined user busy: see CFNR 
Network determined user busy: see CFU 

user determined user busy: see CFNR 
Call Deflection CD See CFNR 
See CFNR 
Partial Rerouting
 PR See CFNR 
See CFNR 
Malicious Call 

IDentification 
MCID No impact on CC links MCID response indicator sent at invocation 
User-to-User  

Signalling 1, 2, 3
 UUS No impact on CC links 
User-to-user information, more data IE 

(part of HI2 information, see clause D.5,  

part of HI3 information, see clause D.6) 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 44 Supplementary 
Service
 Abbr. 
CC links: additional calls, impact  
IRI items related to service  
FallBack 
procedure (not a 
Supplementary 
Service) 
FB No impact on CC links Target or other party: new basic service IE 
NOTE: Other variants of Call Forwarding (CF), like forwarding to fixed numbers, to information services, etc. are 
assumed to be covered by the listed services. 
A.5.2 CC link Impact 

• 
• 




A.5.3 IRI impact, general princi
ple for sending IRI records 



















































  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 45 A.5.4 Multi party calls - general principles, options A, B 
A.5.4.0 General 








A.5.4.1 CC links for active and non-active calls (option A) 


• 
• 



 Figure A.5.1: CC link option A (example for call hold supplementary service) 
A.5.4.2 Reuse of CC links for active calls (option B) 






Target
Tother parties
P1  on hold

P2  on hold

P3  active
IIF
LEMF
MFon hold
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 46  Figure A.5.2: CC link option B (example 
for call hold supplementary service) 
A.5.5 Subscriber Controlled Input (SCI): 
Activation/Deactivation/Interrogation of services 

















A.6 Detailed procedures for circuit switched 
supplementary services 
A.6.1 Advice of Charge services (AOC) 



A.6.2 Call Waiting (CW) 
A.6.2.1 Call Waiting (CW) at target: CC links 




Target
Tother parties
P1  on hold
P2  on hold

P3  active
IIF
LEMF
MFon hold
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 47 

A.6.2.2 Call Waiting: IRI records 
A.6.2.2.1 Target is served user 


call waiting indication
A.6.2.2.2 Other party is served user 

CW notification




A.6.3 Call Hold/Retrieve 
A.6.3.1 CC links for active and non-active calls (option A) 





A.6.3.2 Reuse of CC links for active calls (option B) 




A.6.3.3 IRI records 
A.6.3.3.1 Invocation of Call Hold or Retrieve by target 



A.6.3.3.2 Invocation of Hold or Retrieve by other parties 



A.6.4 Explicit Call Transfer (ECT) 
A.6.4.1 Explicit Call
 Transfer (ECT), CC link 




  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 48 



A.6.4.2 Explicit Call Transfer (ECT), IRI records 





A.6.5 Calling Line Identification Pres
entation (CLIP) (IRI Records) 
A.6.5.1 Call originated by target
 (other party is served user) 








 A.6.5.2 Call terminated at target (target is served user) 

originating-Party




A.6.6 Calling Line Identification Restriction (CLIR) 

A.6.7 COnnected Line identific
ation Presentation (COLP) 
A.6.7.1 Call terminated at target
 (other party is served user) 





A.6.7.2 Call originated by target (target is served user) 






A.6.8 COnnected Line identific
ation Restriction (COLR) 

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 49 A.6.9 Closed User Group (CUG) 

A.6.10 Completion of Call to Busy Subscriber (CCBS) 







A.6.11 CONFerence call, add-on (CONF) 
A.6.11.1 CONFerence calls, add on: CC links 








A.6.11.2 Conference calls: IRI records 




A.6.12 Three Party Service (Conference) 
A.6.12.1 CC links 















A.6.12.2 Three Party Service, IRI Records 

A.6.13 Meet-Me Conference (MMC) 


  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 50 A.6.14 Direct Dialling In (DDI) 


A.6.15 Multiple Subscriber Number (MSN) 




A.6.16 DIVersion services (DIV) 
A.6.16.0 General 





A.6.16.1 Call Diversion by target 
A.6.16.1.1 Call Diversion by target, CC links 


























  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 51 A.6.16.1.2 Call Diversion by target, IRI records 



• 
• 



A.6.16.2 Forwarded call terminated at target 


A.6.16.3 Call from target forwarded 



A.6.17 Variants of call diversion services 



A.6.18 Void 
A.6.19 Malicious Call IDentification (MCID) 



A.6.20 SUBaddressing (SUB) 



A.6.21 Terminal Portability (TP) 
A.6.21.1 CC links 

A.6.21.2 IRI records 
A.6.21.2.1 Invocation of Terminal Portability by target 

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 52 A.6.21.2.2 Invocation of Terminal Portability by other parties 


A.6.22 User-to-User Signalling (UUS) 





A.6.23 Abbreviated Address (AA) 


A.6.24 Fixed Destination Call (FDC) 


A.6.25 Alarm Call (AC)/Wake-Up Service (WUS) 

A.6.26 Incoming Call Barring (ICB) 

 Case terminating call to a target with ICB active: 





 Case target calls a party with ICB active: 



A.6.27 Outgoing Call Barring (OCB) 




A.6.28 Completion of Calls on No Reply (CCNR) 

A.6.29 Reverse charging 

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 53 A.6.30 Line hunting 


A.6.31 Message Wait Indication (MWI) 

A.6.32 Name display 

A.6.33 Tones, announcements 





A.7 Void  A.8 GSM circuit switched technology annex 
A.8.1 Functional architecture 






 Figure A.8.1: Reference configuration for GSM circuit switched 
LEA
MSC/
VLR
GMSC
ADMF
CC MF
IRI MF
DF3
DF2
NWO/AP/SvP™s
administration
centre
X1 interface
X2 interface
X3 interface
HI1
HI2
HI3
IIF
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 54 









A.8.2 Correlation of CC and IRI (see clause 6) 





Communication IDentifier (CID) 



• 
• 


 

A.8.3 HI3 (delivery of CC) 



A.8.4 HI2 (delivery of IRI) 








  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 55 Table A.8.1: Structure of the records for GSM (CS) 
Event
 IRI record type
 Call establishment 
BEGIN 
Answer CONTINUE 
Supplementary service CONTINUE 
Handover CONTINUE 
Release END 
Location update 
REPORT 
Subscriber controlled input REPORT 
SMS REPORT 















Table A.8.2: Description of parameters 
Parameter Definition ASN.1 parameter
 observed MSISDN
 Target Identifier with the MSISDN of the target 
subscriber (monitored subscriber) 
PartyInformation/msISDN 
observed IMSI 
Target Identifier with the IMSI of the target 
subscriber (monitored subscriber) 
PartyInformation/imsi 
observed IMEI 
Target Identifier with the IMEI of the target 
subscriber (monitored subscriber), it shall be 
checked for each call over the radio interface 
PartyInformation/imei 
event type 
Description which type of event is delivered: 
Establishment, Answer, Supplementary service, 

Handover, Release, SMS, Location update, 
Subscriber controlled input 
There is no one-to-one mapping for this 
information. Parameters presence on HI2 

indicates the event type (e.g. sMS or sciData 
parameter presence) 
event date 
Date of the event generation in the MSC/VLR or 
GMSC 
TimeStamp 
event time 
Time of the event generation in the MSC/VLR or 

GMSC 
dialled number 
Dialled number before digit modification, 
IN-modification, etc. 
PartyInformation (= originating)/DSS1-

parameters/calledpartynumber 
connected number
 Number of the answering party 
PartyInformation/supplementary-Services-Info 
other party 
address 
Directory number of the other party for originating 
calls 
Calling party for terminating calls 
PartyInformation  
(= terminating)/calledpartynumber 
PartyInformation/callingpartynumber 
call direction 
Information if the monitored subscriber is calling or 
called e.g. MOC/MTC or originating/terminating in 
or/out 
intercepted-Call-Direct 
CID Unique number for each call sent to the DF, to 

help the LEA, to have a correlation between each 
call and the IRI (combination of Interception Node 
ID and the correlation number) 
communicationIdentifier 
lawful interception 
identifier 
Unique number for each surveillance lawful 

authorization 
LawfulInterceptionIdentifier 
cell id 
Cell number of the target; for the location 
information 
locationOfTheTarget 
location area code 
Location-area-code of the target defines the 

Location Area in a PLMN 
basic service Information about Tele service or beare
r service PartyInformation/DSS1-parameters-codeset-0 
supplementary 

service 
Supplementary services used by the target 

e.g. CF, CW, ECT 
PartyInformation/Supplementary-Services 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 56 Parameter Definition ASN.1 parameter
 forwarded to 
number 
Forwarded to number at CF 
PartyInformation/calledPartyNumber 

(party-Qualifier indicating forwarded-to-party) 
call release reason
 Call release reason of the target call 
Release-Reason-Of-intercepted-Call 
SMS 
The SMS content with header which is sent with 

the SMS-service 
SMS 
SCI Non-call related Subscriber Controlled Input (SCI) 

which the MSC/VLR receives from the ME 
PartyInformation/sciData 
NOTE: LIID parameter shall be present in each record sent to the LEMF. 
A.9 TETRA technology annex 


EN301040 {itu-t(0) identified-organization(4) etsi(0) en301040(1040) interceptVersion(0)} A.10 NGN PSTN/ISDN emulation and simulation services 
technology annex 
A.10.0 General 



A.10.1 Functional architecture 




 Network 
Mediation 
Functionality (MF)
 Law Enforcement 
Monitoring 
Facility (LEMF)
Handover 
interface
Source of 
emulated or 
simulated 
PSTN/ISDN
 Figure A.10.1: High level functional architecture for PSTN/ISDN emulation and simulation services 
A.10.2 Correlation 



  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 57 A.10.3 HI2 

A.10.4 HI3 


  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 58 Annex B (normative): 
Packet switched network handover 
B.1 Specific identifiers for LI 




• 
• 


 B.2 HI1: interface port 
for administrative state 

B.3 HI2: interface port for IRI 
B.3.1 Definition of Interception Related Information for packet 
switched 













B.3.2 Exception handling 

B.3.3 Security aspects 

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 59 B.4 HI3: interface port fo
r Content of Communication 
(CC) 

 B.5 GPRS technology annex 
B.5.1 Functional architecture 





 NOTE: GGSN interception is a national option. 
 Figure B.5.1: Reference configuration 






LEASGSNGGSN
ADMF
CC MF
IRI MF
DF3P
DF2P
NWO/AP/SvP™s
administration
centre
X1-1P
interface
X2P interface
X3P interface
HI1
HI2
HI3
IIF
X1-3P
interface
X1-2P
interface
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 60 B.5.2 Correlation 
B.5.2.1 Correlation of the present document IDs to GSM IDs 



Communication IDentifier (CID) 
For each communication or other activity relating to a target identity a CID is generated by the relevant network 
element. The CID consists of the following two identifiers: 
• 
• 



B.5.2.2 GPRS LI correlation between CC and IRI 






B.5.3 HI2 (delivery of IRI) 






Table B.5.1: Mapping between GPRS Events and HI2 records type
 Event
 IRI record type
 GPRS attach 
REPORT 
GPRS detach 
REPORT 
PDP context activation (successful) BEGIN 
PDP context activation (unsuccessful) REPORT 
Start of intercept with PDP context active BEGIN or optionally CONTINUE 
PDP context modification 
CONTINUE 
PDP context deactivation 
END 
Cell and/or RA update 
REPORT  
SMS REPORT 

















  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 61 Table B.5.2: Mapping between events information and IRI information 
Parameter Description
 HI2 ASN.1 parameter
 observed MSISDN 
Target Identifier with the MSISDN of the target 
subscriber (monitored subscriber) 
PartyInformation/msISDN 
observed IMSI 
Target Identifier with the IMSI of the target subscriber 
(monitored subscriber) 
PartyInformation/imsi 
observed IMEI  
Target Identifier with the IMEI of the target subscriber 
(monitored subscriber) 
PartyInformation/imei 
observed PDP address PDP address used by the target 
PartyInformation/pDP-address-

allocated-to-the-target 
event type 
Description which type of event is delivered: PDP 
Context Activation, PDP Context Deactivation, GPRS 
Attach, etc. 
gPRSevent 
event date 
Date of the event generation in the xGSN 
TimeStamp 
event time 
Time of the event generation in the xGSN 
Access point name The APN of the access point 
PartyInformation/aPN 
PDP type 
This field describes the PDP type as defined in 

3GPP TS 09.60 [45], 3GPP TS 04.08 [55], 

3GPP TS 09.02 [32] 
PartyInformation/pDP-type 
Correlation number 
Unique number for each PDP context delivered to the 
LEMF, to help the LEA, to have a correlation between 
each PDP Context and the IRI 
gPRSCorrelationNumber 
lawful interception identifier
 Unique number for each lawful authorization LawfulInterceptionIdentifier 
CGI (Cell Global ID) Cell number of the target; for the location information locationOfTheTarget/globalCellId 
routing area identifier 
Routing-area-identifier of the target defines the 

Routing Area in a GPRS-PLMN 
locationOfTheTarget/rAI 
SMS 
The SMS content with header which is sent with the 

SMS-service 
SMS 
failed context activation 
reason 
This field gives information about the reason(s) for 

failed context(s) activation of the target subscriber 
gPRSOperationErrorCode 
failed attach reason 
This field gives information about the reason(s) for 
failed attach attempts of the target subscriber 
gPRSOperationErrorCode 
NOTE: LIID parameter shall be present in each record sent to the LEMF. 
B.5.4 HI3 (Delivery of CC) 

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 62 Annex C (normative): 
HI2 Delivery mechanisms and procedures 
C.0 Premise 




C.1 ROSE C.1.1 Architecture 
 Figure C.1.1: Architecture 


C.1.2 ASE_HI procedures 
C.1.2.1 Sending part 




• 

• 


LI_Application
ASE_HI :
Application Service Elementfor
the HandoverInterface
Session
Transport

Network
Data
Physical
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 63 



• 


• 


• 


• 



 




 




• 



--
-


-










• 



• 





• 









  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 64 C.1.2.2 Receiving part 

• 







 
 
 
 
 

• 



• 




C.1.2.3 Data link management 
C.1.2.3.0 General 


C.1.2.3.1 Data link establishment 









• 

• 






• 



• 



   ETSI ETSI ES 201 671 V3.2.1
 (2018
-05) 65 
Data link test

• 



• 


• 

• 


C.1.2.3.2 Data link release 
• 


 

 


 
 
 • 


• 


• 

• 




C.1.2.4 Handling of unrecognized fields and parameters 

C.1.3 Void 
C.2 FTP 
C.2.1 Introduction 





  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 66 C.2.2 Usage of the FTP 






• 
• 







File naming: 







File naming method A): 


LIID












seq




ext



Table C.2.1: Possible file types 
File types that the LEA may get
 Intercepted da
ta types
 "1" (in binary: 0011 0001) 
IRI 
"8" (in binary: 0011 1000) 
for national use 






  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 67 File naming method B): 



AB
XY
yy

mm
dd

hh
mm
ss

eeee



t





ABXY


00

04

10

14

08

44
0000
1







C.2.3 Profiles 










  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 68 


















ftp <flags> <destaddr>  user <leauser> <leapasswd>  cd <destpath>  lcd <srcpath>  bin  mput <files>  nlist <lastfile> <checkfile>  close EOF  


user <user-name> <password> Identify the client to the remote FTP server. cd <remote-directory> Change the working directory on the remote machine to remote-directory. lcd <directory> Change the working directory on the local machine. bin Set the file transfer type to support binary image transfer mput <local-files> Expand wild cards in the list of local files given as arguments and do a put for each file in the resulting list. Store each local file on the remote machine. nlist <remote-directory> <local-file> Print a list of the files in a directory on the remote 
machine. Send the output to local-file. close Terminate the FTP session with the remote server, and return to the command interpreter. Any defined macros are erased.  
<flags>


<destaddr>

<leauser>

<leapasswd>

<destpath>

<srcpath>

<files>

<lastfile>

<checkfile>


  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 69 
• 
• 
• 

• 


• 







• 













C.2.4 File content 








C.2.5 Exceptional procedures 








  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 70 C.2.6 Other considerations 

• 
• 

• 

• 




 


 • 
• 
• 
• 
• 






Timing considerations for the HI2 FTP transmission: 



Table C.2.2: Timing considerations 
Name
 Controlled by
 Units Description
 T1 inactivity timer 
LEMF Seconds 
Triggered by no activity within the FTP session (no new files). 
The FTP session is torn down when the T1 expires. To send 
another file the new connection will be established. The timer 
avoids the FTP session overflow at the LEMF side. 
T2 send file trigger 
MF Milliseconds 
Forces the file to be transmitted to the LEMF (even if the size 
limit has not been reached yet in case of volume trigger active). If 
the timer is set to 0 the only trigger to send the file is the file size 

parameter (see clause C.2.2). 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 71 Annex D (normative): 
Structure of data at 
the Handover Interface 
D.0 General 



• 

• 
• 




D.1 Syntax definitions 




type
class
value
parameter



type
,


class








value 
parameter
 



tag
 

primitive
 

constructor
 






Number

INTEGER

Number




  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 72 












D.2 Object tree 








[section D.4] 

















[section D.3] 
[section D.5] 
[section D.6] 
[TS 101 909-20-1]
 [section D9] 
[section D8] 
[TS 33.108] 

[section D7] 
[TS 301 040} 
 Figure D.2.1: Object Tree: Lawful Interception in ETSI domain 







  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 73 D.3 HI management operation 

ASN.1 description of HI management operation (any HI interface) 
HIManagementOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) him(3) version3(3)}  DEFINITIONS IMPLICIT TAGS ::= BEGIN   EXPORTS     sending-of-Password, 
 data-Link-Test,  end-Of-Connection;  
IMPORTS     OPERATION, 
 ERROR   FROM Remote-Operations-Information-Objects 
  {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)}; 
 
-- ============================= -- Object Identifier definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- him Domain himDomainId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId him(3)} himOperationId OBJECT IDENTIFIER ::= {himDomainId version3(3)}  
sending-of-Password  OPERATION ::= 
{  ARGUMENT Password-Name  ERRORS  {ErrorsHim} 
 CODE  global:{himDomainId sending-of-Password(1) version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s.  
data-Link-Test   OPERATION ::= 
{  ERRORS   {other-failure-causes} 
 CODE  global:{himDomainId data-link-test(2) version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s.  
end-Of-Connection  OPERATION ::= 
{  ERRORS   {other-failure-causes} 
 CODE  global:{himDomainId end-of-connection(3) version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s.  
other-failure-causes ERROR ::= {CODE local:0} 
missing-parameter  ERROR ::= {CODE local:1} 
unknown-parameter  ERROR ::= {CODE local:2} 
erroneous-parameter ERROR ::= {CODE local:3}  ErrorsHim    
ERROR ::= {  other-failure-causes | 
 missing-parameter | 
 unknown-parameter | 
 erroneous-parameter }    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 74 Password-Name   ::= SEQUENCE 
{  domainID [0] OBJECT IDENTIFIER (himOperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism
  password [1] OCTET STRING (SIZE (1..25)), 
 name  [2] OCTET STRING (SIZE (1..25)), 
 ... }  -- IA5 string recommended 
 END -- end of HIManagementOperations  D.4 LI management notification 






ASN.1 description of LI management notification operation (HI1 interface) 
HI1NotificationOperations 
{itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi1(0) notificationOperations(1) version5(5)}  DEFINITIONS IMPLICIT TAGS ::= BEGIN  IMPORTS  OPERATION,  ERROR   FROM Remote-Operations-Information-Objects 
  {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)} 
  -- from clause D.5 
 CommunicationIdentifier,  TimeStamp,  LawfulInterceptionIdentifier   FROM HI2Operations 
  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) 
version10(10)};  
-- ============================= -- Object Identifier Definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi1 Domain hi1NotificationOperationsId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi1(0) notificationOperations(1)} hi1OperationId OBJECT IDENTIFIER ::= {hi1NotificationOperationsId version5(5)}  
sending-of-HI1-Notification  OPERATION ::= 
{  ARGUMENT HI1-Operation  ERRORS  {ErrorHI1Notifications} 
 CODE  global:{hi1NotificationOperationsId version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s. -- NOTE: The value for this timer is to be set on the equipment waiting for the returned message; -- its value shall be agreed between the NWO/AP/SvP and the LEA, depending on their equipment -- properties.    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 75 other-failure-causes  ERROR ::= {CODE local:0} 
missing-parameter  ERROR ::= {CODE local:1} 
unknown-parameter  ERROR ::= {CODE local:2} 
erroneous-parameter ERROR ::= {CODE local:3}  ErrorHI1Notifications ERROR ::= {  other-failure-causes | 
 missing-parameter | 
 unknown-parameter | 
 erroneous-parameter }  HI1-Operation  ::= CHOICE 
{  liActivated      [1] Notification, 
 liDeactivated     [2] Notification, 
 liModified      [3] Notification, 
 alarms-indicator    [4] Alarm-Indicator, 
 ...,  national-HI1-ASN1parameters [5] National-HI1-ASN1parameters }  -- ================== -- PARAMETERS FORMATS -- ==================  Notification  ::= SEQUENCE 
{  domainID      [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 lawfulInterceptionIdentifier  [1] LawfulInterceptionIdentifier, 
  -- This identifier is the LIID identity provided with the lawful authorization 
  -- for each target. 
 communicationIdentifier   [2] CommunicationIdentifier OPTIONAL, 
  -- Only the NWO/PA/SvPIdentifier is provided (the one provided with the Lawful 
  -- authorization). 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671. 
 timeStamp      [3] TimeStamp, 
  -- date and time of the report. 
 ...,  national-HI1-ASN1parameters [5] National-HI1-ASN1parameters OPTIONAL }  
Alarm-Indicator  ::= SEQUENCE 
{  domainID      [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 communicationIdentifier  [1] CommunicationIdentifier OPTIONAL, 
  -- Only the NWO/PA/SvPIdentifier is provided (the one provided with the 
  -- Lawful authorization) 
 timeStamp      [2] TimeStamp, 
  -- date and time of the report. 
 alarm-information    [3] OCTET STRING (SIZE (1..25)), 
  -- Provides information about alarms (free format). 
 ...,  lawfulInterceptionIdentifier [4] LawfulInterceptionIdentifier OPTIONAL, 
  -- This identifier is the LIID identity provided with the lawful authorization 
  -- for each target in according to national law. 
 national-HI1-ASN1parameters [5] National-HI1-ASN1parameters OPTIONAL }    ETSI ETSI ES 201 671 V3.2
.1 (2018
-05) 76 National-HI1-ASN1parameters  ::= SEQUENCE 
{  domainID  [0] OBJECT IDENTIFIER (hi1OperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism. 
 countryCode  [1] PrintableString (SIZE (2)), 
  -- Country Code according to ISO 3166-1 [67], 
  -- the country to which the parameters inserted after the extension marker apply. 
 ...   -- In case a given country wants to use additional national parameters according to its law, 
  -- these national parameters should be defined using the ASN.1 syntax and added after the 
  -- extension marker (...). 
  -- It is recommended that "version parameter" and "vendor identification parameter" are 
  -- included in the national parameters definition. Vendor identifications can be 
  -- retrieved from IANA web site (see annex H). Besides, it is recommended to avoid 
  -- using tags from 240 to 255 in a formal type definition. 
}  END -- end of HI1NotificationOperations  D.5 Intercept related information (HI2 PS and CS) 


ASN.1 description of IRI (HI2 interface) 
HI2Operations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) version10(10)}  DEFINITIONS IMPLICIT TAGS ::=  BEGIN  IMPORTS OPERATION,  ERROR   FROM Remote-Operations-Information-Objects 
  {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)} 
  -- from 3GPP TS 33.108 [61] 
 UmtsQos,  IMSevent,  LDIevent,  CorrelationValues   FROM UmtsHI2Operations 
  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulintercept(2) 
threeGPP(4) hi2(1) r7(7) version-3(3)}   -- from TS 101 909-20-01 [69] 
 TARGETACTIVITYMONITOR-1   FROM TS101909201 
  {itu-t(0) identified-organization(4) etsi(0) ts101909(1909) part20(20) subpart1(1) 
interceptVersion(0)}   -- from EN 301 040 [72] 
 TARGETACTIVITYMONITORind,  TARGETCOMMSMONITORind,  TTRAFFICind,  CTTRAFFICind   FROM EN301040 
  {itu-t(0) identified-organization(4) etsi(0) en301040 (1040) interceptVersion (0)}; 
    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 77 -- ============================= -- Object Identifier Definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- Security Subdomains hi2DomainId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi2(1)} hi2OperationId OBJECT IDENTIFIER ::= {hi2DomainId version10(10)}  sending-of-IRI OPERATION ::= {  ARGUMENT IRIsContent  ERRORS  {OperationErrors} 
 CODE  global:{hi2DomainId sending-of-IRI(1) version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s. -- NOTE: The same note as for HI management operation applies.  
IRIsContent  ::= CHOICE
 {  iRIContent   IRIContent, 
 iRISequence   IRISequence 
}  
IRISequence  ::= SEQUENCE OF IRIContent 
 -- Aggregation of IRIContent is an optional feature. 
 -- It may be applied in cases when at a given point in time several IRI records are 
 -- available for delivery to the same LEA destination. 
 -- As a general rule, records created at any event shall be sent immediately and shall 
 -- not held in the DF or MF in order to apply aggregation. 
 -- When aggregation is not to be applied, IRIContent needs to be chosen. 
 IRIContent  ::= CHOICE 
{  iRI-Begin-record  [1] IRI-Parameters, 
  -- At least one optional parameter shall be included within the iRI-Begin-Record. 
 iRI-End-record   [2] IRI-Parameters, 
 iRI-Continue-record  [3] IRI-Parameters, 
  -- At least one optional parameter shall be included within the iRI-Continue-Record. 
 iRI-Report-record  [4] IRI-Parameters, 
  -- At least one optional parameter shall be included within the iRI-Report-Record. 
 ... }  unknown-version    ERROR ::= {CODE local:0} 
missing-parameter   ERROR ::= {CODE local:1} 
unknown-parameter-value ERROR ::= {CODE local:2} unknown-parameter   ERROR ::= {CODE local:3} 
 OperationErrors ERROR ::= {  unknown-version | 
 missing-parameter | 
 unknown-parameter-value | 
 unknown-parameter } -- These values may be sent by the LEMF, when an operation or a parameter is misunderstood.    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 78 IRI-Parameters  ::= SEQUENCE 
{  domainID       [0] OBJECT IDENTIFIER (hi2OperationId) OPTIONAL, 
  -- for the sending entity the inclusion of the Object Identifier is mandatory 
 iRIversion     
  [23] ENUMERATED 
 {   version2(2),   ...,   version3(3),   version4(4),   version5(5),   version6(6),   version7(7),   lastVersion(8)  } OPTIONAL, 
  -- Optional parameter "iRIversion" (tag 23) is redundant starting from TS 101 671 v2.4.1 
  -- where to the object identifier "domainID" was introduced into IRI-Parameters. 
  -- In order to keep backward compatibility, even when the version of the "domainID" 
  -- parameter will be incremented it is recommended to always send to LEMF the same: 
  -- enumeration value "lastVersion(8)". 
  -- if not present, it means version 1 is handled 
 lawfulInterceptionIdentifier  [1] LawfulInterceptionIdentifier, 
  -- This identifier is associated to the target. 
 communicationIdentifier   [2] CommunicationIdentifier, 
  -- used to uniquely identify an intercepted call. 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671. 
 timeStamp       [3] TimeStamp, 
  -- date and time of the event triggering the report. 
 intercepted-Call-Direct    [4] ENUMERATED 
 {   not-Available(0),   originating-Target(1),    -- In case of GPRS, this indicates that the PDP context activation, modification 
   -- or deactivation is MS requested. 
  terminating-Target(2),    -- In case of GPRS, this indicates that the PDP context activation, modification 
   -- or deactivation is network initiated. 
 ...  } OPTIONAL, 
 intercepted-Call-State    [5] Intercepted-Call-State OPTIONAL, 
 ringingDuration      [6] OCTET STRING (SIZE (3)) OPTIONAL, 
  -- Duration in seconds. BCD coded : HHMMSS 
 conversationDuration     [7] OCTET STRING (SIZE (3)) OPTIONAL, 
  -- Duration in seconds. BCD coded : HHMMSS 
 locationOfTheTarget    [8] Location OPTIONAL, 
  -- location of the target subscriber 
 partyInformation      [9] SET SIZE (1..10) OF PartyInformation OPTIONAL, 
  -- This parameter provides the concerned party (Originating, Terminating or forwarded 
  -- party), the identity(ies) of the party and all the information provided by the party. 
 callContentLinkInformation   [10] SEQUENCE 
 {   cCLink1Characteristics  [1] CallContentLinkCharacteristics OPTIONAL, 
   -- Information concerning the Content of Communication Link Tx channel established 
   -- toward the LEMF (or the sum signal channel, in case of mono mode). 
  cCLink2Characteristics  [2] CallContentLinkCharacteristics OPTIONAL, 
   -- Information concerning the Content of Communication Link Rx channel established 
   -- toward the LEMF. 
  ...  } OPTIONAL, 
 release-Reason-Of-Intercepted-Call [11] OCTET STRING (SIZE (2)) OPTIONAL, 
  -- Release cause coded in Recommendation ITU-T Q.850 [31] format. 
  -- This parameter indicates the reason why the intercepted call cannot be established or 
  -- why the intercepted call has been released after the active phase. 
 nature-Of-The-intercepted-call  [12] ENUMERATED 
 {   -- Nature of the intercepted "call": 
  gSM-ISDN-PSTN-circuit-call(0),    -- the possible UUS content is sent through the HI2 or HI3 "data" interface 
   -- the possible call content call is established through the HI3 "circuit" interface 
  gSM-SMS-Message(1),    -- the SMS content is sent through the HI2 or HI3 "data" interface 
  uUS4-Messages(2),    -- the UUS content is sent through the HI2 or HI3 "data" interface 
  tETRA-circuit-call(3),    -- the possible call content call is established through the HI3 "circuit" interface 
   -- the possible data are sent through the HI3 "data" interface 
  teTRA-Packet-Data(4),    -- the data are sent through the HI3 "data" interface 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 79   gPRS-Packet-Data(5),    -- the data are sent through the HI3 "data" interface 
  ...,   uMTS-circuit-call(6)    -- the possible call content call is established through the HI3 "circuit" interface 
   -- the possible data are sent through the HI3 "data" interface 
 } OPTIONAL, 
 serverCenterAddress    [13] PartyInformation OPTIONAL, 
  -- e.g. in case of SMS message this parameter provides the address of the relevant 
  -- server within the calling (if server is originating) or called 
  -- (if server is terminating) party address parameters 
 sMS         [14] SMS-report OPTIONAL, 
  -- this parameter provides the SMS content and associated information 
 cC-Link-Identifier     [15] CC-Link-Identifier OPTIONAL, 
  -- Depending on a network option, this parameter may be used to identify a CC link 
  -- in case of multiparty calls. 
 national-Parameters    [16] National-Parameters OPTIONAL, 
 gPRSCorrelationNumber    [18] GPRSCorrelationNumber OPTIONAL, 
 gPRSevent        [20] GPRSEvent OPTIONAL, 
  -- This information is used to provide particular action of the target 
  -- such as attach/detach 
 sgsnAddress       [21] DataNodeAddress OPTIONAL, 
 gPRSOperationErrorCode    [22] GPRSOperationErrorCode OPTIONAL, 
 ...,  ggsnAddress       [24] DataNodeAddress OPTIONAL, 
 qOS         [25] UmtsQos OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 networkIdentifier     [26] Network-Identifier OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 sMSOriginatingAddress     [27] DataNodeAddress OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 sMSTerminatingAddress     [28] DataNodeAddress OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 iMSevent       [29] IMSevent OPTIONAL, 
 sIPMessage       [30] OCTET STRING OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 servingSGSN-number     [31] OCTET STRING (SIZE (1..20)) OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 servingSGSN-address    [32] OCTET STRING (SIZE (5..17)) OPTIONAL, 
  -- Octets are coded according to 3GPP TS 23.003 [i.6] 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 tARGETACTIVITYMONITOR    [33] TARGETACTIVITYMONITOR-1 OPTIONAL, 
  -- Parameter is used in ETSI TS 101 909-20-1 [69] 
 ldiEvent        [34] LDIevent OPTIONAL, 
  -- The "Location Dependent Interception" parameter is duplicated from 3GPP TS 33.108 [61]. 
 correlation       [35] CorrelationValues OPTIONAL, 
  -- This parameter is duplicated from 3GPP TS 33.108 [61] 
 tARGETACTIVITYMONITORind   [36] TARGETACTIVITYMONITORind OPTIONAL,   -- Parameter is used in EN 301 040 [72]
  tARGETCOMMSMONITORind    
[37] TARGETCOMMSMONITORind OPTIONAL,   -- Parameter is used in EN 301 040 [72]
  tTRAFFICind       
[38] TTRAFFICind OPTIONAL,   -- Parameter is used in EN 301 040 [72]
  cTTRAFFICind      [39] CTTRAFFICind OPTIONAL, 
  -- Parameter is used in EN 301 040 [72] 
 national-HI2-ASN1parameters  [255] National-HI2-ASN1parameters OPTIONAL 
}    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 80 -- ================== -- PARAMETERS FORMATS -- ================== 
 CommunicationIdentifier  ::= SEQUENCE 
{  communication-Identity-Number [0] OCTET STRING (SIZE (1..8)) OPTIONAL, 
  -- Temporary Identifier of an intercepted call to uniquely identify an intercepted call 
  -- within the node. This parameter is mandatory if there is associated 
  -- information sent over HI3interface (CClink, data,..) or when 
  -- CommunicationIdentifier is used for IRI other than IRI-Report-record 
  -- This parameter was called "call-Identity-Number" in V1.1.1 of ES 201 671. 
  -- The individual digits of the communication-Identity-Number shall be represented in 
  -- ASCII format, e.g. "12345678" = 8 octets 0x31 0x32 0x33 0x34 0x35 0x36 0x37 0x38. 
 network-Identifier    [1] Network-Identifier, 
 ... } -- NOTE: The same "CommunicationIdentifier" value is sent : -- with the HI3 information for correlation purpose between the IRI and the information sent on -- the HI3 interfaces (CCLink, data, ..) with each IRI associated to a same intercepted call -- for correlation purpose between the different IRI.  
Network-Identifier  ::= SEQUENCE 
{  operator-Identifier   [0] OCTET STRING (SIZE (1..5)), 
  -- It is a notification of the NWO/AP/SvP in ASCII- characters. 
  -- The parameter is mandatory. 
 network-Element-Identifier  [1] Network-Element-Identifier OPTIONAL, 
 ... }  
Network-Element-Identifier ::= CHOICE 
{  e164-Format   [1] OCTET STRING (SIZE (1..25)), 
  -- E164 address of the node in international format. Coded in the same format as the 
  -- calling party number parameter of the ISUP (parameter part: ETSI EN 300 356 [5]). 
 x25-Format   [2] OCTET STRING (SIZE (1..25)), 
  -- X25 address 
 iP-Format   [3] OCTET STRING (SIZE (1..25)), 
  -- IP address 
 dNS-Format   [4] OCTET STRING (SIZE (1..25)), 
  -- DNS address 
 ...,  iP-Address   [5] IPAddress 
}  
CC-Link-Identifier  ::=  OCTET STRING (SIZE (1..8)) 
 -- Depending on a network option, this parameter may be used to identify a CClink 
 -- in case of multiparty calls. 
 -- The individual digits of the communication-Identity-Number shall be represented in 
 -- ASCII format, e.g. "12345678" = 8 octets 0x31 0x32 0x33 0x34 0x35 0x36 0x37 0x38. 
 
TimeStamp     ::= CHOICE 
{ -- The minimum resolution required is one second. -- "Resolution" is the smallest incremental change that can be measured for time and -- is expressed with a definite number of decimal digits or bits.  localTime   [0] LocalTimeStamp, 
 utcTime    [1] UTCTime 
}  
LocalTimeStamp    ::= SEQUENCE 
{  generalizedTime     [0] GeneralizedTime, 
  -- The minimum resolution required is one second.   -- "Resolution" is the smallest incremental change that can be measured for time and 
  -- is expressed with a definite number of decimal digits or bits. 
 winterSummerIndication   [1] ENUMERATED 
 {   notProvided(0),   winterTime(1),   summerTime(2),   ...  } }    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 81 PartyInformation    ::= SEQUENCE 
{  party-Qualifier      [0] ENUMERATED 
 {   originating-Party(0),    -- In this case, the partyInformation parameter provides the identities related to 
   -- the originating party and all information provided by this party. 
   -- This parameter provides also all the information concerning the redirecting 
   -- party when a forwarded call reaches a target. 
  terminating-Party(1),    -- In this case, the partyInformation parameter provides the identities related to 
   -- the terminating party and all information provided by this party. 
  forwarded-to-Party(2),    -- In this case, the partyInformation parameter provides the identities related to 
   -- the forwarded to party and parties beyond this one and all information 
   -- provided by this parties, including the call forwarding reason. 
  gPRS-Target(3),   ...  },  partyIdentity       [1] SEQUENCE 
 {   imei    [1] OCTET STRING (SIZE (8)) OPTIONAL, 
   -- See MAP format 3GPP TS 09.02 [32] 
  tei     [2] OCTET STRING (SIZE (1..15)) OPTIONAL, 
   -- ISDN-based Terminal Equipment Identity 
  imsi    [3] OCTET STRING (SIZE (3..8)) OPTIONAL, 
   -- See MAP format 3GPP TS 09.02 [32] International Mobile 
   -- Station Identity E.212 number beginning with Mobile Country Code 
  callingPartyNumber [4] CallingPartyNumber OPTIONAL, 
   -- The calling party format is used to transmit the identity of a calling party 
  calledPartyNumber [5] CalledPartyNumber OPTIONAL, 
   -- The called party format is used to transmit the identity of a called party or 
   -- a forwarded to party. 
  msISDN    [6] OCTET STRING (SIZE (1..9)) OPTIONAL, 
   -- MSISDN of the target, encoded in the same format as the AddressString 
   -- parameters defined in MAP format 3GPP TS 09.02 [32], clause 14.7.8. 
  ...,   e164-Format   [7] OCTET STRING (SIZE (1..25)) OPTIONAL, 
   -- E164 address of the node in international format. Coded in the same format as 
   -- the calling party number parameter of the ISUP (parameter part: ETSI EN 300 356 [5]) 
  sip-uri    [8] OCTET STRING OPTIONAL, 
   -- Session Initiation Protocol - Uniform Resource Identifier. See IETF RFC 3261 [59]. 
   -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
  tel-url    [9] OCTET STRING OPTIONAL 
   -- See "URLs for Telephone Calls", RFC 3966 [68]. 
   -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
 },  services-Information    [2] Services-Information OPTIONAL, 
  -- This parameter is used to transmit all the information concerning the 
  -- complementary information associated to the basic call 
 supplementary-Services-Information [3] Supplementary-Services OPTIONAL, 
  -- This parameter is used to transmit all the information concerning the 
  -- activation/invocation of supplementary services during a call or out-of call not 
  -- provided by the previous parameters. 
 services-Data-Information    [4] Services-Data-Information OPTIONAL, 
  -- This parameter is used to transmit all the information concerning the complementary 
  -- information associated to the basic data call. 
 ... }  CallingPartyNumber  ::= CHOICE 
{  iSUP-Format   [1] OCTET STRING (SIZE (1..25)), 
  -- Encoded in the same format as the calling party number (parameter field) 
  -- of the ISUP (see EN 300 356 [5]). 
 dSS1-Format   [2] OCTET STRING (SIZE (1..25)), 
  -- Encoded in the format defined for the value part of the Calling party number 
  -- information element of DSS1 protocol EN 300 403-1 [6]. 
  -- The DSS1 Information element identifier and the DSS1 length are not included. 
 ...,  mAP-Format   [3] OCTET STRING (SIZE (1..25)) 
  -- Encoded as AddressString of the MAP protocol 3GPP TS 09.02 [32]. 
}    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 82 CalledPartyNumber  ::= CHOICE 
{  iSUP-Format   [1] OCTET STRING (SIZE (1..25)), 
  -- Encoded in the same format as the called party number (parameter field) 
  -- of the ISUP (see ETSI EN 300 356 [5]). 
 mAP-Format   [2] OCTET STRING (SIZE (1..25)), 
  -- Encoded as AddressString of the MAP protocol 3GPP TS 09.02 [32]. 
 dSS1-Format   [3] OCTET STRING (SIZE (1..25)), 
  -- Encoded in the format defined for the value part of the Called party number information 
  -- element of DSS1 protocol ETSI EN 300 403-1 [6]. 
  -- The DSS1 Information element identifier and the DSS1 length are not included. 
 ... }  Location ::= SEQUENCE 
{  e164-Number   [1] OCTET STRING (SIZE (1..25)) OPTIONAL, 
  -- Coded in the same format as the ISUP location number (parameter 
  --field) of the ISUP (see EN 300 356 [5]). 
 globalCellID  [2] OCTET STRING (SIZE (5..7)) OPTIONAL, 
  -- See MAP format (see 3GPP TS 09.02 [32]). 
 tetraLocation  [3] TetraLocation OPTIONAL, 
  -- This optional parameter is not in use anymore, but is kept for backwards compatibility. 
 rAI     [4] OCTET STRING (SIZE (6)) OPTIONAL, 
  -- The Routeing Area Identifier (RAI) in the current SGSN is coded in accordance with 
  -- 3GPP TS 24.008 [41] without the Routing Area Identification IEI (only the 
  -- last 6 octets are used). 
 gsmLocation   [5] GSMLocation OPTIONAL, 
 umtsLocation  [6] UMTSLocation OPTIONAL, 
 sAI     [7] OCTET STRING (SIZE (7)) OPTIONAL, 
  -- format: PLMN-ID 3 octets (no. 1-3), 
  --    LAC  2 octets (no. 4-5), 
  --    SAC  2 octets (no. 6-7) 
  --    (according to 3GPP TS 25.431 [62]). 
 ...,  oldRAI    [8] OCTET STRING (SIZE (6)) OPTIONAL 
  -- the "Routeing Area Identifier" in the old SGSN is coded in accordance with 
  -- 3GPP TS 24.008 [41] without the Routing Area Identification IEI 
  -- (only the last 6 octets are used). 
  -- This parameter is duplicated from 3GPP TS 33.108 [61]. 
}  
TetraLocation ::= CHOICE 
  -- This optional parameter is not in use anymore, but is kept for backwards compatibility. 
{  ms-Loc  [1] SEQUENCE 
 {   mcc    [1] INTEGER (0..1023), 
   -- 10 bits ETSI EN 300 392-1 [40] 
  mnc    [2] INTEGER (0..16383), 
   -- 14 bits ETSI EN 300 392-1 [40] 
  lai    [3] INTEGER (0..65535), 
   -- 14 bits ETSI EN 300 392-1 [40] 
  ci    [4] INTEGER OPTIONAL 
 },  ls-Loc  [2] INTEGER 
}    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 83 GSMLocation  ::= CHOICE 
{  geoCoordinates   [1] SEQUENCE 
 {   latitude [1] PrintableString (SIZE(7..10)), 
   -- format: XDDMMSS.SS 
  longitude [2] PrintableString (SIZE(8..11)), 
   -- format: XDDDMMSS.SS 
  mapDatum [3] MapDatum DEFAULT wGS84, 
  ...,   azimuth  [4] INTEGER (0..359) OPTIONAL 
   -- The azimuth is the bearing, relative to true north. 
 },   -- format:  XDDDMMSS.SS 
  --   X   : 
N(orth), S(outh), E(ast), W(est)   --   DD or DDD  : degrees (numeric characters) 
  --   MM   : minutes (numeric characters) 
  --   SS.SS   : seconds, the second part (.SS) is optional 
  -- Example: 
  --   latitude short form  N502312 
  --   longitude long form  E1122312.18 
  utmCoordinates  [2] SEQUENCE  
 {   utm-East  [1] PrintableString (SIZE(10)), 
  utm-North  [2] PrintableString (SIZE(7)), 
   -- Universal Transverse Mercator 
   -- example utm-East 32U0439955 
   --    utm-North 5540736 
  mapDatum [3] MapDatum DEFAULT wGS84, 
  ...,   azimuth  [4] INTEGER (0..359) OPTIONAL 
   -- The azimuth is the bearing, relative to true north. 
 },   utmRefCoordinates [3] SEQUENCE 
 {   utmref-string PrintableString (SIZE(13)), 
  mapDatum  MapDatum DEFAULT wGS84, 
  ...  },   -- example 32UPU91294045 
  wGS84Coordinates  [4] OCTET STRING 
 -- format is as defined in 3GPP TS 03.32 [57]. 
}  MapDatum ::= ENUMERATED {  wGS84,   -- World Geodetic System 1984 
 wGS72,  eD50,   -- European Datum 50 
 ... }  
UMTSLocation ::= CHOICE {  point     [1] GA-Point, 
 pointWithUnCertainty [2] GA-PointWithUnCertainty, 
 polygon     [3] GA-Polygon, 
 ... }  
GeographicalCoordinates ::= SEQUENCE {  latitudeSign ENUMERATED  {   north,   south  },  latitude  INTEGER (0..8388607), 
 longitude  INTEGER (-8388608..8388607), 
 ... }    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 84 GA-Point ::= SEQUENCE {  geographicalCoordinates  GeographicalCoordinates, 
 ... }  GA-PointWithUnCertainty ::=SEQUENCE {  geographicalCoordinates  GeographicalCoordinates, 
 uncertaintyCode    INTEGER (0..127) 
}  maxNrOfPoints     INTEGER ::= 15 
 GA-Polygon ::= SEQUENCE (SIZE (1..maxNrOfPoints)) OF  SEQUENCE  {   geographicalCoordinates  GeographicalCoordinates, 
  ...  }  
CallContentLinkCharacteristics  ::= SEQUENCE 
{  cCLink-State   [1] CCLink-State OPTIONAL, 
  -- current state of the CCLink 
 release-Time   [2] TimeStamp OPTIONAL, 
  -- date and time of the release of the Call Content Link. 
 release-Reason   [3] OCTET STRING (SIZE(2)) OPTIONAL, 
  -- Release cause coded in Recommendation ITU-T Q.850 [31] format. 
 lEMF-Address   [4] CalledPartyNumber OPTIONAL, 
  -- Directory number used to route the call toward the LEMF. 
 ... } CCLink-State ::= ENUMERATED 
{  setUpInProcess(1),   -- The set-up of the call is in process. 
 callActive(2),  callReleased(3),  lack-of-resource(4),   -- The lack-of-resource state is sent when a CC Link cannot 
  -- be established because of lack of resource at the MF level. 
 ... }  
Intercepted-Call-State   ::= ENUMERATED 
{  idle(1),   -- When the intercept call is released, the state is IDLE and the reason is provided 
  -- by the release-Reason-Of-Intercepted-Call parameter. 
 setUpInProcess(2),   -- The set-up of the call is in process. 
 connected(3),   -- The answer has been received. 
 ... }  
Services-Information   ::= SEQUENCE 
{  iSUP-parameters    [1] ISUP-parameters OPTIONAL, 
 dSS1-parameters-codeset-0 [2] DSS1-parameters-codeset-0 OPTIONAL, 
 ...,  mAP-parameters    [3] MAP-parameters OPTIONAL 
}    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 85 ISUP-parameters   ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "OCTET STRING" contains one additional ISUP parameter TLV coded not already defined in -- the previous parameters. The Tag value is the one given in EN 300 356 [5].   -- In version 1 of the present document "iSUP-parameters" is defined as mandatory. 
 -- It might occur that no ISUP parameter is available. In that case in a version 1 
 -- implementation the value "zero" may be included in the first octet string of the SET. 
  -- The Length and the Value are coded in accordance with the parameter definition in 
 -- EN 300 356 [5]. Hereafter are listed the main parameters. 
 -- However other parameters may be added: 
  -- Transmission medium requirement: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Transmission medium requirement prime: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
 DSS1-parameters-codeset-0  ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "OCTET STRING" contains one DSS1 parameter of the codeset-0. The parameter is coded as -- described in EN 300 403-1 [6] (The DSS1 Information element identifier and the DSS1 length -- are included). Hereafter are listed the main parameters -- (However other parameters may be added):   -- Bearer capability: this parameter may be repeated. Format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
  -- High Layer Compatibility: this parameter may be repeated. Format defined in EN 300 403-1 [6] 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
  -- Low Layer capability: this parameter may be repeated. Format defined in EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party", 
 -- "called party" or "forwarded to party". 
 
MAP-parameters ::= SET SIZE (1..256) OF OCTET STRING (SIZE(1..256)) -- Each "OCTET STRING" contains one MAP parameter. The parameter is coded as described in -- 3GPP TS 09.02 [32] (The map-TS-Code is included).  
Supplementary-Services   ::= SEQUENCE 
{  standard-Supplementary-Services  [1] Standard-Supplementary-Services OPTIONAL, 
 non-Standard-Supplementary-Services [2] Non-Standard-Supplementary-Services OPTIONAL,  other-Services       [3] Other-Services OPTIONAL, 
 ... }  
Standard-Supplementary-Services  ::= SEQUENCE 
{  iSUP-SS-parameters    [1] ISUP-SS-parameters OPTIONAL, 
 dSS1-SS-parameters-codeset-0 [2] DSS1-SS-parameters-codeset-0 OPTIONAL, 
 dSS1-SS-parameters-codeset-4 [3] DSS1-SS-parameters-codeset-4 OPTIONAL, 
 dSS1-SS-parameters-codeset-5 [4] DSS1-SS-parameters-codeset-5 OPTIONAL, 
 dSS1-SS-parameters-codeset-6 [5] DSS1-SS-parameters-codeset-6 OPTIONAL, 
 dSS1-SS-parameters-codeset-7 [6] DSS1-SS-parameters-codeset-7 OPTIONAL, 
 dSS1-SS-Invoke-components  [7] DSS1-SS-Invoke-Components OPTIONAL, 
 mAP-SS-Parameters    [8] MAP-SS-Parameters OPTIONAL, 
 mAP-SS-Invoke-Components  [9] MAP-SS-Invoke-Components OPTIONAL, 
 ... }  
Non-Standard-Supplementary-Services ::= SET SIZE (1..20) OF CHOICE {  simpleIndication  [1] SimpleIndication, 
 sciData     [2] SciDataMode, 
 ... }  
Other-Services    ::= SET SIZE (1..50) OF OCTET STRING (SIZE (1..256)) 
-- Reference manufacturer manuals.    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 86 ISUP-SS-parameters   ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- It shall be noticed this parameter is retained for compatibility reasons. -- It is recommended not to use it in new work but to use ISUP-parameters parameter.  -- Each "OCTET STRING" contains one additional ISUP parameter TLV coded not already defined in -- the previous parameters. The Tag value is the one given in EN 300 356 [5]. -- The Length and the Value are coded in accordance with the parameter definition in EN 300 356 [5]. -- Hereafter are listed the main parameters. However other parameters may be added:   -- Connected Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- RedirectingNumber: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "originating party". 
  -- Original Called Party Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "originating party". 
  -- Redirection information: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "originating party", "forwarded to party" or/and "Terminating party". 
  -- Redirection Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "forwarded to party" or "Terminating party". 
  -- Call diversion information: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "forwarded to party" or "Terminating party". 
  -- Generic Number: format defined in EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
 -- This parameters are used to transmit additional identities (additional, calling party 
 -- number, additional called number, –). 
  -- Generic Notification: format defined in EN 300 356 [5]. 
 -- This parameter may be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
 -- This parameters transmit the notification to the other part of the call of the supplementary 
 -- services activated or invoked by a subscriber during the call. 
  -- CUG Interlock Code: format defined in ETSI EN 300 356 [5]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
 DSS1-SS-parameters-codeset-0 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "OCTET STRING" contains one DSS1 parameter of the codeset-0. The parameter is coded as -- described in EN 300 403-1 [6] (The DSS1 Information element identifier and the DSS1 length -- are included). Hereafter are listed the main parameters (However other parameters may be added):   -- Calling Party Subaddress: format defined in ETSI EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Called Party Subaddress: format defined in ETSI EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the "calling party". 
  -- Connected Subaddress: format defined in recommendation (see ETSI EN 300 097-1 [14]). 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- Connected Number: format defined in recommendation (see ETSI EN 300 097-1 [14]). 
 -- This parameter can be provided with the "Party Information" of the 
 -- "called party" or "forwarded to party". 
  -- Keypad facility: format defined in ETSI EN 300 403-1 [6]. 
 -- This parameter can be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
  -- Called Party Number: format defined in ETSI EN 300 403-1 [6]. 
 -- This parameter could be provided with the "Party Information" of the "calling party" 
 -- when target is the originating party; it contains the dialled digits before modification 
 -- at network level (e.g. IN interaction, translation, etc –). 
  -- User-user: format defined in ETSI EN 300 286-1 [23]). 
 -- This parameter can be provided with the "Party Information" of the 
 -- "calling party", "called party" or "forwarded to party". 
   ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 87 DSS1-SS-parameters-codeset-4 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "OCTET STRING" contains one DSS1 parameter of the codeset-4. The parameter is coded as -- described in the relevant recommendation.  DSS1-SS-parameters-codeset-5 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "OCTET STRING" contains one DSS1 parameter of the codeset-5. The parameter is coded as -- described in the relevant national recommendation.  
DSS1-SS-parameters-codeset-6 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "OCTET STRING" contains one DSS1 parameter of the codeset-6. The parameter is coded as -- described in the relevant local network recommendation.  
DSS1-SS-parameters-codeset-7 ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "octet string" contains one DSS1 parameter of the codeset-7. The parameter is coded as -- described in the relevant user specific recommendation.  
DSS1-SS-Invoke-Components ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "octet string" contains one DSS1 Invoke or Return Result component. -- The invoke or return result component is coded as -- described in the relevant DSS1 supplementary service recommendation.  -- Invoke or Return Result component (BeginCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (AddCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (SplitCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (DropCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (IsolateCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (ReattachCONF): EN 300 185-1 [19] 
 -- Invoke or Return Result component (PartyDISC): EN 300 185-1 [19] 
 -- Invoke or Return Result component (MCIDRequest): EN 300 130-1 [16] 
 -- Invoke or Return Result component (Begin3PTY): EN 300 188-1 [20] 
 -- Invoke or Return Result component (End3PTY): EN 300 188-1 [20] 
 -- Invoke or Return Result component (ECTExecute): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTInform): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTLinkIdRequest): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECTLoopTest): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ExplicitECTExecute): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECT: RequestSubaddress): EN 300 369-1 [25] 
 -- Invoke or Return Result component (ECT: SubaddressTransfer): EN 300 369-1 [25] 
 -- Invoke or Return Result component (CF: ActivationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DeactivationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: ActivationStatusNotification): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DeactivationStatusNotification): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: InterrogationDiversion): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: InterrogationServedUserNumber): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DiversionInformation): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: CallDeflection): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: CallRerouteing): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation1): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation2): EN 300 207-1 [21] 
 -- Invoke or Return Result component (CF: DivertingLegInformation3): EN 300 207-1 [21] 
 -- other invoke or return result components ... 
 
MAP-SS-Invoke-Components ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "octet string" contains one MAP Invoke or Return Result component. -- The invoke or return result component is coded as -- described in the relevant MAP supplementary service recommendation.  
MAP-SS-Parameters   ::= SET SIZE (1..256) OF OCTET STRING (SIZE (1..256)) 
-- Each "octet string" contains one MAP Parameter. The parameter is coded as -- described in the relevant MAP supplementary service recommendation.    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 88 SimpleIndication  ::= ENUMERATED 
{  call-Waiting-Indication(0),   -- The target has received a call waiting indication for this call 
 add-conf-Indication(1),   -- this call has been added to a conference 
 call-on-hold-Indication(2),   -- indication that this call is on hold 
 retrieve-Indication(3),   -- indication that this call has been retrieved 
 suspend-Indication(4),   -- indication that this call has been suspended 
 resume-Indication(5),   -- indication that this call has been resumed 
 answer-Indication(6),   -- indication that this call has been answered 
 ... }  SciDataMode  ::= OCTET STRING (SIZE (1..256)) 
 SMS-report  ::= SEQUENCE 
{  communicationIdentifier [1] CommunicationIdentifier,   -- used to uniquely identify an intercepted call: the same used for the 
  -- relevant IRI 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671. 
 timeStamp     [2] TimeStamp, 
  -- date and time of the report. The format is 
  -- the one defined in case a) of the ASN.1 ITU-T Recommendation X.680 [33]. 
  -- (year month day hour minutes seconds) 
 sMS-Contents    [3] SEQUENCE 
 {   initiator   [1] ENUMERATED 
  { 
   -- party which sent the SMS 
   target(0),    server(1),    undefined-party(2),    ...   },   transfer-status  [2] ENUMERATED 
  { 
   succeed-transfer(0),     --the transfer of the SMS message succeeds 
   not-succeed-transfer(1),    undefined(2),    ...   } OPTIONAL, 
  other-message  [3] ENUMERATED 
  { 
   -- In case of terminating call, indicates if the server will send other SMS. 
   yes(0),    no(1),    undefined(2),    ...   } OPTIONAL, 
  content    [4] OCTET STRING (SIZE (1..270)) OPTIONAL, 
   -- Encoded in the format defined for the SMS mobile. 
  ...  } }  
LawfulInterceptionIdentifier ::= OCTET STRING (SIZE (1..25)) 
-- It is recommended to use ASCII characters in "a"–"z", "A"–"Z", "-", "_", ".", and "0"–"9". -- For subaddress option only "0"..."9" shall be used.  
National-Parameters  ::= SET SIZE (1..40) OF OCTET STRING (SIZE (1..256)) 
-- Content defined by national law.  GPRSCorrelationNumber ::= OCTET STRING (SIZE(8..20))    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 89 GPRSEvent ::= ENUMERATED {  pDPContextActivation(1),  startOfInterceptionWithPDPContextActive(2),  pDPContextDeactivation(4),  gPRSAttach(5),  gPRSDetach(6),  cellOrRAUpdate(10),  sMS(11),  ...,  pDPContextModification(13) } -- see 3GPP TS 03.33 [42]  Services-Data-Information ::= SEQUENCE {  gPRS-parameters  [1] GPRS-parameters OPTIONAL, 
 ... }  
GPRS-parameters ::= SEQUENCE {  pDP-address-allocated-to-the-target  [1] DataNodeAddress OPTIONAL, 
 aPN          [2] OCTET STRING (SIZE(1..100)) OPTIONAL, 
 pDP-type         [3] OCTET STRING (SIZE(2)) OPTIONAL, 
 ... }  
GPRSOperationErrorCode ::= OCTET STRING (SIZE(2)) -- Refer to 3GPP TS 24.008 [41] for values (GMM cause or SM cause parameter).  DataNodeAddress ::= CHOICE {  ipAddress  [1] IPAddress, 
 x25Address  [2] X25Address,  ... }  IPAddress ::= SEQUENCE {  iP-type   
[1] ENUMERATED  {   iPV4(0),   iPV6(1),   ...  },  iP-value  [2] IP-value,  iP-assignment [3] ENUMERATED  {   static(1),    -- The static coding shall be used to report a static address. 
  dynamic(2),    -- The dynamic coding shall be used to report a dynamically allocated address. 
  notKnown(3),    -- The notKnown coding shall be used to report other then static or dynamically 
   -- allocated IP addresses. 
  ...  } OPTIONAL, 
 ... }  
IP-value ::= CHOICE {  iPBinaryAddress [1] OCTET STRING (SIZE(4..16)),  iPTextAddress [2] IA5String (SIZE(7..45)), 
 ... }  X25Address ::= OCTET STRING (SIZE(1..25))    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 90 National-HI2-ASN1parameters ::= SEQUENCE {  countryCode  [1] PrintableString (SIZE (2)), 
  -- Country Code according to ISO 3166-1 [67], 
  -- the country to which the parameters inserted after the extension marker apply. 
 ...   -- In case a given country wants to use additional national parameters according to its law, 
  -- these national parameters should be defined using the ASN.1 syntax and added after the 
  -- extension marker (...). 
  -- It is recommended that "version parameter" and "vendor identification parameter" are 
  -- included in the national parameters definition. Vendor identifications can be 
  -- retrieved from the IANA web site (see annex H). Besides, it is recommended to avoid 
  -- using tags from 240 to 255 in a formal type definition. 
}  END -- end of HI2Operations  D.6 User data packet transfer (HI3 CS) 


ASN.1 description of circuit data transfer operation (HI3 interface) 
HI3CircuitDataOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) circuitLI(1) version3(3)}  DEFINITIONS IMPLICIT TAGS ::=  -- The following operations are used to transmit user data which can be exchanged via the DSS1, ISUP -- or MAP signalling (e.g. UUS, SMS).  BEGIN  IMPORTS OPERATION,  ERROR   FROM Remote-Operations-Information-Objects 
  {joint-iso-itu-t(2) remote-operations(4) informationObjects(5) version1(0)} 
  -- from clause D.5 
 LawfulInterceptionIdentifier,  CommunicationIdentifier,  TimeStamp,  OperationErrors,  Supplementary-Services,  SMS-report   FROM HI2Operations 
  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) 
version10(10)};  
-- ============================= -- Object Identifier definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi3 Domain hi3CircuitLIId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi3(2) circuitLI(1)} hi3CircuitLIOperationId OBJECT IDENTIFIER ::= {hi3CircuitLIId version3(3)}  
circuit-Call-related-Services OPERATION ::= 
{  ARGUMENT Content-Report  ERRORS  {OperationErrors} 
 CODE  global:{hi3CircuitLIId circuit-Call-Serv(1) version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 3s and 240s. -- The timer default value is 60s. -- NOTE: The same note as for HI management operation applies.    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 91 no-Circuit-Call-related-Services OPERATION ::= 
{  ARGUMENT Content-Report  ERRORS   {OperationErrors} 
 CODE  global:{hi3CircuitLIId no-Circuit-Call-Serv(2) version1(1)} 
} -- Class 2 operation. The timer shall be set to a value between 10s and 120s. -- The timer default value is 60s.  Content-Report  ::= SEQUENCE 
{  domainID      [0] OBJECT IDENTIFIER (hi3CircuitLIOperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 lawfulInterceptionIdentifier [6] LawfulInterceptionIdentifier OPTIONAL, 
 communicationIdentifier  [1] CommunicationIdentifier, 
  -- Used to uniquely identify an intercepted call: the same as used for the relevant IRI. 
  -- Called "callIdentifier" in V1.1.1 of ES 201 671. 
 timeStamp      [2] TimeStamp, 
 initiator      [3] ENUMERATED 
 {   originating-party(0),   terminating-party(1),   forwarded-to-party(2),   undefined-party(3),   ...  } OPTIONAL, 
 content       [4] Supplementary-Services OPTIONAL, 
  -- UUI are encoded in the format defined for the User-to-user information parameter 
  -- of the ISUP protocol (see ETSI EN 300 356 [5]). Only one UUI parameter is sent per 
message.  sMS-report      [5] SMS-report OPTIONAL, 
 ... }  END -- end of HI3CircuitDataOperations  D.7 TETRA data transfer (HI3 interface) 

D.8 Definition of the UUS1 content associated to the CC 
link 
ASN.1 description of the UUS1 content associated to the CC link 
HI3CCLinkData 
{itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) cclinkLI(4) version4(4)}  DEFINITIONS IMPLICIT TAGS ::=  BEGIN  IMPORTS  -- from clause D.5 
 LawfulInterceptionIdentifier,  CommunicationIdentifier,  CC-Link-Identifier   FROM HI2Operations 
  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) 
version10(10)};  
-- ============================= -- Object Identifier Definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}   ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 92  -- hi3 Domain hi3CCLinkId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi3(2) ccLinkLI(4)} hi3CCLinkIdOperationId OBJECT IDENTIFIER ::= {hi3CCLinkId version4(4)}  UUS1-Content ::= SEQUENCE 
{  domainID       [0] OBJECT IDENTIFIER (hi3CCLinkIdOperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 lawfullInterceptionIdentifier  [1] LawfulInterceptionIdentifier, 
 communicationIdentifier   [2] CommunicationIdentifier, 
 cC-Link-Identifier     [3] CC-Link-Identifier OPTIONAL, 
 direction-Indication    [4] Direction-Indication, 
 bearer-capability     [5] OCTET STRING (SIZE(1..12)) OPTIONAL, 
  -- transport the Bearer capability information element (value part) 
  -- Protocol: ETSI EN 300 403-1 [6] 
 service-Information    [7] Service-Information OPTIONAL,
  ... }  -- ================== -- PARAMETERS FORMATS -- ==================  Direction-Indication ::= ENUMERATED 
{  mono-mode(0),  cc-from-target(1),  cc-from-other-party(2),  ...,  direction-unknown(3) }  
Service-Information ::= SET {  high-layer-capability [0] OCTET STRING (SIZE(1)) OPTIONAL, 
  -- HLC (octet 4 only) 
  -- Protocol: ETSI EN 300 403-1 [6] 
 tMR      [1] OCTET STRING (SIZE(1)) OPTIONAL, 
  -- Transmission Medium Requirement 
  -- Protocol: ISUP EN 300 356 [5] 
 bearerServiceCode   [2] OCTET STRING (SIZE(1)) OPTIONAL, 
 teleServiceCode   [3] OCTET STRING (SIZE(1)) OPTIONAL 
  -- from MAP, 3GPP TS 09.02 [32], clause 14.7.9 and clause 14.7.10 
}  END -- end of HI3CCLinkData  D.9 Content of Communication (HI3 GPRS) 
ASN.1 description of the GPRS content 
Gprs-HI3-PS 
{itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) gPRSLI(3) version3(3)}  DEFINITIONS IMPLICIT TAGS ::=  BEGIN  IMPORTS  -- from 3GPP TS 33.108 [61] 
 CC-PDU   FROM Umts-HI3-PS 
  {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulintercept(2) 
threeGPP(4) hi3(2) r7(7) version-0(0)};    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 93 -- ============================= -- Object Identifier definitions -- =============================  -- LawfulIntercept DomainId lawfulInterceptDomainId OBJECT IDENTIFIER ::= {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2)}  -- hi3 Domain hi3GPRSLIId OBJECT IDENTIFIER ::= {lawfulInterceptDomainId hi3(2) gPRSLI(3)} hi3GPRSLIIdOperationId OBJECT IDENTIFIER ::= {hi3GPRSLIId version3(3)}  ETSI-CC-PDU ::= SEQUENCE {  domainID   [0] OBJECT IDENTIFIER (hi3GPRSLIIdOperationId) OPTIONAL, 
  -- Once using FTP delivery mechanism 
 eTSI-CC-PDU   [1] CC-PDU,  ... }  END -- end of Gprs-HI3-PS    ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 94 Annex E (informative): 
Use of subaddress and calling party number to carry 
correlation information E.1 Introduction 











E.2 Subaddress options 

Table E.2.1: Subaddress options 
Option
 Value Type of subaddress user specified 
Odd/even indicator employed for called party subaddress when no national parameters are used 
E.3 Subaddress coding 
E.3.0 General 

E.3.1 BCD values 



  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 95 Table E.3.1: Coding BCD values 
Item BCD representation
  Bit 4 Bit 3 Bit 2 Bit 1 0 0 0 0 0 
1 0 0 0 1 
2 0 0 1 0 
3 0 0 1 1 
4 0 1 0 0 
5 0 1 0 1 
6 0 1 1 0 
7 0 1 1 1 
8 1 0 0 0 
9 1 0 0 1 
Field separator 1 1 1 1 

E.3.2 Field order and layout 

Table E.3.2: Fields in the called party subaddress 
Order
 Field 1 Operator-ID 
2 CIN 
3 CCLID 
4 National Parameters 
Table E.3.3: Fields in the calling party subaddress 
Order
 Field 1 Lawful Interception Identifier (LIID) 
2 Direction 
3 Service Octets 



























  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 96 


• 

• 


• 


 
 
• 










Table E.3.4: Called party subaddress 
Bits Octets
 8 7 6 5 4 3 2 1  Called party subaddress identifier 
1 Length of called party subaddress contents 
2 Type of subaddress = user specified, odd/even 
indicator 
3 Operator-ID 
 Operator-ID 
 4 Operator-ID 
 Operator-ID 
 5 Field separator Operator-ID 
 6 CIN  CIN  7 CIN  CIN  8 CIN  CIN  9 CIN  CIN  10 
CCLID 
 Field 
separator 
 11 
CCLID 
 CCLID 
 12 
CCLID 
 CCLID 
 13 
CCLID 
 CCLID 
 14 
Field separator  
CCLID 
 15 
(see note) 
16 
 17 
 18 
 19 
 20 
 21 
 22 
 23 
NOTE: The Octets after the final field (CCLID) of the Called 
Party Subaddress are reserved for national use, e.g. for 
authentication purposes. 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 97 Table E.3.5: Calling party subaddress 
Bits Octets
 8 7 6 5 4 3 2 1  Calling party subaddress identifier 
1 Length of calling party subaddress contents 
2 Type of subaddress = user specified, odd/even 
indicator according to the amount of BCD-digits 
3 LIID  LIID  4 LIID  LIID  5 LIID  LIID  6 LIID  LIID  7 LIID  LIID  8 LIID  LIID  9 LIID  LIID  10 
LIID  LIID  11 
LIID  LIID  12 
LIID  LIID  13 
LIID  LIID  14 
LIID  LIID  15 
Field separator 
LIID 
 16 
Field separator 
Direction 
17 
spare spare 18 
Recommendation ITU-T Q.763 [48] TMR 
(see note 1) 
19 
Recommendation ITU-T Q.931 BC [56] octet 3 
(see note 2) 
20 
Recommendation ITU-T Q.931 HLC [56] 
octet 4 (see note 3) 
21 
Mobile Bearer Service Code 
(see note 4) 
22 
Mobile Teleservice Code (see note 5) 
23 
NOTE 1: If available, the Transmission Medium Requirement 
according to ETSI EN 300 356 [5]. If not available, the 
value is "FF" hex. 
NOTE 2: If available, only octet 3 of the Bearer Capability 
i.e. according to ETSI EN 300 403-1 [6] If not available, the 

value is "FF" hex. 
NOTE 3: If available, only octet 4 of the High Layer Compatibility 
i.e. according to ETSI EN 300 403-1 [6]. If not available, 
the value is "FF" hex. 
NOTE 4: If available, the Mobile Bearer Service Code
 according to 
3GPP TS 09.02 [32], clause 14.7.10. If not available, the 
octets 22 and 23 (even if the mobile teleservice code is 
available) are not transmitted. 
If the mobile teleservice code is available optionally 

octet 22 could be filled with "FF" hex and be transmitted. 
NOTE 5: If available, the mobile teleservice code
 according to 
3GPP TS 09.02 [32], clause 14.7.9. If not available, the 

octet 23 is not transmitted. 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 98 Table E.3.6: Example how field separator should be used when field is empty 
Called party subaddress without CIN parameter 
Bits Octets
 8 7 6 5 4 3 2 1  Called party subaddress identifier 
1 Length of called party subaddress contents 
2 Type of subaddress = user specified, odd/even 
indicator  
3 Operator-ID 
 Operator-ID 
 4 Operator-ID 
 Operator-ID 
 5 Field separator Operator-ID 
 6 CCLID 
 Field 
separator 7 
CCLID 
 CCLID 
 8 CCLID 
 CCLID 
 9 CCLID 
 CCLID 
 10 
Field separator 
CCLID 
 11 
spare spare 12 
spare spare 13 
spare spare 14 
spare spare 15 
(see note) 
16 
 17 
 18 
 19 
 20 
 21 
 22 
 23 
NOTE: The Octets after the final field (CCLID) of the Called 
Party Subaddress are reserved for national use, e.g. for 
authentication purposes. 

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 99 Table E.3.7: Calling Party Subaddress 
(fixed length of 23 octets; example with LIID of only 5 digits) 
Bits Octets
 8 7 6 5 4 3 2 1  Calling party subaddress identifier 
1 Length of calling party subaddress contents 
2 Type of subaddress = user specified, odd/even 
indicator according to the amount of BCD-digits 
3 LIID  LIID  4 LIID  LIID  5 Field separator 
LIID 
 6 Field separator 
Direction 
7 spare spare 8 
spare spare 9 
spare spare 10 
spare spare 11 
spare spare 12 
spare spare 13 
spare spare 14 
spare spare 15 
spare spare 16 
spare spare 17 
spare spare 18 
Recommendation ITU-T Q.763 [48] TMR 
(see note 1) 
19 
Recommendation ITU-T Q.931 BC [56] 
octet 3 (see note 2) 
20 
Recommendation ITU-T Q.931 HLC [56] 
octet 4 (see note 3) 
21 
Mobile Bearer Service Code 
(see note 4) 
22 
Mobile Teleservice Code (see note 5) 
23 
NOTE 1: If available, the Transmission Medium Requirement 
according to ETSI EN 300 356 [5]. 
If not available, the value is "FF" hex. 
NOTE 2: If available, only octet 3 of the Bearer Capability 
i.e. according to ETSI EN 300 403-1 [6]. 
If not available, the value is "FF" hex. 
NOTE 3: If available, only octet 4 of the High Layer Compatibility 
i.e. according to ETSI EN 300 403-1 [6]. 
If not available, the value is "FF" hex. 
NOTE 4: If available, the Mobile Bearer Service Code
 according to 
3GPP TS 09.02 [32], clause 14.7.10. 

If not available, the octets 22 and 23 (even if the mobile 

teleservice code is available) are not transmitted. 
Optional octet 22 could be filled with "FF" hex and the Mobile 
Teleservice Code be transmitted. 
NOTE 5: If available, the Mobile Teleservice Code
 according to 3GPP 
TS 09.02 [32], clause 14.7.9. 
If not available, the octet 23 is not transmitted. 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 100 Table E.3.8: Calling Party Subaddress 
(variable length; example with LIID of only 5 digits) 
Bits Octets
 8 7 6 5 4 3 2 1  Calling party subaddress identifier 
1 Length of calling party subaddress contents 
2 Type of subaddress = user specified, odd/even 
indicator according to the amount of BCD-digits 
3 LIID  LIID  4 LIID  LIID  5 Field separator 
LIID 
 6 Field separator 
Direction 
7 spare (see note 6) spare (see note 6) 
8 Recommendation ITU-T Q.763 [48] TMR 
(see note 1) 
9 Recommendation ITU-T Q.931 BC [56] 
octet 3 (see note 2) 
10 
Recommendation ITU-T Q.931 HLC [56] 
octet 4 (see note 3) 
11 
Mobile Bearer Service Code (see note 4) 
12 
Mobile Teleservice Code (see note 5) 
13 
NOTE 1: If available, the Transmission Medium Requirement according to 
ETSI EN 300 356 [5]. 
If not available, the value is "FF" hex. 
NOTE 2: If available, only octet 3 of the Bearer Capability I.e. according to 
ETSI EN 300 403-1 [6]. 

If not available, the value is "FF" hex. 
NOTE 3: If available, only octet 4 of the High Layer Compatibility I.e. 
according to ETSI EN 300 403-1 [6]. 
If not available, the value is "FF" hex. 
NOTE 4: If available, the Mobile Bearer Service Code
 according to 3GPP 
TS 09.02 [32], clause 14.7.10. 
If not available, the octet (even if the mobile teleservice code is 
available) is not transmitted. 
Optional this octet could be filled with "FF" hex and the Mobile 

Teleservice Code be transmitted. 
NOTE 5: If available, the Mobile Teleservice Code
 according to 3GPP TS 
09.02 [32], clause 14.7.9. 

If not available, the octet is not transmitted. 
NOTE 6: If the number of half octets for the LIID field and the direction 
field including the field separators is odd, then three half octets 
with the spare pattern "F" are included. 
If the number of half octets for the LIID field and the direction 

field including the field separators is even, then two half octets 

with the spare pattern "F" are included. 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 101 E.4 Field coding 
E.4.0 General 


E.4.1 Direction 
Table E.4.1: Direction coding 
Indication
 Value Mono mode (combined signal) (historic) 0 
CC from target 
1 CC to target 
2 Direction unknown 
3 E.4.2 Coding of the Calling Party Number 






























  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 102 E.5 Length of fields 



Table E.5.1: Field length 
Field 
Minimum length 
(decimal digits)
 Maximum length 
(decimal digits)
 Maximum length 
(Half-Octets)
 I.E. Operator ID 
2 5 5 + 1 CdP Sub 
CIN 
6 8 8 + 1 CdP Sub 
CCLID 
1 8 8 + 1 CdP Sub 
LIID 
2 25 
25 + 1 CgP Sub 
Direction 
1 1 1 + 1 CgP Sub 
Service Octets 
  10 
CgP Sub 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 103 Annex F
 (informative): 
GPRS HI3 Interface F.1 Functional architecture 

 Figure F.1.1: Reference configuration 













F.2 Correlation 




LEASGSN
GGSN
ADMF
CC MF
IRI MF
DF3PDF2PNWO/AP/SvP™s
administration
centre
X1P
X2P
X3P
HI1
HI2
HI3
IIF  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 104 F.3 HI3 Delivery Content of Communication (CC) 
F.3.0 General 

• 
• 




F.3.1 GPRS LI correlation header 
F.3.1.1 Introduction 








F.3.1.2 Definition of GLIC header 

• 
• 
• 
• 
• 
• 

Table F.3.1: Outline of GLIC header 
 Bits Octets
 8 7 6 5 4 3 2 1 1 Version ("0 0 0") "1" 
Spare 
"1" 
GSN type 
DIR "0" 
     
 2 Message Type (value 255) 
3-4 Length 
5-6 Sequence 
Number 
7-8 
not used (value 0) 
9 not used (value 255) 
10 
not used (value 255) 
11 
not used (value 255) 
12 
not used (value 255) 
13-20 correlation 
number 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 105 
• 
• 
 
 
• 
• 

• 








• 

 


 








Table F.3.2: Outline of correlation number 
0          1          2          3   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1  Charging-ID 
Octet 1 
Charging-ID 
Octet 2 
Charging-ID 
Octet 3 
Charging-ID 
Octet 4 
Octet 13 to 16 
GGSN-ID  
Octet 17 to 20
 

Table F.3.3: GLIC header followed by the subsequent payload 
Information Element (IE) 
 Bits Octets
 8 7 6 5 4 3 2 1  1-20 GLIC- 
Header 
21-n Information 
Element 
• 








  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 106 F.3.1.3 Exceptional procedure 





F.3.1.4 Other considerations 


• 
• 
F.3.2 FTP 
F.3.2.1 Introduction 






F.3.2.2 Usage of the FTP 








• 
• 












  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 107 File naming: 








File naming method A): 

LIID









seq




ext





Table F.3.4: Possible file types 
File types that the LEA may get
 Intercepted data types
 "2" (in binary: 0011 0010) 
CC (MO) 
"4" (in binary: 0011 0100) 
CC (MT) 
"6" (in binary: 0011 0110) 
CC (MO&MT) 
"8" (in binary: 0011 1000) 
for national use 


ext



ext




ext












  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 108 File naming method B): 



AB
XY
yy

mm
dd

hh
mm
ss

eeee




t




ABXY


00
04
10

14

08

44

0000
6







F.3.2.3 Profiles 























  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 109 




ftp <flags> <destaddr>  user <leauser> <leapasswd>  cd <destpath>  lcd <srcpath>  bin  mput <files>  nlist <lastfile> <checkfile>  close EOF  


user <user-name> <password> Identify the client to the remote FTP server. cd <remote-directory> Change the working directory on the remote machine to remote-directory. lcd <directory> Change the working directory on the local machine. bin Set the file transfer type to support binary image transfer mput <local-files> Expand wild cards in the list of local files given as arguments and do a put for each file in the resulting list. Store each local file on the remote machine. nlist <remote-directory> <local-file> Print a list of the files in a directory on the remote 
machine. Send the output to local-file. close Terminate the FTP session with the remote server, and return 
to the command interpreter. Any defined macros are erased.  
<flags>



<destaddr>

<leauser>

<leapasswd>

<destpath>


<srcpath>

<files>

<lastfile>

<checkfile>





• 
• 
• 

• 


• 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 110 






• 












F.3.2.4 Exceptional procedures 








F.3.2.5 CC contents for FTP 
F.3.2.5.1 Fields 

CC-header 










  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 111 Table F.3.5: Information Elements in the fist version of the CC header 
Mode Type
 Length Value M 130 2 
Version = The version number of the format version to be used. This field has a decimal 
value, this enables version changes to the format version. The values are allocated according 
to national conventions. 
O 131 2 
HeaderLength
 = Length of the CC-header up to the start of the payload in octets. 
(This field is optional since it is useful only in such cases that these information elements 

would be transferred without a dynamic length encapsulation that contains all the length 

information anyway. This field could be needed in case of e.g. adapting to a local 
encapsulation convention.) 
O 132 2 
PayloadLength
 = Length of the payload following the CC-header. 
(This field is optional since it is useful only in such cases that these information elements 

would be transferred without a dynamic length encapsulation that contains all the length 
information anyway. This field could be needed in case of e.g. adapting to a local 

encapsulation convention.) 
M 133 1 
PayloadType
 = Type of the payload, indicating the type of the CC. Type of the payload. This 
field has a decimal value. The possible PDP Type values can be found in the standards, 

e.g. 3GPP TS 09.60 [45]. The value 255 is reserved for future PDP Types and means: 

"Other". 
O 134 4 
PayloadTimeStamp
 = Payload timestamp according to intercepting node. (Precision: 1 s, 
timezone: UTC). Format: Seconds since 1970-01-01 as in e.g. Unix (length: 4 octets). 
C 137 1 
PayloadDirection
 = Direction of the payload data. This field has a decimal value 0 if the 
payload data is going towards the target (i.e. downstream), or 1 if the payload data is being 

sent from the target (i.e. upstream). If this in
formation is transferred otherwise, e.g. in the 
protocol header, this field is not required as mandatory. If the direction information is not 

available otherwise, it is mandatory to include it here in the CC header. 
O 141 4 
CCSeqNumber
 = Identifies the sequence number of each CC packet during interception of 
the target. This field has a 32-bit value.  
M 144 8 or 20 
CorrelationNumber
 = Identifies an intercepted session of the observed target. This can be 
implemented by using e.g. the Charging Id (4 octets, see 3GPP TS 12.15 [49]) with the 

(4-octet/16-octet) Ipv4/Ipv6 address of the PDP context maintaining GGSN node attached 

after the first 4 octets. 
   <Possible future parameters are to be allocated between 145 and 253>. 
O 254 1-25 
LIID = Field indicating the LIID as defined in the present document. This field has a character 
string value, e.g. "ABCD123456". 
O 255 1-N 
PrivateExtension
 = An optional field. The optional Private Extension contains vendor or LEA 
or operator specific information. It is described in 3GPP TS 09.60 [45]. 
Table F.3.6: Information Elements in the second version of the CC header 
Mode Type
 Length Value M 130 2 
Version = The version number of the format version to be used. This field has a decimal 
value, this enables version changes to the format version. The values are allocated according 
to national conventions. 
O 131 2 
HeaderLength
 = Length of the CC-header up to the start of the payload in octets. 
(This field is optional since it is useful only in such cases that these information elements 

would be transferred without a dynamic length encapsulation that contains all the length 

information anyway. This field could be needed in case of e.g. adapting to a local 

encapsulation convention.)
 O 132 2 
PayloadLength
 = Length of the payload following the CC-header in octets. 
(This field is optional since it is useful only in such cases that these information elements 

would be transferred without a dynamic length encapsulation that contains all the length 

information anyway. This field could be needed in case of e.g. adapting to a local 
encapsulation convention.) 
M 133 1 
PayloadType 
= Type of the payload, indicating the type of the CC. Type of the payload. This 
field has a decimal value. The possible PDP Type values can be found in the standards 
(e.g. 3GPP TS 29.060 [60]). The value 255 is reserved for future PDP Types and means: 
"Other".
 O 134 4 
PayloadTimeStamp
 = Payload timestamp according to intercepting node. (Precision: 1 
second, timezone: UTC). Format: Seconds since 1970-01-01 as in e.g. Unix (length: 4 octets). 
C 137 1 
PayloadDirection
 = Direction of the payload data. This field has a decimal value 0 if the 
payload data is going towards the target (i.e. downstream), or 1 if the payload data is being 

sent from the target (i.e. upstream). If this in
formation is transferred otherwise, e.g. in the 
protocol header, this field is not required as mandatory. If the direction information is not 

available otherwise, it is mandatory to include it here in the CC header. 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 112 Mode Type
 Length Value O 141 4 
CCSeqNumber
 = Identifies the sequence number of each CC packet during interception of 
the target. This field has a 32-bit value.  
M 144 8 or 20 
CorrelationNumber 
= Identifies an intercepted session of the observed target. This can be 
implemented by using e.g. the Charging Id (4 octets, see ETSI EN 300 097-1 [14]) with the 
(4-octet/16-octet) Ipv4/Ipv6 address of the PDP context maintaining GGSN node attached 

after the first 4 octets.
    <Possible future parameters are to be allocated between 145 and 250> 
M 251 2 
MainElementID
 = Identifier for the TLV element that encompasses one or more 
HeaderElement-PayloadElement pairs for intercepted packets.  
M 252 2 
HeaderElementID
 = Identifier for the TLV element that encompasses the CC-header of a 
PayloadElement.  
M 253 2 
PayloadElementID
 = Identifier for the TLV element that encompasses one intercepted 
Payload packet.  
O 254 1-25 
LIID = Field indicating the LIID as defined in the present document. This field has a character 
string value, e.g. "ABCD123456".
 O 255 1-N 
PrivateExtension
 = An optional field. The optional Private Extension contains vendor or LEA 
or operator specific information. It is described in 3GPP TS 29.060 [60]. 
F.3.2.5.2 Information Element syntax 












T
 L
 V
 




 NOTE: The small "
V" refers to the start of a Value field that has inside it a nested structure. 




  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 113  Figure F.3.1: IE structure of a CC message that contains one intercepted packet 












F.3.2.6 Other considerations 

• 
• 

• 
• 






(2 octets)
 MainElementID
CC Length
CC(2 octets)
(N octets)
(2 octets)
 HeaderElem.ID
HeaderLength
Header Value
(2 octets)
(N octets)
(2 octets)
 PayloadElem.ID
PayloadLength
Payload Value
(2 octets)
(N octets)
CC Payload IE
CC Header IE
(2 octets)
VersionID
Length
Version
(2 octets)
(2 octets)
(2 octets)
PrivateExt.ID
Length
PrivateExtension
(2 octets)
(N octets)
PrivateExtension IE
Version IE
Intercepted data packet
(The other IEs inside the CC Header
Value field are here between)
CC Information Element
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 114 


• 
• 
• 
• 
• 







Timing considerations for the FTP transmission: 



Name
 Controlled by
 Units Description
 T1 inactivity timer 
LEMF Seconds 
Triggered by no activity within the FTP session (no new files). 
The FTP session is torn down when the T1 expires. To send 
another file the new connection will be established. The timer 

avoids the FTP session overflow at the LEMF side. 
T2 send file trigger 
MF Milliseconds 
Forces the file to be transmitted to the LEMF (even if the size limit 
has not been reached yet in case of volume trigger active). If the 
timer is set to 0 the only trigger to send the file is the file size 

parameter (see clause C.2.2). 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 115 Annex G (informative): 
LEMF requirements - handling of unrecognized fields and 
parameters 















  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 116 Annex H (informative): 
IP Multimedia Subsystem (IMS) handover 
H.0 General 










 Figure H.1.1: IRI Interception at a CSCF 
H.1 Specific identifiers for LI 
H.1.0 General 











Visited /Home Network
S-CSCF
P-CSCF
GGSN
SGSN
DF2
MF HI2
LEMF
CCIRI DF3
MF HI3


  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 117 H.1.1 Lawful interception identifier 

























H.1.2 Network identifier 











H.1.3 Correlation number 

• 
• 









• 
• 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 118 











H.1.4 IRI for IMS 
H.1.4.0 General 



 
 



Table H.1.1: Mapping between IMS Events and HI2 Records Type 
Event
 IRI Record Type
 SIP-Message REPORT 












  ETSI ETSI ES 201 671 
V3.2.1 (2018
-05) 119 Table H.1.2: Mapping between IMS Events Information and IRI Information 
Parameter Description
 HI2 ASN.1 parameter
 Observed SIP URI Observed SIP URI 
partyInformation (sip-uri) 
Observed TEL URL Observed TEL URL 
partyInformation (tel-url) 
Event type 
IMS Event 
iMSevent 
Event date 
Date of the event generation in the CSCF 
timeStamp 
Event time 
Time of the event generation in the CSCF 
 Network identifier Unique number of the intercepting CSCF 
networkIdentifier 
Correlation number 
Unique number for each PDP context delivered to the 
LEMF, to help the LEA, to have a correlation between 

each PDP Context and the IRI. Parameter of Rel. 5 and 
on 
gPRSCorrelationNumber 
Correlation 
Correlation number; unique number for each PDP context 
delivered to the LEMF, to help the LEA, to have a 
correlation between each PDP Context and the IRI. 
ASN.1 as: iri-to-CC 

 
Signalling PDP context correlation number; unique 
number for signalling PDP context delivered to the LEMF, 
to help the LEA, to have a correlation between each PDP 

Context and the IRI. 

Used in the case two PDP contexts are used. 
ASN.1 as: iri-to-CC 
 
SIP correlation number; either Call-id or some 

implementation dependent number that uniquely identify 
SIP messages of the same SIP session. 
ASN.1 as: iri-to-iri 
correlation 
Lawful interception 
identifier 
Unique number for each lawful authorization. lawfulInterceptionIdentifier 
SIP message 
Either whole SIP message, or SIP message header (plus 
SDP body, if any). SIP message header (plus SDP) is 
used if warrant requires only IRI. In such case, specific 
content in the SIPMessage (e.g. "Message", etc.) needs to 

be deleted; unknown headers are not deleted 
sIPMessage 





H.1.4.1 Events and information 


















  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 120 








Table H.1.3: SIP-Message REPORT Record 
Parameter MOC
 Description/Conditions
 observed SIP-URI 
C SIP URI of the interception target (if available). 
observed TEL-URL 
C TEL URL of the interception target (if available). 
event type 
M Provide IMS event type. 
event date 
M Provide the date and time the event is detected. 
event time 
network identifier 
M To be provided. 
lawful intercept identifier M To be provided. 
correlation number 
O If available and not included in the SIP-message. 
correlation 
O If applicable for this communication. 
SIP message 
M The relevant SIP message or SIP message header. 
H.1.5 Correlation indications of IMS IRI with GSN CC at the LEMF 




























• Call-ID, From tag, To tag:







• P-Charging-Vector (IMS Charging ID):








  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 121 • P-Charging-Vector (GPRS Charging ID, GGSN address):








• SDP Connection addresses and ports:










  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 122 Annex I (informative): 
Latest ASN.1 module versions 




Defined in clause D.3: 
HIManagementOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) him(3) version3(3)} 
Defined in clause D.4: 
HI1NotificationOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi1(0) notificationOperations(1) version5(5)} 
Defined in clause D.5: 
HI2Operations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi2(1) version10(10)} 
Defined in clause D.6: 
HI3CircuitDataOperations {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) circuitLI(1) version3(3)} 
Defined in clause D.7: 
EN301040 {{itu-t(0) identified-organization(4) etsi(0) en301040(1040) interceptVersion(0)}} 
Defined in clause D.8: 
HI3CCLinkData {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) cclinkLI(4) version4(4)} 
Defined in clause D.9: 
Gprs-HI3-PS {itu-t(0) identified-organization(4) etsi(0) securityDomain(2) lawfulIntercept(2) hi3(2) gPRSLI(3) version3(3)} 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 123 Annex J (informative): 
Bibliography 
• 

• 




• 


• 


• 


• 





• 




• 


• 


• 




• 




• 




• 




• 


• 


• 


• 


• 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 124 • 


• 

  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 125 Annex K (informative): 
Change Request history 
Status of the present document 
Handover interface for the lawful interception of telecommunications traffic
 Date
 Version Remarks
 July 1999 1.1.1 first publication of the ES 
July 2001 2.1.1 
version for voting by ETSI members was the outcome of the Sec-LI#29 (17 - 19 July 
2001, Helsinki). Received comments during voting period where not considered. 

Version 2.1.1 prepared by Laurent Perrine (Alcatel) (rapporteur) 
September 2006  3.1.1 
ETSI ES 201 671 v2.1.1 was also published as ETSI TS 101 671 v2.1.1 

ETSI TS 101 671 is the basis for further discussion and development within ETSI/SEC-

LI and ETSI/TC LI. 
The following Change Requests have been agreed and indicate the difference between 
ETSI ES 201 671 v2.1.1 and ETSI ES 201 671 v3.1.1 
Change Requests approved by SEC-LI#31 (27-29 November 2001; Wien): 
TS10167CR001 (category D) on Removal of reference to ETSI TR 101 876 
TS10167CR002 rev1 (category D) on Example on missing information 

TS10167CR003 (category D) on Sending of IRI-END and IRI-CONTINUE records 

TS10167CR004 (category D) on Moving GPRS related text from main body to annex B 
TS10167CR005 rev1 (category F) on No additional work on HI1 interface port for 
administrative state 

TS10167CR006 rev1 (category F) on Version indication 

TS10167CR007 rev1 (category F) on No additional identifiers for Packet switched 

network handover 
TS10167CR008 rev2 (category D) on Several editorials 
TS10167CR009 (category F) on UUS1-parameter no. 6: "bearer capability of target call" 

TS10167CR010 rev1 (category D) on Modification of the definition "CC link" 

TS10167CR011 (category D) on Modification of the definition "Internal Network 
Interface": change "mediation device" into "mediation function" 
TS10167CR013 (category D) on Deletion of the definition "mediation device" 
Change Requests approved by SEC-LI#32 (19-21 March 2002, Sophia Antipolis): 
TS10167CR014 rev 2 (cat F) on annex E, Coding of the Calling Party Number 
TS10167CR015 rev 2 (cat F) on clause D.5 Coordinates 

TS10167CR016 (cat C) on clause D.5 - Exports Capabilities 

TS10167CR017 rev 1 (cat D) on clause C.2.2 - File naming method B; clause F.3.2.2 - 
File naming method B 
TS10167CR018 rev 1 (cat C) on clause D.5 - TimeStamp 

TS10167CR019 (cat F) on Correction of superfluous spaces in ASN.1 coding 

TS10167CR021 (cat D) on Reintroduction of deleted references 
TS10167CR022 rev 2 (cat F) on Aligning ETSI TS 101 671 with 3GPP TS 33.108 
TS10167CR025 (cat F) on Correction of Misalignment between the text and the ASN.1 
Change Requests approved by SEC-LI#33 (18-20 June 2002, Sophia Antipolis): 
TS10167CR026 (cat F) on Correcting "ccitt" into "itu-t" in ASN.1 Object Tree 
TS10167CR027 rev 1 (cat C) on Missing ISUP parameter in version 1 

TS10167CR028 rev 1 (cat B) on Use of the object identifier within the IRI 

TS10167CR030 rev 1 (cat B) on Extension/alignment of ASN.1 module with 33.108 
TS10167CR031 (cat F) on Missing/old reference 
TS10167CR032 rev 2 (cat B) on ASN.1 alignment with the UMTS module 

TS10167CR033 (cat B) on Adding a graphical ASN.1- Object tree 
Change Requests approved by TC LI#01 (15-17 October 2002, Dublin): 

TS10167CR034 rev 1 (cat B) on Aggregation of IRI Records 

TS10167CR036 (cat F) on ASN.1 version number 

TS10167CR037 rev 1 (cat F) on Missing pDPContextModification parameter 
TS10167CR038 rev 1 (cat F) on Missing ggsnAddress parameter 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 126 Status of the present document 
Handover interface for the lawful interception of telecommunications traffic
 Date
 Version Remarks
 Change Requests approved by TC LI#02 (4-6 March 2003, Benalmádena: 
TS10167CR035 (cat F) on Coding of ASN.1 parameters of the type OCTET STRING 

TS10167CR039r1 (cat C) on Composition of calling Party Subaddress 
TS10167CR041 (cat C) on Additional value direction indication (PARTLY) 
TS10167CR042r2 (cat F) on Data Link Establishment and Sending part for ROSE 

operation 

TS10167CR043r1 (cat C) on Clarification of definitions of sequence number and 
communication identity number 
TS10167CR045 (cat C) on HI3 delivery of CC 

TS10167CR046r1 (cat D) on Field separator in subaddress 

TS10167CR047r1 (cat F) on Essential correction to the LI events generated during RAU 
when PDP context is active 
TS10167CR048r2 (cat F) on Adjustments to the requirements on the delivery of the 

intercepted RT data over TCP 

TS10167CR044r1 (cat C) on Additional value antenna direction GSM location 
information 
TS10167CR049 (cat C) on CallingPartyNumber and mAP-Format 
Change Requests approved by TC LI#03 (3-5 June 2003, Copenhagen): 
TS10167CR044r3 (cat C) on Additional value antenna direction GSM location 
information 

TS10167CR050 (cat C) on Precision about Services-Information field 

TS10167CR051 (cat F) on Use of identifiers, elimination of "CC only" delivery option 
Change Request approved by TC LI#04 (14-16 October 2003, Moscow): 

TS10167CR052r1 (cat F) on Inconsistency regarding definition of CIN length 
Change Request approved by TC LI#05 (23-25 March 2004, Oxford) 
TS10167CR054 (cat D) Editorials to clause C.1.2.1 
TS10167CR055 (cat D) Removal of superfluous spaces from ASN.1 description 

TS10167CR056r2 (cat B) Introduction of national parameters in the him module 

TS10167CR058r1 (cat B) Introduction of national ASN.1 coded parameters in HI2 
TS10167CR059 (cat D) Correction of the Routing Area Identifier 
TS10167CR060 (cat D) Correction of wrong use of abbreviations 

TS10167CR061 (cat D) Alignment names of RO-operations 

TS10167CR062r1 (cat B) Decoding HI1 Notification and HI2 IRI-Parameters FTP file 
TS10167CR063r1 (cat F) WGS 84 Coordinates updates 
TS10167CR064r2 (cat D) Editorial corrections to CS domain 

TS10167CR065 (cat F) Correction to the reference for Called Party Number 

TS10167CR066r2 (cat C) Field separator in subaddress 
TS10167CR068 (cat F) No SMS content in case of IRI only 
TS10167CR069r3 (cat F) Correction of the Subaddressing definitions 
Change Request approved by TC LI#06 (22-23 July, Póvoa de Varzim): 
TS10167CR072r4 (cat B) Extensions to the "National-HI2-ASN1parameters" data type 
TS10167CR073r1 (cat D) Clarifying clause titles 

TS10167CR076r2 (cat F) References in ETSI TS 101 671 

TS10167CR077 (cat B) Nature of the intercepted call 
TS10167CR078 (cat F) Served User for CLIP and COLP and other minor correction 
TS10167CR079r4 (cat B) Importing CC definition for PS domain from 3GPP module 

TS10167CR080r1 (cat D) Spare Octets in the Subaddress in annex E 

TS10167CR081 (cat D) ed correction of parameter name "setUpInProcess" 
Change Request approved by TC LI#07 (28-30 September 2004, Bremen): 

TS10167CR082r1 (cat B) Addition of HI2 via to transfer UUS information 

TS10167CR083 (cat D) Explanation concerning the Sequence Number 
TS10167CR084r1 (cat D) Format of the CIN and CC-Link-Identifier 
TS10167CR085 (cat C) Addition of the domainID in the parameter "National-HI1-ASN1" 

parameters 

TS10167CR086 (cat C) Addition of the Lawful Interception Identifier in the parameter 

"Alarm-Indicator" 
TS10167CR087 (cat D) New annex listing latest ASN.1 module versions in ETSI 
TS 101 671 

TS10167CR088 (cat D) PDP Context modification request 

TS10167CR089r2 (cat B) Aligning "IRI-Parameters" with those defined in 
3GPP TS 33.108 
TS10167CR090 (cat B) Interception of fixed NGN (including PSTN/ISDN emulation) and 

fixed IMS PSTN simulation 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 127 Status of the present document 
Handover interface for the lawful interception of telecommunications traffic
 Date
 Version Remarks
 Change Request approved by TC LI#08 (22-24 February 2005, Kijkduin) 
TS10167CR091r2 (cat B) Support of ETSI TS 101 909-20 Sub-Part 1 LI parameters 

TS10167CR092 (cat F) Correction to GLIC header - Alignment with 3GPP TS 33.108 
TS10167CR093 (cat F) References in ETSI TS 101 671 
 
Change Request approved by TC LI#09 (28-30 June 2005, Rovaniemi) 

TS10167CR095 (cat C) Removing the SecurityDomainDefinitions in clause D.2. 
TS10167CR096r3 (cat D) Clarification of requirement to assign CIN values by relevant 
network element 

TS10167CR097r2 (cat D) Clarification of requirement to provide full IRI for intercepted 

SMS messages, even if some of the information is embedded in the SMS message body 
(IRI for SMS) 
TS10167CR098 (cat F) Updating imports statement for ASN.1 definition of the ULICv1 

header 

TS10167CR099r1 (cat F) Alignment CR for IMS LI 
TS10167CR100r2 (cat C) Freezing "iRIversion" parameter in ASN.1 module 
TS10167CR102r1 (cat D) Resolution 

TS10167CR103 (cat B) New parameters defined in TS 33.108 
Change Request approved by TC LI#10 (4-6 October 2005, Sorrento): 

TS10167CR101r1 (cat C) Aligning LIID definitions 

TS10167CR105 (cat D) Informative example of FTP implementation across HI2/HI3 
Change Requests approved by TC LI#11 (30 January - 1 February 2006, Saint Martin): 
TS10167CR104r3 (cat C) Extending table C.2.1 and table F.3.4 for national use 
TS10167CR106r1 (cat D) Explanation on Open Issues 

TS10167CR107 (cat F) Correction on polygon type of shape 

TS10167CR109 (cat F) Handling of unknown SIP headers 
TS10167CR110r1 (cat F) TETRA finalisation 
TS10167CR111 (cat F) Re-correcting changes made during publication process 
Change Requests approved by TC LI#13 (6-8 September 2006 in Stockholm): 
TS10167CR108r1 (cat B) TISPAN NGN PSTN Em
ulation Service and PSTN Simulation 
Service Stage 3 description 
TS10167CR1112r1 (cat D) Modifications as requested by ETSI EditHelp 

 Version 3.1.1 prepared by Peter van der Arend (KPN) (rapporteur) (see note) 
February 2018 3.2.1 
Change Request approved by TC LI#47 (5-7 February 2018 in New Delhi) 
ETSI ES 201 671 CR113 (cat F) Marking ETSI ES 201 671 as historical 
Version 3.2.1 prepared by rapporteur. 
NOTE Between the publication of v2.1.1 and v3.1.1 TC LI continued working on the TS version of the ES. 
ETSI TS 101 671 v2.15.1 is the latest version and converted to ETSI ES 201 671 v3.1.1. 
  ETSI ETSI ES 201 671 V3.2.1 (2018
-05) 128 History 
Document history 































